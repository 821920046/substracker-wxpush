{
  "version": 3,
  "sources": ["../bundle-qJCWc7/checked-fetch.js", "../../../src/templates/admin.ts", "../../../src/templates/config.ts", "../../../src/templates/login.ts", "../../../src/utils/auth.ts", "../../../src/utils/config.ts", "../../../src/templates/debug.ts", "../../../src/utils/lunar.ts", "../../../src/utils/date.ts", "../../../src/services/subscription.ts", "../../../src/utils/http.ts", "../../../src/services/notification.ts", "../../../src/worker.ts", "../../../node_modules/wrangler/templates/middleware/middleware-ensure-req-body-drained.ts", "../../../node_modules/wrangler/templates/middleware/middleware-miniflare3-json-error.ts", "../bundle-qJCWc7/middleware-insertion-facade.js", "../../../node_modules/wrangler/templates/middleware/common.ts", "../bundle-qJCWc7/middleware-loader.entry.ts"],
  "sourceRoot": "C:\\Users\\qh686\\Desktop\\google code\\substracker-wxpush\\.wrangler\\tmp\\dev-jzA12z",
  "sourcesContent": ["const urls = new Set();\n\nfunction checkURL(request, init) {\n\tconst url =\n\t\trequest instanceof URL\n\t\t\t? request\n\t\t\t: new URL(\n\t\t\t\t\t(typeof request === \"string\"\n\t\t\t\t\t\t? new Request(request, init)\n\t\t\t\t\t\t: request\n\t\t\t\t\t).url\n\t\t\t\t);\n\tif (url.port && url.port !== \"443\" && url.protocol === \"https:\") {\n\t\tif (!urls.has(url.toString())) {\n\t\t\turls.add(url.toString());\n\t\t\tconsole.warn(\n\t\t\t\t`WARNING: known issue with \\`fetch()\\` requests to custom HTTPS ports in published Workers:\\n` +\n\t\t\t\t\t` - ${url.toString()} - the custom port will be ignored when the Worker is published using the \\`wrangler deploy\\` command.\\n`\n\t\t\t);\n\t\t}\n\t}\n}\n\nglobalThis.fetch = new Proxy(globalThis.fetch, {\n\tapply(target, thisArg, argArray) {\n\t\tconst [request, init] = argArray;\n\t\tcheckURL(request, init);\n\t\treturn Reflect.apply(target, thisArg, argArray);\n\t},\n});\n", "\nexport const adminPage = `\n<!DOCTYPE html>\n<html>\n<head>\n  <meta charset=\"UTF-8\">\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n  <title>\u8BA2\u9605\u7BA1\u7406\u7CFB\u7EDF</title>\n  <link href=\"https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css\" rel=\"stylesheet\">\n  <link href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css\" rel=\"stylesheet\">\n  <style>\n    /* Custom Styles */\n    .btn-primary { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); transition: all 0.3s; }\n    .btn-primary:hover { transform: translateY(-2px); box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1); }\n    .btn-danger { background: linear-gradient(135deg, #ff5f6d 0%, #ffc371 100%); transition: all 0.3s; }\n    .btn-danger:hover { transform: translateY(-2px); box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1); }\n    .card-hover { transition: all 0.3s; }\n    .card-hover:hover { transform: translateY(-5px); box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1); }\n    \n    .toast {\n      position: fixed; top: 20px; right: 20px; padding: 12px 20px; border-radius: 8px;\n      color: white; font-weight: 500; z-index: 1000; transform: translateX(400px);\n      transition: all 0.3s ease-in-out; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);\n    }\n    .toast.show { transform: translateX(0); }\n    .toast.success { background-color: #10b981; }\n    .toast.error { background-color: #ef4444; }\n    .toast.info { background-color: #3b82f6; }\n    \n    /* Calendar Styles */\n    .calendar-popup {\n      display: none;\n      position: absolute;\n      background: white;\n      border-radius: 8px;\n      box-shadow: 0 10px 25px rgba(0,0,0,0.15);\n      width: 320px;\n      z-index: 100;\n      padding: 10px;\n      border: 1px solid #e2e8f0;\n    }\n    .calendar-popup.show { display: block; }\n    .calendar-header {\n      display: flex;\n      justify-content: space-between;\n      align-items: center;\n      margin-bottom: 10px;\n    }\n    .calendar-grid {\n      display: grid;\n      grid-template-columns: repeat(7, 1fr);\n      gap: 2px;\n    }\n    .calendar-day-header {\n      text-align: center;\n      font-size: 0.8rem;\n      color: #718096;\n      padding: 5px 0;\n    }\n    .calendar-day {\n      text-align: center;\n      padding: 8px 0;\n      cursor: pointer;\n      border-radius: 4px;\n      font-size: 0.9rem;\n      position: relative;\n    }\n    .calendar-day:hover { background-color: #ebf4ff; }\n    .calendar-day.today { background-color: #bee3f8; font-weight: bold; }\n    .calendar-day.selected { background-color: #667eea; color: white; }\n    .calendar-day.selected .lunar-text { color: #e2e8f0; }\n    .calendar-day.other-month { color: #cbd5e0; }\n    .lunar-text {\n      font-size: 0.6rem;\n      color: #a0aec0;\n      margin-top: -2px;\n    }\n    /* Tooltip Styles */\n    .hover-container { position: relative; width: 100%; }\n    .hover-text { max-width: 100%; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; cursor: pointer; transition: all 0.3s ease; display: block; }\n    .hover-text:hover { color: #3b82f6; }\n    .hover-tooltip {\n      position: fixed; z-index: 9999; background: #1f2937; color: white; padding: 10px 14px;\n      border-radius: 8px; font-size: 0.875rem; max-width: 320px; word-wrap: break-word;\n      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2); opacity: 0; visibility: hidden;\n      transition: all 0.3s ease; transform: translateY(-10px); white-space: normal; pointer-events: none; line-height: 1.4;\n    }\n    .hover-tooltip.show { opacity: 1; visibility: visible; transform: translateY(0); }\n    .hover-tooltip::before {\n      content: ''; position: absolute; top: -6px; left: 20px; border-left: 6px solid transparent;\n      border-right: 6px solid transparent; border-bottom: 6px solid #1f2937;\n    }\n    .hover-tooltip.tooltip-above::before { top: auto; bottom: -6px; border-bottom: none; border-top: 6px solid #1f2937; }\n    .gauge { width: 96px; height: 96px; border-radius: 50%; background: conic-gradient(var(--gauge-color, #10b981) var(--gauge-deg, 0deg), #e5e7eb 0deg); display: grid; place-items: center; position: relative; }\n    .gauge-center { width: 68px; height: 68px; border-radius: 50%; background: white; display: grid; place-items: center; color: #374151; font-size: 0.9rem; font-weight: 600; box-shadow: inset 0 0 0 1px #e5e7eb; }\n  </style>\n</head>\n<body class=\"bg-gray-100 min-h-screen font-sans\">\n  <nav class=\"bg-white shadow-md\">\n    <div class=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\n      <div class=\"flex justify-between h-16\">\n        <div class=\"flex items-center\">\n          <i class=\"fas fa-calendar-check text-indigo-600 text-2xl mr-2\"></i>\n          <span class=\"font-bold text-xl text-gray-800\">\u8BA2\u9605\u7BA1\u7406\u7CFB\u7EDF</span>\n        </div>\n        <div class=\"flex items-center space-x-4\">\n          <div class=\"text-gray-600 text-sm hidden md:block mr-2\" id=\"systemTimeDisplay\"></div>\n          <a href=\"/admin/config\" class=\"text-gray-600 hover:text-indigo-600 px-3 py-2 rounded-md text-sm font-medium transition duration-150\">\n            <i class=\"fas fa-cog mr-1\"></i>\u7CFB\u7EDF\u914D\u7F6E\n          </a>\n          <form action=\"/api/logout\" method=\"POST\" class=\"inline\">\n            <button type=\"submit\" class=\"text-gray-600 hover:text-red-500 px-3 py-2 rounded-md text-sm font-medium transition duration-150\">\n              <i class=\"fas fa-sign-out-alt mr-1\"></i>\u9000\u51FA\n            </button>\n          </form>\n        </div>\n      </div>\n    </div>\n  </nav>\n\n  <div class=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8\">\n    <!-- Dashboard Stats -->\n    <div class=\"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8\">\n      <div class=\"bg-white rounded-xl shadow-sm p-6 card-hover flex items-center justify-between\">\n        <div>\n          <p class=\"text-sm text-gray-500 font-medium\">\u603B\u8BA2\u9605\u6570</p>\n          <p class=\"text-2xl font-bold text-gray-800\" id=\"totalCount\">-</p>\n        </div>\n        <div class=\"gauge\" id=\"gauge-total\">\n          <div class=\"gauge-center\"><span id=\"gauge-total-text\">0%</span></div>\n        </div>\n      </div>\n      <div class=\"bg-white rounded-xl shadow-sm p-6 card-hover flex items-center justify-between\">\n        <div>\n          <p class=\"text-sm text-gray-500 font-medium\">\u6D3B\u8DC3\u8BA2\u9605</p>\n          <p class=\"text-2xl font-bold text-gray-800\" id=\"activeCount\">-</p>\n        </div>\n        <div class=\"gauge\" id=\"gauge-active\">\n          <div class=\"gauge-center\"><span id=\"gauge-active-text\">0%</span></div>\n        </div>\n      </div>\n      <div class=\"bg-white rounded-xl shadow-sm p-6 card-hover flex items-center justify-between\">\n        <div>\n          <p class=\"text-sm text-gray-500 font-medium\">\u5373\u5C06\u5230\u671F(7\u5929)</p>\n          <p class=\"text-2xl font-bold text-gray-800\" id=\"expiringCount\">-</p>\n        </div>\n        <div class=\"gauge\" id=\"gauge-expiring\">\n          <div class=\"gauge-center\"><span id=\"gauge-expiring-text\">0%</span></div>\n        </div>\n      </div>\n      <div class=\"bg-white rounded-xl shadow-sm p-6 card-hover flex items-center justify-between\">\n        <div>\n          <p class=\"text-sm text-gray-500 font-medium\">\u672C\u6708\u9884\u4F30\u652F\u51FA</p>\n          <p class=\"text-2xl font-bold text-gray-800\" id=\"monthlyExpense\">-</p>\n        </div>\n        <div class=\"gauge\" id=\"gauge-expense\">\n          <div class=\"gauge-center\"><span id=\"gauge-expense-text\">0%</span></div>\n        </div>\n      </div>\n    </div>\n\n    <!-- Main Content -->\n    <div class=\"bg-white rounded-xl shadow-sm overflow-hidden\">\n      <div class=\"px-6 py-4 border-b border-gray-100 bg-gray-50\">\n        <div class=\"flex flex-col md:flex-row md:justify-between md:items-center space-y-3 md:space-y-0\">\n          <h2 class=\"text-lg font-semibold text-gray-800\"><i class=\"fas fa-tasks mr-2 text-indigo-500\"></i>\u8BA2\u9605\u5217\u8868</h2>\n          <div class=\"flex items-center space-x-3\">\n            <input id=\"searchInput\" type=\"text\" placeholder=\"\u641C\u7D22\u540D\u79F0\u6216\u7C7B\u578B\" class=\"w-48 md:w-64 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500\">\n            <select id=\"sortSelect\" class=\"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500\">\n              <option value=\"expiryDate\">\u6309\u5230\u671F\u65F6\u95F4</option>\n              <option value=\"name\">\u6309\u540D\u79F0</option>\n              <option value=\"price\">\u6309\u4EF7\u683C</option>\n            </select>\n            <button id=\"sortDirBtn\" class=\"px-3 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-100\" title=\"\u5207\u6362\u5347\u5E8F/\u964D\u5E8F\">\n              <i id=\"sortDirIcon\" class=\"fas fa-arrow-down-a-z\"></i>\n            </button>\n            <select id=\"filterSelect\" class=\"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500\">\n              <option value=\"all\">\u5168\u90E8</option>\n              <option value=\"active\">\u6D3B\u8DC3</option>\n              <option value=\"expiring\">\u5373\u5C06\u5230\u671F(7\u5929)</option>\n              <option value=\"expired\">\u5DF2\u8FC7\u671F</option>\n              <option value=\"inactive\">\u5DF2\u505C\u7528</option>\n            </select>\n          </div>\n          <button onclick=\"openModal()\" class=\"btn-primary px-4 py-2 rounded-lg text-white text-sm font-medium shadow-md flex items-center\">\n            <i class=\"fas fa-plus mr-2\"></i>\u6DFB\u52A0\u8BA2\u9605\n          </button>\n        </div>\n      </div>\n      \n      <div class=\"overflow-x-auto\">\n        <table class=\"min-w-full divide-y divide-gray-200\">\n          <thead class=\"bg-gray-50\">\n            <tr>\n              <th class=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\u670D\u52A1\u540D\u79F0</th>\n              <th class=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\u7C7B\u578B</th>\n              <th class=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\u5468\u671F</th>\n              <th class=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\u5230\u671F\u65F6\u95F4</th>\n              <th class=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\u4EF7\u683C</th>\n              <th class=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\u6708\u5747\u652F\u51FA</th>\n              <th class=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\u72B6\u6001</th>\n              <th class=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\u64CD\u4F5C</th>\n            </tr>\n          </thead>\n          <tbody class=\"bg-white divide-y divide-gray-200\" id=\"subscriptionList\">\n            <tr>\n              <td colspan=\"8\" class=\"px-6 py-10 text-center text-gray-500\">\n                <i class=\"fas fa-spinner fa-spin mr-2\"></i>\u52A0\u8F7D\u4E2D...\n              </td>\n            </tr>\n          </tbody>\n        </table>\n      </div>\n    </div>\n  </div>\n\n  <!-- Modal -->\n  <div id=\"subscriptionModal\" class=\"fixed inset-0 bg-gray-600 bg-opacity-50 hidden overflow-y-auto h-full w-full z-50 flex items-center justify-center\">\n    <div class=\"relative mx-auto p-5 border w-full max-w-xl shadow-lg rounded-xl bg-white\">\n      <div class=\"flex justify-between items-center mb-5 pb-3 border-b\">\n        <h3 class=\"text-xl font-bold text-gray-900\" id=\"modalTitle\">\u6DFB\u52A0\u8BA2\u9605</h3>\n        <button id=\"closeModal\" class=\"text-gray-400 hover:text-gray-600 transition duration-150\">\n          <i class=\"fas fa-times text-xl\"></i>\n        </button>\n      </div>\n      \n      <form id=\"subscriptionForm\" class=\"space-y-4\">\n        <input type=\"hidden\" id=\"subscriptionId\">\n        \n        <div class=\"grid grid-cols-2 gap-4\">\n          <div>\n            <label class=\"block text-sm font-medium text-gray-700 mb-1\">\u670D\u52A1\u540D\u79F0</label>\n            <input type=\"text\" id=\"name\" required class=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500\">\n          </div>\n          <div>\n            <label class=\"block text-sm font-medium text-gray-700 mb-1\">\u81EA\u5B9A\u4E49\u7C7B\u578B</label>\n            <input type=\"text\" id=\"customType\" placeholder=\"\u5982\uFF1A\u5F71\u89C6\u4F1A\u5458\" class=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500\">\n          </div>\n        </div>\n        \n        <div class=\"grid grid-cols-2 gap-4\">\n          <div>\n            <label class=\"block text-sm font-medium text-gray-700 mb-1\">\u5468\u671F\u6570\u503C</label>\n            <input type=\"number\" id=\"periodValue\" required min=\"1\" value=\"1\" class=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500\">\n          </div>\n          <div>\n            <label class=\"block text-sm font-medium text-gray-700 mb-1\">\u5468\u671F\u5355\u4F4D</label>\n            <select id=\"periodUnit\" class=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500\">\n              <option value=\"month\">\u6708</option>\n              <option value=\"year\">\u5E74</option>\n              <option value=\"day\">\u5929</option>\n            </select>\n          </div>\n        </div>\n        \n        <div class=\"grid grid-cols-2 gap-4\">\n          <div class=\"relative\">\n            <label class=\"block text-sm font-medium text-gray-700 mb-1\">\u5F00\u59CB\u65E5\u671F</label>\n            <input type=\"text\" id=\"startDate\" required readonly class=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500 cursor-pointer bg-white\">\n            <div id=\"startDateLunar\" class=\"text-xs text-gray-500 mt-1 h-4\"></div>\n            \n            <!-- Custom Date Picker -->\n            <div id=\"startDatePicker\" class=\"calendar-popup\">\n              <div class=\"calendar-header\">\n                <button type=\"button\" id=\"startDatePrevMonth\" class=\"text-gray-500 hover:text-indigo-600\"><i class=\"fas fa-chevron-left\"></i></button>\n                <div class=\"font-bold text-gray-700\"><span id=\"startDateYear\"></span>\u5E74 <span id=\"startDateMonth\"></span></div>\n                <button type=\"button\" id=\"startDateNextMonth\" class=\"text-gray-500 hover:text-indigo-600\"><i class=\"fas fa-chevron-right\"></i></button>\n              </div>\n              <div class=\"calendar-grid\">\n                <div class=\"calendar-day-header\">\u65E5</div>\n                <div class=\"calendar-day-header\">\u4E00</div>\n                <div class=\"calendar-day-header\">\u4E8C</div>\n                <div class=\"calendar-day-header\">\u4E09</div>\n                <div class=\"calendar-day-header\">\u56DB</div>\n                <div class=\"calendar-day-header\">\u4E94</div>\n                <div class=\"calendar-day-header\">\u516D</div>\n              </div>\n              <div id=\"startDateCalendar\" class=\"calendar-grid\"></div>\n            </div>\n          </div>\n          \n          <div class=\"relative\">\n            <label class=\"block text-sm font-medium text-gray-700 mb-1\">\u5230\u671F\u65E5\u671F</label>\n            <input type=\"text\" id=\"expiryDate\" required readonly class=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500 cursor-pointer bg-white\">\n            <div id=\"expiryDateLunar\" class=\"text-xs text-gray-500 mt-1 h-4\"></div>\n            \n            <!-- Custom Date Picker -->\n            <div id=\"expiryDatePicker\" class=\"calendar-popup\">\n              <div class=\"calendar-header\">\n                <button type=\"button\" id=\"expiryDatePrevMonth\" class=\"text-gray-500 hover:text-indigo-600\"><i class=\"fas fa-chevron-left\"></i></button>\n                <div class=\"font-bold text-gray-700\"><span id=\"expiryDateYear\"></span>\u5E74 <span id=\"expiryDateMonth\"></span></div>\n                <button type=\"button\" id=\"expiryDateNextMonth\" class=\"text-gray-500 hover:text-indigo-600\"><i class=\"fas fa-chevron-right\"></i></button>\n              </div>\n              <div class=\"calendar-grid\">\n                <div class=\"calendar-day-header\">\u65E5</div>\n                <div class=\"calendar-day-header\">\u4E00</div>\n                <div class=\"calendar-day-header\">\u4E8C</div>\n                <div class=\"calendar-day-header\">\u4E09</div>\n                <div class=\"calendar-day-header\">\u56DB</div>\n                <div class=\"calendar-day-header\">\u4E94</div>\n                <div class=\"calendar-day-header\">\u516D</div>\n              </div>\n              <div id=\"expiryDateCalendar\" class=\"calendar-grid\"></div>\n            </div>\n          </div>\n        </div>\n        \n        <div>\n          <label class=\"block text-sm font-medium text-gray-700 mb-1\">\u91D1\u989D\uFF08\u6BCF\u5468\u671F\uFF0C\u00A5\uFF09</label>\n          <input type=\"number\" id=\"price\" min=\"0\" step=\"0.01\" placeholder=\"\u4F8B\u5982 29.90\" class=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500\">\n        </div>\n        \n        <div class=\"flex items-center space-x-4 bg-gray-50 p-3 rounded-lg\">\n           <div class=\"flex items-center\">\n            <input type=\"checkbox\" id=\"useLunar\" class=\"h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded\">\n            <label for=\"useLunar\" class=\"ml-2 block text-sm text-gray-900\">\u519C\u5386\u5468\u671F</label>\n          </div>\n           <div class=\"flex items-center\">\n            <input type=\"checkbox\" id=\"showLunar\" checked class=\"h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded\">\n            <label for=\"showLunar\" class=\"ml-2 block text-sm text-gray-900\">\u663E\u793A\u519C\u5386</label>\n          </div>\n          <button type=\"button\" id=\"calculateExpiryBtn\" class=\"ml-auto text-xs bg-indigo-100 text-indigo-700 px-2 py-1 rounded hover:bg-indigo-200 transition\">\n            <i class=\"fas fa-calculator mr-1\"></i>\u63A8\u7B97\u5230\u671F\u65E5\n          </button>\n        </div>\n\n        <div>\n          <label class=\"block text-sm font-medium text-gray-700 mb-1\">\u5907\u6CE8\u4FE1\u606F</label>\n          <textarea id=\"notes\" rows=\"2\" class=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500\"></textarea>\n        </div>\n        \n        <div class=\"grid grid-cols-2 gap-4\">\n          <div>\n            <label class=\"block text-sm font-medium text-gray-700 mb-1\">\u63D0\u9192\u8BBE\u7F6E (\u5929)</label>\n            <input type=\"number\" id=\"reminderDays\" min=\"0\" value=\"7\" class=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500\" title=\"\u63D0\u524D\u591A\u5C11\u5929\u63D0\u9192\uFF0C0\u8868\u793A\u4EC5\u5F53\u5929\u63D0\u9192\">\n          </div>\n          <div class=\"flex items-end space-x-4 pb-2\">\n            <div class=\"flex items-center\">\n              <input type=\"checkbox\" id=\"autoRenew\" checked class=\"h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded\">\n              <label for=\"autoRenew\" class=\"ml-2 block text-sm text-gray-900\">\u81EA\u52A8\u7EED\u671F</label>\n            </div>\n            <div class=\"flex items-center\">\n              <input type=\"checkbox\" id=\"isActive\" checked class=\"h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded\">\n              <label for=\"isActive\" class=\"ml-2 block text-sm text-gray-900\">\u542F\u7528\u72B6\u6001</label>\n            </div>\n          </div>\n        </div>\n        \n        <div class=\"flex justify-end space-x-3 mt-6 pt-4 border-t\">\n          <button type=\"button\" id=\"cancelBtn\" class=\"px-4 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300 transition duration-150\">\u53D6\u6D88</button>\n          <button type=\"submit\" class=\"btn-primary px-6 py-2 text-white rounded-lg shadow-md font-medium\">\u4FDD\u5B58\u8BA2\u9605</button>\n        </div>\n      </form>\n    </div>\n  </div>\n\n  <script>\n    // Lunar Calendar Logic\n    const lunarCalendar = {\n      lunarInfo: [0x04bd8, 0x04ae0, 0x0a570, 0x054d5, 0x0d260, 0x0d950, 0x16554, 0x056a0, 0x09ad0, 0x055d2, 0x04ae0, 0x0a5b6, 0x0a4d0, 0x0d250, 0x1d255, 0x0b540, 0x0d6a0, 0x0ada2, 0x095b0, 0x14977, 0x04970, 0x0a4b0, 0x0b4b5, 0x06a50, 0x06d40, 0x1ab54, 0x02b60, 0x09570, 0x052f2, 0x04970, 0x06566, 0x0d4a0, 0x0ea50, 0x06e95, 0x05ad0, 0x02b60, 0x186e3, 0x092e0, 0x1c8d7, 0x0c950, 0x0d4a0, 0x1d8a6, 0x0b550, 0x056a0, 0x1a5b4, 0x025d0, 0x092d0, 0x0d2b2, 0x0a950, 0x0b557, 0x06ca0, 0x0b550, 0x15355, 0x04da0, 0x0a5d0, 0x14573, 0x052d0, 0x0a9a8, 0x0e950, 0x06aa0, 0x0aea6, 0x0ab50, 0x04b60, 0x0aae4, 0x0a570, 0x05260, 0x0f263, 0x0d950, 0x05b57, 0x056a0, 0x096d0, 0x04dd5, 0x04ad0, 0x0a4d0, 0x0d4d4, 0x0d250, 0x0d558, 0x0b540, 0x0b5a0, 0x195a6, 0x095b0, 0x049b0, 0x0a974, 0x0a4b0, 0x0b27a, 0x06a50, 0x06d40, 0x0af46, 0x0ab60, 0x09570, 0x04af5, 0x04970, 0x064b0, 0x074a3, 0x0ea50, 0x06b58, 0x055c0, 0x0ab60, 0x096d5, 0x092e0, 0x0c960, 0x0d954, 0x0d4a0, 0x0da50, 0x07552, 0x056a0, 0x0abb7, 0x025d0, 0x092d0, 0x0cab5, 0x0a950, 0x0b4a0, 0x0baa4, 0x0ad50, 0x055d9, 0x04ba0, 0x0a5b0, 0x15176, 0x052b0, 0x0a930, 0x07954, 0x06aa0, 0x0ad50, 0x05b52, 0x04b60, 0x0a6e6, 0x0a4e0, 0x0d260, 0x0ea65, 0x0d530, 0x05aa0, 0x076a3, 0x096d0, 0x04bd7, 0x04ad0, 0x0a4d0, 0x1d0b6, 0x0d250, 0x0d520, 0x0dd45, 0x0b5a0, 0x056d0, 0x055b2, 0x049b0, 0x0a577, 0x0a4b0, 0x0aa50, 0x1b255, 0x06d20, 0x0ada0],\n      gan: ['\u7532', '\u4E59', '\u4E19', '\u4E01', '\u620A', '\u5DF1', '\u5E9A', '\u8F9B', '\u58EC', '\u7678'],\n      zhi: ['\u5B50', '\u4E11', '\u5BC5', '\u536F', '\u8FB0', '\u5DF3', '\u5348', '\u672A', '\u7533', '\u9149', '\u620C', '\u4EA5'],\n      months: ['\u6B63', '\u4E8C', '\u4E09', '\u56DB', '\u4E94', '\u516D', '\u4E03', '\u516B', '\u4E5D', '\u5341', '\u51AC', '\u814A'],\n      days: ['\u521D\u4E00', '\u521D\u4E8C', '\u521D\u4E09', '\u521D\u56DB', '\u521D\u4E94', '\u521D\u516D', '\u521D\u4E03', '\u521D\u516B', '\u521D\u4E5D', '\u521D\u5341', '\u5341\u4E00', '\u5341\u4E8C', '\u5341\u4E09', '\u5341\u56DB', '\u5341\u4E94', '\u5341\u516D', '\u5341\u4E03', '\u5341\u516B', '\u5341\u4E5D', '\u4E8C\u5341', '\u5EFF\u4E00', '\u5EFF\u4E8C', '\u5EFF\u4E09', '\u5EFF\u56DB', '\u5EFF\u4E94', '\u5EFF\u516D', '\u5EFF\u4E03', '\u5EFF\u516B', '\u5EFF\u4E5D', '\u4E09\u5341'],\n      \n      lunarYearDays: function(year) {\n        let sum = 348;\n        for (let i = 0x8000; i > 0x8; i >>= 1) sum += (this.lunarInfo[year - 1900] & i) ? 1 : 0;\n        return sum + this.leapDays(year);\n      },\n      leapDays: function(year) {\n        if (this.leapMonth(year)) return (this.lunarInfo[year - 1900] & 0x10000) ? 30 : 29;\n        return 0;\n      },\n      leapMonth: function(year) {\n        return (this.lunarInfo[year - 1900] & 0xf);\n      },\n      monthDays: function(year, month) {\n        return (this.lunarInfo[year - 1900] & (0x10000 >> month)) ? 30 : 29;\n      },\n      solar2lunar: function(year, month, day) {\n        if (year < 1900 || year > 2100) return -1;\n        let offset = (Date.UTC(year, month - 1, day) - Date.UTC(1900, 0, 31)) / 86400000;\n        let temp = 0, i = 1900;\n        for (i = 1900; i < 2101 && offset > 0; i++) {\n          temp = this.lunarYearDays(i);\n          offset -= temp;\n        }\n        if (offset < 0) { offset += temp; i--; }\n        \n        let isLeap = false, leap = this.leapMonth(i);\n        let lunarYear = i, lunarMonth = 1;\n        \n        for (lunarMonth = 1; lunarMonth < 13 && offset > 0; lunarMonth++) {\n          if (leap > 0 && lunarMonth == (leap + 1) && isLeap == false) {\n            --lunarMonth; isLeap = true; temp = this.leapDays(lunarYear);\n          } else {\n            temp = this.monthDays(lunarYear, lunarMonth);\n          }\n          if (isLeap == true && lunarMonth == (leap + 1)) isLeap = false;\n          offset -= temp;\n        }\n        if (offset == 0 && leap > 0 && lunarMonth == leap + 1) if (isLeap) isLeap = false; else { isLeap = true; --lunarMonth; }\n        if (offset < 0) { offset += temp; --lunarMonth; }\n        \n        return {\n          year: lunarYear,\n          month: lunarMonth,\n          day: Math.round(offset + 1),\n          isLeap: isLeap,\n          yearStr: this.gan[(lunarYear - 4) % 10] + this.zhi[(lunarYear - 4) % 12],\n          monthStr: (isLeap ? '\u95F0' : '') + this.months[lunarMonth - 1] + '\u6708',\n          dayStr: this.days[Math.round(offset)],\n          fullStr: this.gan[(lunarYear - 4) % 10] + this.zhi[(lunarYear - 4) % 12] + '\u5E74 ' + (isLeap ? '\u95F0' : '') + this.months[lunarMonth - 1] + '\u6708' + this.days[Math.round(offset)]\n        };\n      }\n    };\n    \n    // Lunar Business Logic\n    const lunarBiz = {\n        lunar2solar: function(lunar) {\n            let offset = 0;\n            // Scan from 1900\n            for (let i = 1900; i < lunar.year; i++) offset += lunarCalendar.lunarYearDays(i);\n            let leap = lunarCalendar.leapMonth(lunar.year);\n            for (let i = 1; i < lunar.month; i++) {\n                offset += lunarCalendar.monthDays(lunar.year, i);\n                if (leap > 0 && i === leap) offset += lunarCalendar.leapDays(lunar.year);\n            }\n            if (lunar.isLeap) offset += lunarCalendar.monthDays(lunar.year, lunar.month);\n            offset += lunar.day - 1;\n            \n            const baseDate = new Date(Date.UTC(1900, 0, 31));\n            const solarDate = new Date(baseDate.getTime() + offset * 86400000);\n            return {\n                year: solarDate.getUTCFullYear(),\n                month: solarDate.getUTCMonth() + 1,\n                day: solarDate.getUTCDate()\n            };\n        },\n        addLunarPeriod: function(lunar, value, unit) {\n            let { year, month, day, isLeap } = lunar;\n            if (unit === 'year') {\n                year += value;\n            } else if (unit === 'month') {\n                let total = month + value;\n                year += Math.floor((total - 1) / 12);\n                month = (total - 1) % 12 + 1;\n            } else if (unit === 'day') {\n                const solar = this.lunar2solar(lunar);\n                const date = new Date(Date.UTC(solar.year, solar.month - 1, solar.day));\n                date.setDate(date.getDate() + value);\n                return lunarCalendar.solar2lunar(date.getUTCFullYear(), date.getUTCMonth() + 1, date.getUTCDate());\n            }\n            \n            // Adjust day\n            let leap = lunarCalendar.leapMonth(year);\n            let maxDays = lunarCalendar.monthDays(year, month);\n            if (isLeap && leap === month) maxDays = lunarCalendar.leapDays(year);\n            if (day > maxDays) day = maxDays;\n            \n            return { year, month, day, isLeap: (isLeap && leap === month) };\n        }\n    };\n    \n    // UI Helpers\n    function showToast(message, type = 'info') {\n      const toast = document.createElement('div');\n      toast.className = 'toast ' + type;\n      toast.innerHTML = '<i class=\"fas ' + (type === 'success' ? 'fa-check-circle' : type === 'error' ? 'fa-exclamation-circle' : 'fa-info-circle') + ' mr-2\"></i>' + message;\n      document.body.appendChild(toast);\n      setTimeout(() => toast.classList.add('show'), 100);\n      setTimeout(() => {\n        toast.classList.remove('show');\n        setTimeout(() => document.body.removeChild(toast), 300);\n      }, 3000);\n    }\n    \n    // Custom Date Picker Class\n    class CustomDatePicker {\n      constructor(inputId, pickerId, calendarId, monthId, yearId, prevBtnId, nextBtnId) {\n        this.input = document.getElementById(inputId);\n        this.picker = document.getElementById(pickerId);\n        this.calendar = document.getElementById(calendarId);\n        this.monthEl = document.getElementById(monthId);\n        this.yearEl = document.getElementById(yearId);\n        this.prevBtn = document.getElementById(prevBtnId);\n        this.nextBtn = document.getElementById(nextBtnId);\n        \n        this.currentDate = new Date();\n        this.selectedDate = null;\n        \n        this.init();\n      }\n      \n      init() {\n        this.input.addEventListener('click', (e) => {\n          e.stopPropagation();\n          document.querySelectorAll('.calendar-popup').forEach(p => {\n             if(p.id !== this.picker.id) p.classList.remove('show');\n          });\n          this.picker.classList.toggle('show');\n          this.render();\n        });\n        \n        this.picker.addEventListener('click', (e) => e.stopPropagation());\n        \n        this.prevBtn.addEventListener('click', (e) => {\n            e.stopPropagation();\n            this.currentDate.setMonth(this.currentDate.getMonth() - 1);\n            this.render();\n        });\n        \n        this.nextBtn.addEventListener('click', (e) => {\n            e.stopPropagation();\n            this.currentDate.setMonth(this.currentDate.getMonth() + 1);\n            this.render();\n        });\n        \n        document.addEventListener('click', (e) => {\n            if (!this.picker.contains(e.target) && e.target !== this.input) {\n                this.picker.classList.remove('show');\n            }\n        });\n      }\n      \n      render() {\n        const year = this.currentDate.getFullYear();\n        const month = this.currentDate.getMonth();\n        \n        this.monthEl.textContent = ['1\u6708', '2\u6708', '3\u6708', '4\u6708', '5\u6708', '6\u6708', '7\u6708', '8\u6708', '9\u6708', '10\u6708', '11\u6708', '12\u6708'][month];\n        this.yearEl.textContent = year;\n        \n        const firstDay = new Date(year, month, 1).getDay();\n        const daysInMonth = new Date(year, month + 1, 0).getDate();\n        \n        this.calendar.innerHTML = '';\n        \n        // Empty slots\n        for (let i = 0; i < firstDay; i++) {\n          const div = document.createElement('div');\n          this.calendar.appendChild(div);\n        }\n        \n        const today = new Date();\n        \n        for (let i = 1; i <= daysInMonth; i++) {\n          const div = document.createElement('div');\n          div.className = 'calendar-day';\n          div.textContent = i;\n          \n          if (year === today.getFullYear() && month === today.getMonth() && i === today.getDate()) {\n            div.classList.add('today');\n          }\n          \n          if (this.selectedDate && \n              year === this.selectedDate.getFullYear() && \n              month === this.selectedDate.getMonth() && \n              i === this.selectedDate.getDate()) {\n            div.classList.add('selected');\n          }\n          \n          // Lunar\n          const lunar = lunarCalendar.solar2lunar(year, month + 1, i);\n          if (lunar) {\n            const lunarSpan = document.createElement('div');\n            lunarSpan.className = 'lunar-text';\n            lunarSpan.textContent = lunar.day === 1 ? lunar.monthStr : lunar.dayStr;\n            div.appendChild(lunarSpan);\n          }\n          \n          div.addEventListener('click', (e) => {\n            e.stopPropagation();\n            this.selectDate(new Date(year, month, i));\n          });\n          \n          this.calendar.appendChild(div);\n        }\n      }\n      \n      selectDate(date) {\n        this.selectedDate = date;\n        const year = date.getFullYear();\n        const month = date.getMonth() + 1;\n        const day = date.getDate();\n        \n        this.input.value = \\`\\${year}-\\${month.toString().padStart(2, '0')}-\\${day.toString().padStart(2, '0')}\\`;\n        \n        const lunar = lunarCalendar.solar2lunar(year, month, day);\n        const lunarDivId = this.input.id + 'Lunar';\n        const lunarDiv = document.getElementById(lunarDivId);\n        if (lunarDiv && lunar) {\n          lunarDiv.textContent = \\`\u519C\u5386: \\${lunar.monthStr}\\${lunar.dayStr}\\`;\n        }\n        \n        this.picker.classList.remove('show');\n        this.render();\n        \n        // Trigger change event manually\n        const event = new Event('change');\n        this.input.dispatchEvent(event);\n      }\n      \n      setDate(dateStr) {\n        if (!dateStr) return;\n        this.selectedDate = new Date(dateStr);\n        this.currentDate = new Date(dateStr);\n        this.input.value = dateStr;\n        \n        const lunarDivId = this.input.id + 'Lunar';\n        const lunarDiv = document.getElementById(lunarDivId);\n        if (lunarDiv) {\n            const year = this.selectedDate.getFullYear();\n            const month = this.selectedDate.getMonth() + 1;\n            const day = this.selectedDate.getDate();\n            const lunar = lunarCalendar.solar2lunar(year, month, day);\n            if (lunar) lunarDiv.textContent = \\`\u519C\u5386: \\${lunar.monthStr}\\${lunar.dayStr}\\`;\n        }\n      }\n      \n      destroy() {\n         // Placeholder for cleanup if needed\n      }\n    }\n\n    // Initialize Global Variables\n    let subscriptions = [];\n    let startDatePicker, expiryDatePicker;\n    let searchQuery = '';\n    let sortKey = 'expiryDate';\n    let sortDir = 'asc';\n    let filterKey = 'all';\n\n    // Load Subscriptions\n    async function loadSubscriptions() {\n      const tbody = document.getElementById('subscriptionList');\n      tbody.innerHTML = '<tr><td colspan=\"8\" class=\"text-center py-10\"><i class=\"fas fa-spinner fa-spin mr-2\"></i>\u52A0\u8F7D\u4E2D...</td></tr>';\n      \n      try {\n        const res = await fetch('/api/subscriptions');\n        subscriptions = await res.json();\n        \n        renderSubscriptions();\n        updateStats();\n      } catch (err) {\n        console.error(err);\n        tbody.innerHTML = '<tr><td colspan=\"8\" class=\"text-center py-10 text-red-500\">\u52A0\u8F7D\u5931\u8D25</td></tr>';\n        showToast('\u52A0\u8F7D\u5931\u8D25', 'error');\n      }\n    }\n    \n    function renderSubscriptions() {\n        const tbody = document.getElementById('subscriptionList');\n        tbody.innerHTML = '';\n        \n        let list = subscriptions.slice();\n        if (searchQuery && searchQuery.length > 0) {\n          const q = searchQuery;\n          list = list.filter(s => {\n            const text = ((s.name || '') + ' ' + (s.customType || '') + ' ' + (s.notes || '')).toLowerCase();\n            return text.includes(q);\n          });\n        }\n        if (filterKey && filterKey !== 'all') {\n          const today = new Date();\n          today.setHours(0,0,0,0);\n          list = list.filter(s => {\n            const exp = new Date(s.expiryDate);\n            exp.setHours(0,0,0,0);\n            const diff = Math.ceil((exp - today) / (1000 * 60 * 60 * 24));\n            if (filterKey === 'active') return s.isActive !== false && diff >= 0;\n            if (filterKey === 'expiring') return s.isActive !== false && diff >= 0 && diff <= (s.reminderDays || 7);\n            if (filterKey === 'expired') return diff < 0;\n            if (filterKey === 'inactive') return s.isActive === false;\n            return true;\n          });\n        }\n        \n        if (list.length === 0) {\n          tbody.innerHTML = '<tr><td colspan=\"8\" class=\"text-center py-10 text-gray-500\">\u6682\u65E0\u8BA2\u9605\uFF0C\u70B9\u51FB\u4E0A\u65B9\u6309\u94AE\u6DFB\u52A0</td></tr>';\n          return;\n        }\n        \n        if (sortKey === 'name') {\n          list.sort((a, b) => (a.name || '').localeCompare(b.name || ''));\n        } else if (sortKey === 'price') {\n          list.sort((a, b) => {\n            const pa = a.price !== undefined ? Number(a.price) : NaN;\n            const pb = b.price !== undefined ? Number(b.price) : NaN;\n            const va = isNaN(pa) ? Number.POSITIVE_INFINITY : pa;\n            const vb = isNaN(pb) ? Number.POSITIVE_INFINITY : pb;\n            return va - vb;\n          });\n        } else {\n          list.sort((a, b) => new Date(a.expiryDate) - new Date(b.expiryDate));\n        }\n        if (sortDir === 'desc') list.reverse();\n        \n        const now = new Date();\n        const unitMap = { day: '\u5929', month: '\u6708', year: '\u5E74' };\n        \n        list.forEach(sub => {\n          const tr = document.createElement('tr');\n          const exp = new Date(sub.expiryDate);\n          const today = new Date();\n          today.setHours(0,0,0,0);\n          const expDay = new Date(exp);\n          expDay.setHours(0,0,0,0);\n          const diff = Math.ceil((expDay - today) / (1000 * 60 * 60 * 24));\n          \n          let statusHtml = '';\n          if (sub.isActive === false) statusHtml = '<span class=\"px-2 py-1 text-xs rounded-full bg-gray-200 text-gray-800\">\u5DF2\u505C\u7528</span>';\n          else if (diff < 0) statusHtml = '<span class=\"px-2 py-1 text-xs rounded-full bg-red-100 text-red-800\">\u5DF2\u8FC7\u671F</span>';\n          else if (diff <= (sub.reminderDays || 7)) statusHtml = '<span class=\"px-2 py-1 text-xs rounded-full bg-yellow-100 text-yellow-800\">\u5373\u5C06\u5230\u671F</span>';\n          else statusHtml = '<span class=\"px-2 py-1 text-xs rounded-full bg-green-100 text-green-800\">\u6B63\u5E38</span>';\n          \n          const dateStr = exp.toISOString().split('T')[0];\n          \n          let priceStr = '-';\n          let monthlyStr = '-';\n          if (sub.price !== undefined && !isNaN(Number(sub.price))) {\n            const price = Number(sub.price);\n            const val = sub.periodValue || 1;\n            const unit = sub.periodUnit || 'month';\n            let m = 0;\n            if (unit === 'month') m = price / Math.max(1, val);\n            else if (unit === 'year') m = price / Math.max(1, val * 12);\n            else if (unit === 'day') m = price * (30 / Math.max(1, val));\n            priceStr = '\u00A5' + price.toFixed(2);\n            monthlyStr = '\u00A5' + m.toFixed(2);\n          }\n          \n          tr.innerHTML = \\`\n            <td class=\"px-6 py-4 whitespace-nowrap\">\n                <div class=\"text-sm font-medium text-gray-900\">\\${sub.name}</div>\n                \\${sub.notes ? \\`<div class=\"text-xs text-gray-500\">\\${sub.notes}</div>\\` : ''}\n            </td>\n            <td class=\"px-6 py-4 whitespace-nowrap text-sm text-gray-500\">\\${sub.customType || '-'}</td>\n            <td class=\"px-6 py-4 whitespace-nowrap text-sm text-gray-500\">\\${sub.periodValue}\\${unitMap[sub.periodUnit]}</td>\n            <td class=\"px-6 py-4 whitespace-nowrap text-sm text-gray-500\">\n              \\${dateStr}\n              <div class=\"text-xs text-gray-400\">\\${sub.useLunar ? '\u519C\u5386' : '\u516C\u5386'}</div>\n            </td>\n            <td class=\"px-6 py-4 whitespace-nowrap text-sm text-gray-500\">\\${priceStr}</td>\n            <td class=\"px-6 py-4 whitespace-nowrap text-sm text-gray-500\">\\${monthlyStr}</td>\n            <td class=\"px-6 py-4 whitespace-nowrap\">\\${statusHtml}</td>\n            <td class=\"px-6 py-4 whitespace-nowrap text-sm font-medium\">\n              <button onclick=\"openModal('\\${sub.id}')\" class=\"text-indigo-600 hover:text-indigo-900 mr-3\"><i class=\"fas fa-edit\"></i></button>\n              <button onclick=\"toggleStatus('\\${sub.id}', \\${!sub.isActive})\" class=\"text-blue-600 hover:text-blue-900 mr-3\" title=\"\\${sub.isActive ? '\u505C\u7528' : '\u542F\u7528'}\">\n                <i class=\"fas \\${sub.isActive ? 'fa-toggle-on' : 'fa-toggle-off'}\"></i>\n              </button>\n              <button onclick=\"deleteSubscription('\\${sub.id}')\" class=\"text-red-600 hover:text-red-900\"><i class=\"fas fa-trash\"></i></button>\n              <button onclick=\"testNotify('\\${sub.id}')\" class=\"text-yellow-600 hover:text-yellow-900 ml-3\" title=\"\u53D1\u9001\u6D4B\u8BD5\u901A\u77E5\"><i class=\"fas fa-bell\"></i></button>\n            </td>\n          \\`;\n          tbody.appendChild(tr);\n        });\n    }\n    \n    function updateStats() {\n        const active = subscriptions.filter(s => s.isActive !== false).length;\n        const total = subscriptions.length;\n        \n        const today = new Date();\n        today.setHours(0,0,0,0);\n        \n        const expiring = subscriptions.filter(s => {\n          if (s.isActive === false) return false;\n          const exp = new Date(s.expiryDate);\n          exp.setHours(0,0,0,0);\n          const diff = Math.ceil((exp - today) / (1000 * 60 * 60 * 24));\n          return diff >= 0 && diff <= 7;\n        }).length;\n        \n        document.getElementById('totalCount').textContent = total;\n        document.getElementById('activeCount').textContent = active;\n        document.getElementById('expiringCount').textContent = expiring;\n        \n        let monthly = 0;\n        subscriptions.forEach(s => {\n          if (s.isActive === false) return;\n          if (s.price === undefined || isNaN(Number(s.price))) return;\n          const price = Number(s.price);\n          const val = s.periodValue || 1;\n          const unit = s.periodUnit || 'month';\n          if (unit === 'month') monthly += price / Math.max(1, val);\n          else if (unit === 'year') monthly += price / Math.max(1, val * 12);\n          else if (unit === 'day') monthly += price * (30 / Math.max(1, val));\n        });\n        document.getElementById('monthlyExpense').textContent = '\u00A5' + monthly.toFixed(2); \n        \n        const totalPercent = Math.min(100, Math.round((total / 50) * 100));\n        const activePercent = total > 0 ? Math.round((active / total) * 100) : 0;\n        const expiringPercent = total > 0 ? Math.round((expiring / total) * 100) : 0;\n        const expensePercent = Math.min(100, Math.round((monthly / 2000) * 100));\n        \n        setGauge('gauge-total', totalPercent, pickColor(totalPercent));\n        setGauge('gauge-active', activePercent, pickColor(activePercent));\n        setGauge('gauge-expiring', expiringPercent, expiringPercent > 0 ? '#f59e0b' : '#10b981');\n        setGauge('gauge-expense', expensePercent, '#3b82f6');\n    }\n    \n    function setGauge(id, percent, color) {\n      const el = document.getElementById(id);\n      if (!el) return;\n      const deg = Math.max(0, Math.min(360, Math.round(percent * 3.6)));\n      el.style.setProperty('--gauge-deg', deg + 'deg');\n      el.style.setProperty('--gauge-color', color);\n      const textEl = document.getElementById(id + '-text');\n      if (textEl) textEl.textContent = Math.max(0, Math.min(100, Math.round(percent))) + '%';\n    }\n    \n    function pickColor(percent) {\n      if (percent >= 67) return '#10b981';\n      if (percent >= 34) return '#f59e0b';\n      return '#ef4444';\n    }\n    \n    // Modal Functions\n    async function openModal(id) {\n      document.getElementById('subscriptionForm').reset();\n      document.getElementById('subscriptionId').value = '';\n      document.getElementById('modalTitle').textContent = '\u6DFB\u52A0\u8BA2\u9605';\n      document.getElementById('startDate').value = new Date().toISOString().split('T')[0];\n      \n      // Default expiry +1 month\n      const nextMonth = new Date();\n      nextMonth.setMonth(nextMonth.getMonth() + 1);\n      document.getElementById('expiryDate').value = nextMonth.toISOString().split('T')[0];\n      \n      document.getElementById('useLunar').checked = false;\n      document.getElementById('showLunar').checked = true;\n      document.getElementById('isActive').checked = true;\n      document.getElementById('autoRenew').checked = true;\n      document.getElementById('periodValue').value = 1;\n      document.getElementById('periodUnit').value = 'month';\n      document.getElementById('reminderDays').value = 7;\n      const priceEl = document.getElementById('price');\n      if (priceEl) priceEl.value = '';\n      \n      if (id) {\n          const sub = subscriptions.find(s => s.id === id);\n          if (sub) {\n             document.getElementById('modalTitle').textContent = '\u7F16\u8F91\u8BA2\u9605';\n             document.getElementById('subscriptionId').value = sub.id;\n             document.getElementById('name').value = sub.name;\n             document.getElementById('customType').value = sub.customType || '';\n             document.getElementById('notes').value = sub.notes || '';\n             document.getElementById('isActive').checked = sub.isActive !== false;\n             document.getElementById('autoRenew').checked = sub.autoRenew !== false;\n             document.getElementById('startDate').value = sub.startDate ? sub.startDate.split('T')[0] : '';\n             document.getElementById('expiryDate').value = sub.expiryDate.split('T')[0];\n             document.getElementById('periodValue').value = sub.periodValue || 1;\n             document.getElementById('periodUnit').value = sub.periodUnit || 'month';\n             document.getElementById('reminderDays').value = sub.reminderDays !== undefined ? sub.reminderDays : 7;\n             document.getElementById('useLunar').checked = !!sub.useLunar;\n             if (priceEl) priceEl.value = sub.price !== undefined ? String(sub.price) : '';\n          }\n      }\n      \n      document.getElementById('subscriptionModal').classList.remove('hidden');\n      \n      // Init Pickers\n      setTimeout(() => {\n        if (startDatePicker) startDatePicker.destroy();\n        if (expiryDatePicker) expiryDatePicker.destroy();\n        startDatePicker = new CustomDatePicker('startDate', 'startDatePicker', 'startDateCalendar', 'startDateMonth', 'startDateYear', 'startDatePrevMonth', 'startDateNextMonth');\n        expiryDatePicker = new CustomDatePicker('expiryDate', 'expiryDatePicker', 'expiryDateCalendar', 'expiryDateMonth', 'expiryDateYear', 'expiryDatePrevMonth', 'expiryDateNextMonth');\n        updateLunarDisplay('startDate', 'startDateLunar');\n        updateLunarDisplay('expiryDate', 'expiryDateLunar');\n        toggleLunarDisplay();\n      }, 50);\n    }\n    \n    document.getElementById('closeModal').addEventListener('click', () => {\n      document.getElementById('subscriptionModal').classList.add('hidden');\n    });\n    \n    document.getElementById('cancelBtn').addEventListener('click', () => {\n      document.getElementById('subscriptionModal').classList.add('hidden');\n    });\n    \n    // Form Submit\n    document.getElementById('subscriptionForm').addEventListener('submit', async (e) => {\n      e.preventDefault();\n      const id = document.getElementById('subscriptionId').value;\n      const data = {\n        name: document.getElementById('name').value,\n        customType: document.getElementById('customType').value,\n        notes: document.getElementById('notes').value,\n        isActive: document.getElementById('isActive').checked,\n        autoRenew: document.getElementById('autoRenew').checked,\n        startDate: document.getElementById('startDate').value,\n        expiryDate: document.getElementById('expiryDate').value,\n        periodValue: parseInt(document.getElementById('periodValue').value),\n        periodUnit: document.getElementById('periodUnit').value,\n        reminderDays: parseInt(document.getElementById('reminderDays').value),\n        useLunar: document.getElementById('useLunar').checked,\n        price: (function(){ const v = document.getElementById('price').value; return v ? parseFloat(v) : undefined; })()\n      };\n      \n      const btn = e.target.querySelector('button[type=\"submit\"]');\n      const orgHtml = btn.innerHTML;\n      btn.innerHTML = '<i class=\"fas fa-spinner fa-spin mr-2\"></i>\u4FDD\u5B58\u4E2D...';\n      btn.disabled = true;\n      \n      try {\n        const url = id ? '/api/subscriptions/' + id : '/api/subscriptions';\n        const method = id ? 'PUT' : 'POST';\n        const res = await fetch(url, { method, headers: {'Content-Type': 'application/json'}, body: JSON.stringify(data) });\n        const result = await res.json();\n        \n        if (result.success || res.status === 200 || res.status === 201) {\n          showToast('\u4FDD\u5B58\u6210\u529F', 'success');\n          document.getElementById('subscriptionModal').classList.add('hidden');\n          loadSubscriptions();\n        } else {\n          showToast('\u4FDD\u5B58\u5931\u8D25: ' + (result.message || '\u672A\u77E5\u9519\u8BEF'), 'error');\n        }\n      } catch (err) {\n        showToast('\u4FDD\u5B58\u5931\u8D25', 'error');\n      } finally {\n        btn.innerHTML = orgHtml;\n        btn.disabled = false;\n      }\n    });\n    \n    // Actions\n    async function deleteSubscription(id) {\n      if (!confirm('\u786E\u5B9A\u8981\u5220\u9664\u5417\uFF1F')) return;\n      try {\n        const res = await fetch('/api/subscriptions/' + id, { method: 'DELETE' });\n        const result = await res.json();\n        if (result.success || res.ok) {\n          showToast('\u5220\u9664\u6210\u529F', 'success');\n          loadSubscriptions();\n        } else {\n          showToast('\u5220\u9664\u5931\u8D25', 'error');\n        }\n      } catch (err) {\n        showToast('\u5220\u9664\u5931\u8D25', 'error');\n      }\n    }\n    \n    async function toggleStatus(id, isActive) {\n      try {\n        const res = await fetch('/api/subscriptions/' + id + '/toggle-status', {\n          method: 'POST',\n          headers: { 'Content-Type': 'application/json' },\n          body: JSON.stringify({ isActive })\n        });\n        const result = await res.json();\n        if (result.success) {\n          showToast('\u72B6\u6001\u66F4\u65B0\u6210\u529F', 'success');\n          loadSubscriptions();\n        } else {\n          showToast('\u66F4\u65B0\u5931\u8D25', 'error');\n        }\n      } catch (error) {\n        showToast('\u66F4\u65B0\u5931\u8D25', 'error');\n      }\n    }\n    \n    async function testNotify(id) {\n        try {\n            showToast('\u53D1\u9001\u6D4B\u8BD5\u901A\u77E5...', 'info');\n            const res = await fetch('/api/subscriptions/' + id + '/test-notify', { method: 'POST' });\n            const result = await res.json();\n            if (result.success) {\n                showToast('\u6D4B\u8BD5\u901A\u77E5\u5DF2\u53D1\u9001', 'success');\n            } else {\n                showToast(result.message || '\u53D1\u9001\u5931\u8D25', 'error');\n            }\n        } catch (e) {\n            showToast('\u53D1\u9001\u5931\u8D25', 'error');\n        }\n    }\n    \n    // Helpers\n    function updateLunarDisplay(inputId, displayId) {\n      const dateStr = document.getElementById(inputId).value;\n      if (!dateStr) return;\n      const date = new Date(dateStr);\n      const lunar = lunarCalendar.solar2lunar(date.getFullYear(), date.getMonth() + 1, date.getDate());\n      if (lunar !== -1) {\n        document.getElementById(displayId).textContent = lunar.fullStr;\n      }\n    }\n    \n    function toggleLunarDisplay() {\n      const show = document.getElementById('showLunar').checked;\n      const displays = document.querySelectorAll('#startDateLunar, #expiryDateLunar, .lunar-text');\n      displays.forEach(el => el.style.display = show ? 'block' : 'none');\n    }\n    \n    function calculateExpiryDate() {\n      const startStr = document.getElementById('startDate').value;\n      const val = parseInt(document.getElementById('periodValue').value);\n      const unit = document.getElementById('periodUnit').value;\n      const useLunar = document.getElementById('useLunar').checked;\n      \n      if (!startStr || !val) return;\n      \n      const startDate = new Date(startStr);\n      let expiryDate;\n      \n      if (useLunar) {\n        const lunar = lunarCalendar.solar2lunar(startDate.getFullYear(), startDate.getMonth() + 1, startDate.getDate());\n        if (lunar === -1) return;\n        const nextLunar = lunarBiz.addLunarPeriod(lunar, val, unit);\n        const solar = lunarBiz.lunar2solar(nextLunar);\n        expiryDate = new Date(Date.UTC(solar.year, solar.month - 1, solar.day));\n      } else {\n        expiryDate = new Date(startDate);\n        if (unit === 'day') expiryDate.setDate(expiryDate.getDate() + val);\n        else if (unit === 'month') expiryDate.setMonth(expiryDate.getMonth() + val);\n        else if (unit === 'year') expiryDate.setFullYear(expiryDate.getFullYear() + val);\n      }\n      \n      document.getElementById('expiryDate').value = expiryDate.toISOString().split('T')[0];\n      updateLunarDisplay('expiryDate', 'expiryDateLunar');\n    }\n    \n    // Init\n    document.addEventListener('DOMContentLoaded', () => {\n      loadSubscriptions();\n      \n      // Event Listeners\n      ['startDate', 'periodValue', 'periodUnit', 'useLunar'].forEach(id => {\n        const el = document.getElementById(id);\n        if(el) el.addEventListener('change', calculateExpiryDate);\n      });\n      document.getElementById('calculateExpiryBtn').addEventListener('click', calculateExpiryDate);\n      document.getElementById('showLunar').addEventListener('change', toggleLunarDisplay);\n      const searchEl = document.getElementById('searchInput');\n      if (searchEl) searchEl.addEventListener('input', (e) => {\n        searchQuery = e.target.value.trim().toLowerCase();\n        renderSubscriptions();\n      });\n      const sortEl = document.getElementById('sortSelect');\n      if (sortEl) sortEl.addEventListener('change', (e) => {\n        sortKey = e.target.value;\n        renderSubscriptions();\n      });\n      const sortDirBtn = document.getElementById('sortDirBtn');\n      const sortDirIcon = document.getElementById('sortDirIcon');\n      if (sortDirBtn) sortDirBtn.addEventListener('click', () => {\n        sortDir = sortDir === 'asc' ? 'desc' : 'asc';\n        if (sortDirIcon) {\n          sortDirIcon.className = sortDir === 'asc' ? 'fas fa-arrow-down-a-z' : 'fas fa-arrow-up-z-a';\n        }\n        renderSubscriptions();\n      });\n      const filterEl = document.getElementById('filterSelect');\n      if (filterEl) filterEl.addEventListener('change', (e) => {\n        filterKey = e.target.value;\n        renderSubscriptions();\n      });\n      \n      // Timezone check\n      setInterval(() => {\n        const last = localStorage.getItem('timezoneUpdated');\n        if (last && Date.now() - parseInt(last) < 5000) {\n          localStorage.removeItem('timezoneUpdated');\n          location.reload();\n        }\n      }, 2000);\n      \n      // System Time\n      function updateTime() {\n        const el = document.getElementById('systemTimeDisplay');\n        if(el) el.textContent = new Date().toLocaleString();\n      }\n      updateTime();\n      setInterval(updateTime, 1000);\n    });\n  </script>\n</body>\n</html>\n`;\n", "export const configPage = `\n<!DOCTYPE html>\n<html>\n<head>\n  <meta charset=\"UTF-8\">\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n  <title>\u7CFB\u7EDF\u914D\u7F6E - \u8BA2\u9605\u7BA1\u7406\u7CFB\u7EDF</title>\n  <link href=\"https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css\" rel=\"stylesheet\">\n  <link href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css\" rel=\"stylesheet\">\n  <style>\n    .btn-primary { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); transition: all 0.3s; }\n    .btn-primary:hover { transform: translateY(-2px); box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1); }\n    .btn-secondary { background: linear-gradient(135deg, #6b7280 0%, #4b5563 100%); transition: all 0.3s; }\n    .btn-secondary:hover { transform: translateY(-2px); box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1); }\n    \n    .toast {\n      position: fixed; top: 20px; right: 20px; padding: 12px 20px; border-radius: 8px;\n      color: white; font-weight: 500; z-index: 1000; transform: translateX(400px);\n      transition: all 0.3s ease-in-out; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);\n    }\n    .toast.show { transform: translateX(0); }\n    .toast.success { background-color: #10b981; }\n    .toast.error { background-color: #ef4444; }\n    .toast.info { background-color: #3b82f6; }\n    .toast.warning { background-color: #f59e0b; }\n    \n    .config-section { \n      border: 1px solid #e5e7eb; \n      border-radius: 8px; \n      padding: 16px; \n      margin-bottom: 24px; \n    }\n    .config-section.active { \n      background-color: #f8fafc; \n      border-color: #6366f1; \n    }\n    .config-section.inactive { \n      background-color: #f9fafb; \n      opacity: 0.7; \n    }\n  </style>\n</head>\n<body class=\"bg-gray-100 min-h-screen\">\n  <div id=\"toast-container\"></div>\n\n  <nav class=\"bg-white shadow-md\">\n    <div class=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\n      <div class=\"flex justify-between h-16\">\n        <div class=\"flex items-center\">\n          <i class=\"fas fa-calendar-check text-indigo-600 text-2xl mr-2\"></i>\n          <span class=\"font-bold text-xl text-gray-800\">\u8BA2\u9605\u7BA1\u7406\u7CFB\u7EDF</span>\n          <span id=\"systemTimeDisplay\" class=\"ml-4 text-base text-indigo-600 font-normal\"></span>\n        </div>\n        <div class=\"flex items-center space-x-4\">\n          <a href=\"/admin\" class=\"text-gray-700 hover:text-gray-900 px-3 py-2 rounded-md text-sm font-medium\">\n            <i class=\"fas fa-list mr-1\"></i>\u8BA2\u9605\u5217\u8868\n          </a>\n          <a href=\"/admin/config\" class=\"text-indigo-600 border-b-2 border-indigo-600 px-3 py-2 rounded-md text-sm font-medium\">\n            <i class=\"fas fa-cog mr-1\"></i>\u7CFB\u7EDF\u914D\u7F6E\n          </a>\n          <a href=\"/api/logout\" class=\"text-gray-700 hover:text-gray-900 px-3 py-2 rounded-md text-sm font-medium\">\n            <i class=\"fas fa-sign-out-alt mr-1\"></i>\u9000\u51FA\u767B\u5F55\n          </a>\n        </div>\n      </div>\n    </div>\n  </nav>\n  \n  <div class=\"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8\">\n    <div class=\"bg-white rounded-lg shadow-md p-6\">\n      <h2 class=\"text-2xl font-bold text-gray-800 mb-6\">\u7CFB\u7EDF\u914D\u7F6E</h2>\n      \n      <form id=\"configForm\" class=\"space-y-8\">\n        <div class=\"border-b border-gray-200 pb-6\">\n          <h3 class=\"text-lg font-medium text-gray-900 mb-4\">\u7BA1\u7406\u5458\u8D26\u6237</h3>\n          <div class=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n            <div>\n              <label for=\"adminUsername\" class=\"block text-sm font-medium text-gray-700\">\u7528\u6237\u540D</label>\n              <input type=\"text\" id=\"adminUsername\" class=\"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm\">\n            </div>\n            <div>\n              <label for=\"adminPassword\" class=\"block text-sm font-medium text-gray-700\">\u5BC6\u7801</label>\n              <input type=\"password\" id=\"adminPassword\" placeholder=\"\u5982\u4E0D\u4FEE\u6539\u5BC6\u7801\uFF0C\u8BF7\u7559\u7A7A\" class=\"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm\">\n              <p class=\"mt-1 text-sm text-gray-500\">\u7559\u7A7A\u8868\u793A\u4E0D\u4FEE\u6539\u5F53\u524D\u5BC6\u7801</p>\n            </div>\n          </div>\n        </div>\n        \n        <div class=\"border-b border-gray-200 pb-6\">\n          <h3 class=\"text-lg font-medium text-gray-900 mb-4\">\u663E\u793A\u8BBE\u7F6E</h3>\n          \n          \n          <div class=\"mb-6\">\n            <label class=\"inline-flex items-center\">\n              <input type=\"checkbox\" id=\"showLunarGlobal\" class=\"form-checkbox h-4 w-4 text-indigo-600 border-gray-300 rounded focus:ring-indigo-500\" checked>\n              <span class=\"ml-2 text-sm text-gray-700\">\u5728\u901A\u77E5\u4E2D\u663E\u793A\u519C\u5386\u65E5\u671F</span>\n            </label>\n            <p class=\"mt-1 text-sm text-gray-500\">\u63A7\u5236\u662F\u5426\u5728\u901A\u77E5\u6D88\u606F\u4E2D\u5305\u542B\u519C\u5386\u65E5\u671F\u4FE1\u606F</p>\n          </div>\n        </div>\n\n\n        <div class=\"border-b border-gray-200 pb-6\">\n          <h3 class=\"text-lg font-medium text-gray-900 mb-4\">\u65F6\u533A\u8BBE\u7F6E</h3>\n          <div class=\"mb-6\">\n          <label for=\"timezone\" class=\"block text-sm font-medium text-gray-700 mb-1\">\u65F6\u533A\u9009\u62E9</label>\n          <select id=\"timezone\" name=\"timezone\" class=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 bg-white\">\n            <option value=\"UTC\">\u4E16\u754C\u6807\u51C6\u65F6\u95F4\uFF08UTC+0\uFF09</option>\n            <option value=\"Asia/Shanghai\">\u4E2D\u56FD\u6807\u51C6\u65F6\u95F4\uFF08UTC+8\uFF09</option>\n            <option value=\"Asia/Hong_Kong\">\u9999\u6E2F\u65F6\u95F4\uFF08UTC+8\uFF09</option>\n            <option value=\"Asia/Taipei\">\u53F0\u5317\u65F6\u95F4\uFF08UTC+8\uFF09</option>\n            <option value=\"Asia/Singapore\">\u65B0\u52A0\u5761\u65F6\u95F4\uFF08UTC+8\uFF09</option>\n            <option value=\"Asia/Tokyo\">\u65E5\u672C\u65F6\u95F4\uFF08UTC+9\uFF09</option>\n            <option value=\"Asia/Seoul\">\u97E9\u56FD\u65F6\u95F4\uFF08UTC+9\uFF09</option>\n            <option value=\"America/New_York\">\u7F8E\u56FD\u4E1C\u90E8\u65F6\u95F4\uFF08UTC-5\uFF09</option>\n            <option value=\"America/Chicago\">\u7F8E\u56FD\u4E2D\u90E8\u65F6\u95F4\uFF08UTC-6\uFF09</option>\n            <option value=\"America/Denver\">\u7F8E\u56FD\u5C71\u5730\u65F6\u95F4\uFF08UTC-7\uFF09</option>\n            <option value=\"America/Los_Angeles\">\u7F8E\u56FD\u592A\u5E73\u6D0B\u65F6\u95F4\uFF08UTC-8\uFF09</option>\n            <option value=\"Europe/London\">\u82F1\u56FD\u65F6\u95F4\uFF08UTC+0\uFF09</option>\n            <option value=\"Europe/Paris\">\u5DF4\u9ECE\u65F6\u95F4\uFF08UTC+1\uFF09</option>\n            <option value=\"Europe/Berlin\">\u67CF\u6797\u65F6\u95F4\uFF08UTC+1\uFF09</option>\n            <option value=\"Europe/Moscow\">\u83AB\u65AF\u79D1\u65F6\u95F4\uFF08UTC+3\uFF09</option>\n            <option value=\"Australia/Sydney\">\u6089\u5C3C\u65F6\u95F4\uFF08UTC+10\uFF09</option>\n            <option value=\"Australia/Melbourne\">\u58A8\u5C14\u672C\u65F6\u95F4\uFF08UTC+10\uFF09</option>\n            <option value=\"Pacific/Auckland\">\u5965\u514B\u5170\u65F6\u95F4\uFF08UTC+12\uFF09</option>\n          </select>\n            <p class=\"mt-1 text-sm text-gray-500\">\u9009\u62E9\u9700\u8981\u4F7F\u7528\u65F6\u533A\uFF0C\u8BA1\u7B97\u5230\u671F\u65E5\u671F</p>\n          </div>\n        </div>\n\n        \n        <div class=\"border-b border-gray-200 pb-6\">\n          <h3 class=\"text-lg font-medium text-gray-900 mb-4\">\u901A\u77E5\u8BBE\u7F6E</h3>\n          <div class=\"mb-6\">\n            <label class=\"block text-sm font-medium text-gray-700 mb-3\">\u901A\u77E5\u65B9\u5F0F\uFF08\u53EF\u591A\u9009\uFF09</label>\n            <div class=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n              <label class=\"inline-flex items-center\">\n                <input type=\"checkbox\" name=\"enabledNotifiers\" value=\"telegram\" class=\"form-checkbox h-4 w-4 text-indigo-600 border-gray-300 rounded focus:ring-indigo-500\">\n                <span class=\"ml-2 text-sm text-gray-700\">Telegram</span>\n              </label>\n              <label class=\"inline-flex items-center\">\n                <input type=\"checkbox\" name=\"enabledNotifiers\" value=\"notifyx\" class=\"form-checkbox h-4 w-4 text-indigo-600 border-gray-300 rounded focus:ring-indigo-500\" checked>\n                <span class=\"ml-2 text-sm text-gray-700 font-semibold\">NotifyX</span>\n              </label>\n              <label class=\"inline-flex items-center\">\n                <input type=\"checkbox\" name=\"enabledNotifiers\" value=\"webhook\" class=\"form-checkbox h-4 w-4 text-indigo-600 border-gray-300 rounded focus:ring-indigo-500\">\n                <span class=\"ml-2 text-sm text-gray-700\">\u4F01\u4E1A\u5FAE\u4FE1\u5E94\u7528\u901A\u77E5</span>\n              </label>\n              <label class=\"inline-flex items-center\">\n                <input type=\"checkbox\" name=\"enabledNotifiers\" value=\"wechatbot\" class=\"form-checkbox h-4 w-4 text-indigo-600 border-gray-300 rounded focus:ring-indigo-500\">\n                <span class=\"ml-2 text-sm text-gray-700\">\u4F01\u4E1A\u5FAE\u4FE1\u673A\u5668\u4EBA</span>\n              </label>\n              <label class=\"inline-flex items-center\">\n                <input type=\"checkbox\" name=\"enabledNotifiers\" value=\"email\" class=\"form-checkbox h-4 w-4 text-indigo-600 border-gray-300 rounded focus:ring-indigo-500\">\n                <span class=\"ml-2 text-sm text-gray-700\">\u90AE\u4EF6\u901A\u77E5</span>\n              </label>\n              <label class=\"inline-flex items-center\">\n                <input type=\"checkbox\" name=\"enabledNotifiers\" value=\"bark\" class=\"form-checkbox h-4 w-4 text-indigo-600 border-gray-300 rounded focus:ring-indigo-500\">\n                <span class=\"ml-2 text-sm text-gray-700\">Bark</span>\n              </label>\n              <label class=\"inline-flex items-center\">\n                <input type=\"checkbox\" name=\"enabledNotifiers\" value=\"wenotify\" class=\"form-checkbox h-4 w-4 text-indigo-600 border-gray-300 rounded focus:ring-indigo-500\">\n                <span class=\"ml-2 text-sm text-gray-700\">WeNotify Edge</span>\n              </label>\n            </div>\n            <div class=\"mt-2 flex flex-wrap gap-4\">\n              <a href=\"https://www.notifyx.cn/\" target=\"_blank\" class=\"text-indigo-600 hover:text-indigo-800 text-sm\">\n                <i class=\"fas fa-external-link-alt ml-1\"></i> NotifyX\u5B98\u7F51\n              </a>\n              <a href=\"https://push.wangwangit.com\" target=\"_blank\" class=\"text-indigo-600 hover:text-indigo-800 text-sm\">\n                <i class=\"fas fa-external-link-alt ml-1\"></i> \u4F01\u4E1A\u5FAE\u4FE1\u5E94\u7528\u901A\u77E5\u5B98\u7F51\n              </a>\n              <a href=\"https://developer.work.weixin.qq.com/document/path/91770\" target=\"_blank\" class=\"text-indigo-600 hover:text-indigo-800 text-sm\">\n                <i class=\"fas fa-external-link-alt ml-1\"></i> \u4F01\u4E1A\u5FAE\u4FE1\u673A\u5668\u4EBA\u6587\u6863\n              </a>\n              <a href=\"https://developers.cloudflare.com/workers/tutorials/send-emails-with-resend/\" target=\"_blank\" class=\"text-indigo-600 hover:text-indigo-800 text-sm\">\n                <i class=\"fas fa-external-link-alt ml-1\"></i> \u83B7\u53D6 Resend API Key\n              </a>\n              <a href=\"https://apps.apple.com/cn/app/bark-customed-notifications/id1403753865\" target=\"_blank\" class=\"text-indigo-600 hover:text-indigo-800 text-sm\">\n                <i class=\"fas fa-external-link-alt ml-1\"></i> Bark iOS\u5E94\u7528\n              </a>\n            </div>\n          </div>\n          \n          <div id=\"telegramConfig\" class=\"config-section\">\n            <h4 class=\"text-md font-medium text-gray-900 mb-3\">Telegram \u914D\u7F6E</h4>\n            <div class=\"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4\">\n              <div>\n                <label for=\"tgBotToken\" class=\"block text-sm font-medium text-gray-700\">Bot Token</label>\n                <input type=\"text\" id=\"tgBotToken\" placeholder=\"\u4ECE @BotFather \u83B7\u53D6\" class=\"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm\">\n              </div>\n              <div>\n                <label for=\"tgChatId\" class=\"block text-sm font-medium text-gray-700\">Chat ID</label>\n                <input type=\"text\" id=\"tgChatId\" placeholder=\"\u53EF\u4ECE @userinfobot \u83B7\u53D6\" class=\"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm\">\n              </div>\n            </div>\n            <div class=\"flex justify-end\">\n              <button type=\"button\" id=\"testTelegramBtn\" class=\"btn-secondary text-white px-4 py-2 rounded-md text-sm font-medium\">\n                <i class=\"fas fa-paper-plane mr-2\"></i>\u6D4B\u8BD5 Telegram \u901A\u77E5\n              </button>\n            </div>\n          </div>\n          \n          <div id=\"notifyxConfig\" class=\"config-section\">\n            <h4 class=\"text-md font-medium text-gray-900 mb-3\">NotifyX \u914D\u7F6E</h4>\n            <div class=\"mb-4\">\n              <label for=\"notifyxApiKey\" class=\"block text-sm font-medium text-gray-700\">API Key</label>\n              <input type=\"text\" id=\"notifyxApiKey\" placeholder=\"\u4ECE NotifyX \u5E73\u53F0\u83B7\u53D6\u7684 API Key\" class=\"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm\">\n              <p class=\"mt-1 text-sm text-gray-500\">\u4ECE <a href=\"https://www.notifyx.cn/\" target=\"_blank\" class=\"text-indigo-600 hover:text-indigo-800\">NotifyX\u5E73\u53F0</a> \u83B7\u53D6\u7684 API Key</p>\n            </div>\n            <div class=\"flex justify-end\">\n              <button type=\"button\" id=\"testNotifyXBtn\" class=\"btn-secondary text-white px-4 py-2 rounded-md text-sm font-medium\">\n                <i class=\"fas fa-paper-plane mr-2\"></i>\u6D4B\u8BD5 NotifyX \u901A\u77E5\n              </button>\n            </div>\n          </div>\n\n          <div id=\"wenotifyConfig\" class=\"config-section\">\n            <h4 class=\"text-md font-medium text-gray-900 mb-3\">WeNotify Edge \u914D\u7F6E</h4>\n            <div class=\"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4\">\n              <div>\n                <label for=\"wenotifyUrl\" class=\"block text-sm font-medium text-gray-700\">\u670D\u52A1\u5730\u5740</label>\n                <input type=\"url\" id=\"wenotifyUrl\" placeholder=\"https://your-domain.workers.dev\" class=\"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm\">\n              </div>\n              <div>\n                <label for=\"wenotifyToken\" class=\"block text-sm font-medium text-gray-700\">API Token</label>\n                <input type=\"text\" id=\"wenotifyToken\" placeholder=\"\u5728 WeNotify Edge \u4E2D\u8BBE\u7F6E\u7684 API_TOKEN\" class=\"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm\">\n              </div>\n              <div>\n                <label for=\"wenotifyUserid\" class=\"block text-sm font-medium text-gray-700\">UserID (\u53EF\u9009)</label>\n                <input type=\"text\" id=\"wenotifyUserid\" placeholder=\"OPENID1|OPENID2\" class=\"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm\">\n              </div>\n              <div>\n                <label for=\"wenotifyTemplateId\" class=\"block text-sm font-medium text-gray-700\">\u6A21\u677FID (\u53EF\u9009)</label>\n                <input type=\"text\" id=\"wenotifyTemplateId\" placeholder=\"\u5FAE\u4FE1\u6A21\u677F\u6D88\u606F ID\" class=\"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm\">\n              </div>\n            </div>\n            <div class=\"flex justify-end\">\n              <button type=\"button\" id=\"testWeNotifyBtn\" class=\"btn-secondary text-white px-4 py-2 rounded-md text-sm font-medium\">\n                <i class=\"fas fa-paper-plane mr-2\"></i>\u6D4B\u8BD5 WeNotify Edge\n              </button>\n            </div>\n          </div>\n\n          <div id=\"webhookConfig\" class=\"config-section\">\n            <h4 class=\"text-md font-medium text-gray-900 mb-3\">\u4F01\u4E1A\u5FAE\u4FE1\u5E94\u7528\u901A\u77E5 \u914D\u7F6E</h4>\n            <div class=\"grid grid-cols-1 gap-4 mb-4\">\n              <div>\n                <label for=\"webhookUrl\" class=\"block text-sm font-medium text-gray-700\">\u4F01\u4E1A\u5FAE\u4FE1\u5E94\u7528\u901A\u77E5 URL</label>\n                <input type=\"url\" id=\"webhookUrl\" placeholder=\"https://push.wangwangit.com/api/send/your-key\" class=\"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm\">\n                <p class=\"mt-1 text-sm text-gray-500\">\u4ECE <a href=\"https://push.wangwangit.com\" target=\"_blank\" class=\"text-indigo-600 hover:text-indigo-800\">\u4F01\u4E1A\u5FAE\u4FE1\u5E94\u7528\u901A\u77E5\u5E73\u53F0</a> \u83B7\u53D6\u7684\u63A8\u9001URL</p>\n              </div>\n              <div>\n                <label for=\"webhookMethod\" class=\"block text-sm font-medium text-gray-700\">\u8BF7\u6C42\u65B9\u6CD5</label>\n                <select id=\"webhookMethod\" class=\"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm\">\n                  <option value=\"POST\">POST</option>\n                  <option value=\"GET\">GET</option>\n                  <option value=\"PUT\">PUT</option>\n                </select>\n              </div>\n              <div>\n                <label for=\"webhookHeaders\" class=\"block text-sm font-medium text-gray-700\">\u81EA\u5B9A\u4E49\u8BF7\u6C42\u5934 (JSON\u683C\u5F0F\uFF0C\u53EF\u9009)</label>\n                <textarea id=\"webhookHeaders\" rows=\"3\" placeholder='{\"Authorization\": \"Bearer your-token\", \"Content-Type\": \"application/json\"}' class=\"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm\"></textarea>\n                <p class=\"mt-1 text-sm text-gray-500\">JSON\u683C\u5F0F\u7684\u81EA\u5B9A\u4E49\u8BF7\u6C42\u5934\uFF0C\u7559\u7A7A\u4F7F\u7528\u9ED8\u8BA4</p>\n              </div>\n              <div>\n                <label for=\"webhookTemplate\" class=\"block text-sm font-medium text-gray-700\">\u6D88\u606F\u6A21\u677F (JSON\u683C\u5F0F\uFF0C\u53EF\u9009)</label>\n                <textarea id=\"webhookTemplate\" rows=\"4\" placeholder='{\"title\": \"{{title}}\", \"content\": \"{{content}}\", \"timestamp\": \"{{timestamp}}\"}' class=\"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm\"></textarea>\n                <p class=\"mt-1 text-sm text-gray-500\">\u652F\u6301\u53D8\u91CF: {{title}}, {{content}}, {{timestamp}}\u3002\u7559\u7A7A\u4F7F\u7528\u9ED8\u8BA4\u683C\u5F0F</p>\n              </div>\n            </div>\n            <div class=\"flex justify-end\">\n              <button type=\"button\" id=\"testWebhookBtn\" class=\"btn-secondary text-white px-4 py-2 rounded-md text-sm font-medium\">\n                <i class=\"fas fa-paper-plane mr-2\"></i>\u6D4B\u8BD5 \u4F01\u4E1A\u5FAE\u4FE1\u5E94\u7528\u901A\u77E5\n              </button>\n            </div>\n          </div>\n\n          <div id=\"wechatbotConfig\" class=\"config-section\">\n            <h4 class=\"text-md font-medium text-gray-900 mb-3\">\u4F01\u4E1A\u5FAE\u4FE1\u673A\u5668\u4EBA \u914D\u7F6E</h4>\n            <div class=\"grid grid-cols-1 gap-4 mb-4\">\n              <div>\n                <label for=\"wechatbotWebhook\" class=\"block text-sm font-medium text-gray-700\">\u673A\u5668\u4EBA Webhook URL</label>\n                <input type=\"url\" id=\"wechatbotWebhook\" placeholder=\"https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=your-key\" class=\"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm\">\n                <p class=\"mt-1 text-sm text-gray-500\">\u4ECE\u4F01\u4E1A\u5FAE\u4FE1\u7FA4\u804A\u4E2D\u6DFB\u52A0\u673A\u5668\u4EBA\u83B7\u53D6\u7684 Webhook URL</p>\n              </div>\n              <div>\n                <label for=\"wechatbotMsgType\" class=\"block text-sm font-medium text-gray-700\">\u6D88\u606F\u7C7B\u578B</label>\n                <select id=\"wechatbotMsgType\" class=\"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm\">\n                  <option value=\"text\">\u6587\u672C\u6D88\u606F</option>\n                  <option value=\"markdown\">Markdown\u6D88\u606F</option>\n                </select>\n                <p class=\"mt-1 text-sm text-gray-500\">\u9009\u62E9\u53D1\u9001\u7684\u6D88\u606F\u683C\u5F0F\u7C7B\u578B</p>\n              </div>\n              <div>\n                <label for=\"wechatbotAtMobiles\" class=\"block text-sm font-medium text-gray-700\">@\u624B\u673A\u53F7 (\u53EF\u9009)</label>\n                <input type=\"text\" id=\"wechatbotAtMobiles\" placeholder=\"13800138000,13900139000\" class=\"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm\">\n                <p class=\"mt-1 text-sm text-gray-500\">\u9700\u8981@\u7684\u624B\u673A\u53F7\uFF0C\u591A\u4E2A\u7528\u9017\u53F7\u5206\u9694\uFF0C\u7559\u7A7A\u5219\u4E0D@\u4EFB\u4F55\u4EBA</p>\n              </div>\n              <div>\n                <label class=\"inline-flex items-center mt-2\">\n                  <input type=\"checkbox\" id=\"wechatbotAtAll\" class=\"form-checkbox h-4 w-4 text-indigo-600 border-gray-300 rounded focus:ring-indigo-500\">\n                  <span class=\"ml-2 text-sm text-gray-700\">@\u6240\u6709\u4EBA</span>\n                </label>\n              </div>\n            </div>\n            <div class=\"flex justify-end\">\n              <button type=\"button\" id=\"testWechatBotBtn\" class=\"btn-secondary text-white px-4 py-2 rounded-md text-sm font-medium\">\n                <i class=\"fas fa-paper-plane mr-2\"></i>\u6D4B\u8BD5 \u4F01\u4E1A\u5FAE\u4FE1\u673A\u5668\u4EBA\n              </button>\n            </div>\n          </div>\n\n          <div id=\"emailConfig\" class=\"config-section\">\n            <h4 class=\"text-md font-medium text-gray-900 mb-3\">\u90AE\u4EF6\u901A\u77E5 \u914D\u7F6E</h4>\n            <div class=\"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4\">\n              <div>\n                <label for=\"resendApiKey\" class=\"block text-sm font-medium text-gray-700\">Resend API Key</label>\n                <input type=\"text\" id=\"resendApiKey\" placeholder=\"re_...\" class=\"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm\">\n              </div>\n              <div>\n                <label for=\"emailFrom\" class=\"block text-sm font-medium text-gray-700\">\u53D1\u4EF6\u4EBA\u90AE\u7BB1</label>\n                <input type=\"email\" id=\"emailFrom\" placeholder=\"onboarding@resend.dev\" class=\"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm\">\n              </div>\n              <div>\n                <label for=\"emailFromName\" class=\"block text-sm font-medium text-gray-700\">\u53D1\u4EF6\u4EBA\u540D\u79F0</label>\n                <input type=\"text\" id=\"emailFromName\" placeholder=\"\u8BA2\u9605\u52A9\u624B\" class=\"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm\">\n              </div>\n              <div>\n                <label for=\"emailTo\" class=\"block text-sm font-medium text-gray-700\">\u6536\u4EF6\u4EBA\u90AE\u7BB1</label>\n                <input type=\"email\" id=\"emailTo\" placeholder=\"your@email.com\" class=\"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm\">\n              </div>\n            </div>\n            <div class=\"flex justify-end\">\n              <button type=\"button\" id=\"testEmailBtn\" class=\"btn-secondary text-white px-4 py-2 rounded-md text-sm font-medium\">\n                <i class=\"fas fa-paper-plane mr-2\"></i>\u6D4B\u8BD5 \u90AE\u4EF6\u901A\u77E5\n              </button>\n            </div>\n          </div>\n\n          <div id=\"barkConfig\" class=\"config-section\">\n            <h4 class=\"text-md font-medium text-gray-900 mb-3\">Bark \u914D\u7F6E</h4>\n            <div class=\"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4\">\n              <div>\n                <label for=\"barkServer\" class=\"block text-sm font-medium text-gray-700\">\u670D\u52A1\u5668\u5730\u5740</label>\n                <input type=\"url\" id=\"barkServer\" placeholder=\"https://api.day.app\" class=\"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm\">\n                <p class=\"mt-1 text-sm text-gray-500\">\u9ED8\u8BA4\u4E3A https://api.day.app\uFF0C\u81EA\u5EFA\u670D\u52A1\u8BF7\u586B\u5199\u5BF9\u5E94\u5730\u5740</p>\n              </div>\n              <div>\n                <label for=\"barkDeviceKey\" class=\"block text-sm font-medium text-gray-700\">\u8BBE\u5907 Key</label>\n                <input type=\"text\" id=\"barkDeviceKey\" placeholder=\"Bark App \u4E2D\u7684 Device Key\" class=\"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm\">\n              </div>\n              <div>\n                <label class=\"inline-flex items-center mt-6\">\n                  <input type=\"checkbox\" id=\"barkIsArchive\" class=\"form-checkbox h-4 w-4 text-indigo-600 border-gray-300 rounded focus:ring-indigo-500\">\n                  <span class=\"ml-2 text-sm text-gray-700\">\u81EA\u52A8\u4FDD\u5B58\u901A\u77E5</span>\n                </label>\n              </div>\n            </div>\n            <div class=\"flex justify-end\">\n              <button type=\"button\" id=\"testBarkBtn\" class=\"btn-secondary text-white px-4 py-2 rounded-md text-sm font-medium\">\n                <i class=\"fas fa-paper-plane mr-2\"></i>\u6D4B\u8BD5 Bark \u901A\u77E5\n              </button>\n            </div>\n          </div>\n\n        </div>\n\n        <div class=\"flex justify-end\">\n          <button type=\"submit\" class=\"btn-primary text-white px-6 py-3 rounded-md text-base font-medium flex items-center\">\n            <i class=\"fas fa-save mr-2\"></i>\u4FDD\u5B58\u914D\u7F6E\n          </button>\n        </div>\n      </form>\n    </div>\n  </div>\n\n  <script>\n    function showToast(message, type = 'info') {\n      const container = document.getElementById('toast-container');\n      const toast = document.createElement('div');\n      toast.className = \\`toast \\${type}\\`;\n      \n      let icon = '';\n      if (type === 'success') icon = '<i class=\"fas fa-check-circle mr-2\"></i>';\n      else if (type === 'error') icon = '<i class=\"fas fa-times-circle mr-2\"></i>';\n      else if (type === 'warning') icon = '<i class=\"fas fa-exclamation-triangle mr-2\"></i>';\n      else icon = '<i class=\"fas fa-info-circle mr-2\"></i>';\n      \n      toast.innerHTML = \\`\\${icon}\\${message}\\`;\n      container.appendChild(toast);\n      \n      setTimeout(() => {\n        toast.classList.add('show');\n      }, 10);\n      \n      setTimeout(() => {\n        toast.classList.remove('show');\n        setTimeout(() => {\n          container.removeChild(toast);\n        }, 300);\n      }, 3000);\n    }\n    \n    async function loadConfig() {\n      try {\n        const response = await fetch('/api/config');\n        const config = await response.json();\n        \n        document.getElementById('adminUsername').value = config.ADMIN_USERNAME || '';\n        document.getElementById('tgBotToken').value = config.TG_BOT_TOKEN || '';\n        document.getElementById('tgChatId').value = config.TG_CHAT_ID || '';\n        document.getElementById('notifyxApiKey').value = config.NOTIFYX_API_KEY || '';\n        document.getElementById('wenotifyUrl').value = config.WENOTIFY_URL || '';\n        document.getElementById('wenotifyToken').value = config.WENOTIFY_TOKEN || '';\n        document.getElementById('wenotifyUserid').value = config.WENOTIFY_USERID || '';\n        document.getElementById('wenotifyTemplateId').value = config.WENOTIFY_TEMPLATE_ID || '';\n        document.getElementById('webhookUrl').value = config.WEBHOOK_URL || '';\n        document.getElementById('webhookMethod').value = config.WEBHOOK_METHOD || 'POST';\n        document.getElementById('webhookHeaders').value = config.WEBHOOK_HEADERS || '';\n        document.getElementById('webhookTemplate').value = config.WEBHOOK_TEMPLATE || '';\n        document.getElementById('showLunarGlobal').checked = config.SHOW_LUNAR === true;\n        document.getElementById('wechatbotWebhook').value = config.WECHATBOT_WEBHOOK || '';\n        document.getElementById('wechatbotMsgType').value = config.WECHATBOT_MSG_TYPE || 'text';\n        document.getElementById('wechatbotAtMobiles').value = config.WECHATBOT_AT_MOBILES || '';\n        document.getElementById('wechatbotAtAll').checked = config.WECHATBOT_AT_ALL === 'true';\n        document.getElementById('resendApiKey').value = config.RESEND_API_KEY || '';\n        document.getElementById('emailFrom').value = config.EMAIL_FROM || '';\n        document.getElementById('emailFromName').value = config.EMAIL_FROM_NAME || '';\n        document.getElementById('emailTo').value = config.EMAIL_TO || '';\n        document.getElementById('barkServer').value = config.BARK_SERVER || 'https://api.day.app';\n        document.getElementById('barkDeviceKey').value = config.BARK_DEVICE_KEY || '';\n        document.getElementById('barkIsArchive').checked = config.BARK_IS_ARCHIVE === 'true';\n\n        // \u521D\u59CB\u5316\u65F6\u533A\u9009\u62E9\n        initTimezoneSelect(config.TIMEZONE || 'UTC');\n\n        const enabledNotifiers = config.ENABLED_NOTIFIERS || ['notifyx'];\n        document.querySelectorAll('input[name=\"enabledNotifiers\"]').forEach(checkbox => {\n          checkbox.checked = enabledNotifiers.includes(checkbox.value);\n        });\n        \n        toggleNotificationConfigs(enabledNotifiers);\n        \n      } catch (error) {\n        console.error('\u52A0\u8F7D\u914D\u7F6E\u5931\u8D25:', error);\n        showToast('\u52A0\u8F7D\u914D\u7F6E\u5931\u8D25\uFF0C\u8BF7\u5237\u65B0\u91CD\u8BD5', 'error');\n      }\n    }\n\n    function initTimezoneSelect(selectedTimezone) {\n      const timezoneSelect = document.getElementById('timezone');\n      \n      // \u5E38\u7528\u65F6\u533A\u5217\u8868\n      const timezones = [\n        { value: 'UTC', name: '\u4E16\u754C\u6807\u51C6\u65F6\u95F4', offset: '+0' },\n        { value: 'Asia/Shanghai', name: '\u4E2D\u56FD\u6807\u51C6\u65F6\u95F4', offset: '+8' },\n        { value: 'Asia/Hong_Kong', name: '\u9999\u6E2F\u65F6\u95F4', offset: '+8' },\n        { value: 'Asia/Taipei', name: '\u53F0\u5317\u65F6\u95F4', offset: '+8' },\n        { value: 'Asia/Singapore', name: '\u65B0\u52A0\u5761\u65F6\u95F4', offset: '+8' },\n        { value: 'Asia/Tokyo', name: '\u65E5\u672C\u65F6\u95F4', offset: '+9' },\n        { value: 'Asia/Seoul', name: '\u97E9\u56FD\u65F6\u95F4', offset: '+9' },\n        { value: 'America/New_York', name: '\u7F8E\u56FD\u4E1C\u90E8\u65F6\u95F4', offset: '-5' },\n        { value: 'America/Chicago', name: '\u7F8E\u56FD\u4E2D\u90E8\u65F6\u95F4', offset: '-6' },\n        { value: 'America/Denver', name: '\u7F8E\u56FD\u5C71\u5730\u65F6\u95F4', offset: '-7' },\n        { value: 'America/Los_Angeles', name: '\u7F8E\u56FD\u592A\u5E73\u6D0B\u65F6\u95F4', offset: '-8' },\n        { value: 'Europe/London', name: '\u82F1\u56FD\u65F6\u95F4', offset: '+0' },\n        { value: 'Europe/Paris', name: '\u5DF4\u9ECE\u65F6\u95F4', offset: '+1' },\n        { value: 'Europe/Berlin', name: '\u67CF\u6797\u65F6\u95F4', offset: '+1' },\n        { value: 'Europe/Moscow', name: '\u83AB\u65AF\u79D1\u65F6\u95F4', offset: '+3' },\n        { value: 'Australia/Sydney', name: '\u6089\u5C3C\u65F6\u95F4', offset: '+10' },\n        { value: 'Australia/Melbourne', name: '\u58A8\u5C14\u672C\u65F6\u95F4', offset: '+10' },\n        { value: 'Pacific/Auckland', name: '\u5965\u514B\u5170\u65F6\u95F4', offset: '+12' }\n      ];\n      \n      // \u6E05\u7A7A\u73B0\u6709\u9009\u9879\n      timezoneSelect.innerHTML = '';\n      \n      // \u6DFB\u52A0\u65B0\u9009\u9879\n      timezones.forEach(tz => {\n        const option = document.createElement('option');\n        option.value = tz.value;\n        option.textContent = tz.name + '\uFF08UTC' + tz.offset + '\uFF09';\n        timezoneSelect.appendChild(option);\n      });\n      \n      // \u8BBE\u7F6E\u9009\u4E2D\u7684\u65F6\u533A\n      timezoneSelect.value = selectedTimezone;\n    }\n    \n    function toggleNotificationConfigs(enabledNotifiers) {\n      const telegramConfig = document.getElementById('telegramConfig');\n      const notifyxConfig = document.getElementById('notifyxConfig');\n      const wenotifyConfig = document.getElementById('wenotifyConfig');\n      const webhookConfig = document.getElementById('webhookConfig');\n      const wechatbotConfig = document.getElementById('wechatbotConfig');\n      const emailConfig = document.getElementById('emailConfig');\n      const barkConfig = document.getElementById('barkConfig');\n\n      // \u91CD\u7F6E\u6240\u6709\u914D\u7F6E\u533A\u57DF\n      [telegramConfig, notifyxConfig, wenotifyConfig, webhookConfig, wechatbotConfig, emailConfig, barkConfig].forEach(config => {\n        config.classList.remove('active', 'inactive');\n        config.classList.add('inactive');\n      });\n\n      // \u6FC0\u6D3B\u9009\u4E2D\u7684\u914D\u7F6E\u533A\u57DF\n      enabledNotifiers.forEach(type => {\n        if (type === 'telegram') {\n          telegramConfig.classList.remove('inactive');\n          telegramConfig.classList.add('active');\n        } else if (type === 'notifyx') {\n          notifyxConfig.classList.remove('inactive');\n          notifyxConfig.classList.add('active');\n        } else if (type === 'wenotify') {\n          wenotifyConfig.classList.remove('inactive');\n          wenotifyConfig.classList.add('active');\n        } else if (type === 'webhook') {\n          webhookConfig.classList.remove('inactive');\n          webhookConfig.classList.add('active');\n        } else if (type === 'wechatbot') {\n          wechatbotConfig.classList.remove('inactive');\n          wechatbotConfig.classList.add('active');\n        } else if (type === 'email') {\n          emailConfig.classList.remove('inactive');\n          emailConfig.classList.add('active');\n        } else if (type === 'bark') {\n          barkConfig.classList.remove('inactive');\n          barkConfig.classList.add('active');\n        }\n      });\n    }\n\n    document.querySelectorAll('input[name=\"enabledNotifiers\"]').forEach(checkbox => {\n      checkbox.addEventListener('change', () => {\n        const enabledNotifiers = Array.from(document.querySelectorAll('input[name=\"enabledNotifiers\"]:checked'))\n          .map(cb => cb.value);\n        toggleNotificationConfigs(enabledNotifiers);\n      });\n    });\n    \n    document.getElementById('configForm').addEventListener('submit', async (e) => {\n      e.preventDefault();\n\n      const enabledNotifiers = Array.from(document.querySelectorAll('input[name=\"enabledNotifiers\"]:checked'))\n        .map(cb => cb.value);\n\n      if (enabledNotifiers.length === 0) {\n        showToast('\u8BF7\u81F3\u5C11\u9009\u62E9\u4E00\u79CD\u901A\u77E5\u65B9\u5F0F', 'warning');\n        return;\n      }\n\n      const config = {\n        ADMIN_USERNAME: document.getElementById('adminUsername').value.trim(),\n        TG_BOT_TOKEN: document.getElementById('tgBotToken').value.trim(),\n        TG_CHAT_ID: document.getElementById('tgChatId').value.trim(),\n        NOTIFYX_API_KEY: document.getElementById('notifyxApiKey').value.trim(),\n        WENOTIFY_URL: document.getElementById('wenotifyUrl').value.trim(),\n        WENOTIFY_TOKEN: document.getElementById('wenotifyToken').value.trim(),\n        WENOTIFY_USERID: document.getElementById('wenotifyUserid').value.trim(),\n        WENOTIFY_TEMPLATE_ID: document.getElementById('wenotifyTemplateId').value.trim(),\n        WEBHOOK_URL: document.getElementById('webhookUrl').value.trim(),\n        WEBHOOK_METHOD: document.getElementById('webhookMethod').value,\n        WEBHOOK_HEADERS: document.getElementById('webhookHeaders').value.trim(),\n        WEBHOOK_TEMPLATE: document.getElementById('webhookTemplate').value.trim(),\n        SHOW_LUNAR: document.getElementById('showLunarGlobal').checked,\n        WECHATBOT_WEBHOOK: document.getElementById('wechatbotWebhook').value.trim(),\n        WECHATBOT_MSG_TYPE: document.getElementById('wechatbotMsgType').value,\n        WECHATBOT_AT_MOBILES: document.getElementById('wechatbotAtMobiles').value.trim(),\n        WECHATBOT_AT_ALL: document.getElementById('wechatbotAtAll').checked.toString(),\n        RESEND_API_KEY: document.getElementById('resendApiKey').value.trim(),\n        EMAIL_FROM: document.getElementById('emailFrom').value.trim(),\n        EMAIL_FROM_NAME: document.getElementById('emailFromName').value.trim(),\n        EMAIL_TO: document.getElementById('emailTo').value.trim(),\n        BARK_SERVER: document.getElementById('barkServer').value.trim() || 'https://api.day.app',\n        BARK_DEVICE_KEY: document.getElementById('barkDeviceKey').value.trim(),\n        BARK_IS_ARCHIVE: document.getElementById('barkIsArchive').checked.toString(),\n        ENABLED_NOTIFIERS: enabledNotifiers,\n        TIMEZONE: document.getElementById('timezone').value.trim()\n      };\n\n      const passwordField = document.getElementById('adminPassword');\n      if (passwordField.value.trim()) {\n        config.ADMIN_PASSWORD = passwordField.value.trim();\n      }\n\n      const submitButton = e.target.querySelector('button[type=\"submit\"]');\n      const originalContent = submitButton.innerHTML;\n      submitButton.innerHTML = '<i class=\"fas fa-spinner fa-spin mr-2\"></i>\u4FDD\u5B58\u4E2D...';\n      submitButton.disabled = true;\n\n      try {\n        const response = await fetch('/api/config', {\n          method: 'POST',\n          headers: { 'Content-Type': 'application/json' },\n          body: JSON.stringify(config)\n        });\n\n        const result = await response.json();\n\n        if (result.success) {\n          showToast('\u914D\u7F6E\u4FDD\u5B58\u6210\u529F', 'success');\n          passwordField.value = '';\n          \n          // \u66F4\u65B0\u5168\u5C40\u65F6\u533A\u5E76\u91CD\u65B0\u663E\u793A\u65F6\u95F4\n          globalTimezone = config.TIMEZONE;\n          showSystemTime();\n          \n          // \u6807\u8BB0\u65F6\u533A\u5DF2\u66F4\u65B0\uFF0C\u4F9B\u5176\u4ED6\u9875\u9762\u68C0\u6D4B\n          localStorage.setItem('timezoneUpdated', Date.now().toString());\n          \n          // \u5982\u679C\u5F53\u524D\u5728\u8BA2\u9605\u5217\u8868\u9875\u9762\uFF0C\u5219\u81EA\u52A8\u5237\u65B0\u9875\u9762\u4EE5\u66F4\u65B0\u65F6\u533A\u663E\u793A\n          if (window.location.pathname === '/admin') {\n            window.location.reload();\n          }\n        } else {\n          showToast('\u914D\u7F6E\u4FDD\u5B58\u5931\u8D25: ' + (result.message || '\u672A\u77E5\u9519\u8BEF'), 'error');\n        }\n      } catch (error) {\n        console.error('\u4FDD\u5B58\u914D\u7F6E\u5931\u8D25:', error);\n        showToast('\u4FDD\u5B58\u914D\u7F6E\u5931\u8D25\uFF0C\u8BF7\u7A0D\u540E\u518D\u8BD5', 'error');\n      } finally {\n        submitButton.innerHTML = originalContent;\n        submitButton.disabled = false;\n      }\n    });\n    \n    async function testNotification(type) {\n      const buttonId = type === 'telegram' ? 'testTelegramBtn' :\n                      type === 'notifyx' ? 'testNotifyXBtn' :\n                      type === 'wenotify' ? 'testWeNotifyBtn' :\n                      type === 'wechatbot' ? 'testWechatBotBtn' :\n                      type === 'email' ? 'testEmailBtn' :\n                      type === 'bark' ? 'testBarkBtn' : 'testWebhookBtn';\n      const button = document.getElementById(buttonId);\n      const originalContent = button.innerHTML;\n      const serviceName = type === 'telegram' ? 'Telegram' :\n                          type === 'notifyx' ? 'NotifyX' :\n                          type === 'wenotify' ? 'WeNotify Edge' :\n                          type === 'wechatbot' ? '\u4F01\u4E1A\u5FAE\u4FE1\u673A\u5668\u4EBA' :\n                          type === 'email' ? '\u90AE\u4EF6\u901A\u77E5' :\n                          type === 'bark' ? 'Bark' : '\u4F01\u4E1A\u5FAE\u4FE1\u5E94\u7528\u901A\u77E5';\n\n      button.innerHTML = '<i class=\"fas fa-spinner fa-spin mr-2\"></i>\u6D4B\u8BD5\u4E2D...';\n      button.disabled = true;\n\n      const config = {};\n      if (type === 'telegram') {\n        config.TG_BOT_TOKEN = document.getElementById('tgBotToken').value.trim();\n        config.TG_CHAT_ID = document.getElementById('tgChatId').value.trim();\n\n        if (!config.TG_BOT_TOKEN || !config.TG_CHAT_ID) {\n          showToast('\u8BF7\u5148\u586B\u5199 Telegram Bot Token \u548C Chat ID', 'warning');\n          button.innerHTML = originalContent;\n          button.disabled = false;\n          return;\n        }\n      } else if (type === 'notifyx') {\n        config.NOTIFYX_API_KEY = document.getElementById('notifyxApiKey').value.trim();\n\n        if (!config.NOTIFYX_API_KEY) {\n          showToast('\u8BF7\u5148\u586B\u5199 NotifyX API Key', 'warning');\n          button.innerHTML = originalContent;\n          button.disabled = false;\n          return;\n        }\n      } else if (type === 'wenotify') {\n        config.WENOTIFY_URL = document.getElementById('wenotifyUrl').value.trim();\n        config.WENOTIFY_TOKEN = document.getElementById('wenotifyToken').value.trim();\n        config.WENOTIFY_USERID = document.getElementById('wenotifyUserid').value.trim();\n        config.WENOTIFY_TEMPLATE_ID = document.getElementById('wenotifyTemplateId').value.trim();\n\n        if (!config.WENOTIFY_URL || !config.WENOTIFY_TOKEN) {\n          showToast('\u8BF7\u5148\u586B\u5199 WeNotify Edge \u670D\u52A1\u5730\u5740\u548C API Token', 'warning');\n          button.innerHTML = originalContent;\n          button.disabled = false;\n          return;\n        }\n      } else if (type === 'webhook') {\n        config.WEBHOOK_URL = document.getElementById('webhookUrl').value.trim();\n        config.WEBHOOK_METHOD = document.getElementById('webhookMethod').value;\n        config.WEBHOOK_HEADERS = document.getElementById('webhookHeaders').value.trim();\n        config.WEBHOOK_TEMPLATE = document.getElementById('webhookTemplate').value.trim();\n\n        if (!config.WEBHOOK_URL) {\n          showToast('\u8BF7\u5148\u586B\u5199 \u4F01\u4E1A\u5FAE\u4FE1\u5E94\u7528\u901A\u77E5 URL', 'warning');\n          button.innerHTML = originalContent;\n          button.disabled = false;\n          return;\n        }\n      } else if (type === 'wechatbot') {\n        config.WECHATBOT_WEBHOOK = document.getElementById('wechatbotWebhook').value.trim();\n        config.WECHATBOT_MSG_TYPE = document.getElementById('wechatbotMsgType').value;\n        config.WECHATBOT_AT_MOBILES = document.getElementById('wechatbotAtMobiles').value.trim();\n        config.WECHATBOT_AT_ALL = document.getElementById('wechatbotAtAll').checked.toString();\n\n        if (!config.WECHATBOT_WEBHOOK) {\n          showToast('\u8BF7\u5148\u586B\u5199\u4F01\u4E1A\u5FAE\u4FE1\u673A\u5668\u4EBA Webhook URL', 'warning');\n          button.innerHTML = originalContent;\n          button.disabled = false;\n          return;\n        }\n      } else if (type === 'email') {\n        config.RESEND_API_KEY = document.getElementById('resendApiKey').value.trim();\n        config.EMAIL_FROM = document.getElementById('emailFrom').value.trim();\n        config.EMAIL_FROM_NAME = document.getElementById('emailFromName').value.trim();\n        config.EMAIL_TO = document.getElementById('emailTo').value.trim();\n\n        if (!config.RESEND_API_KEY || !config.EMAIL_FROM || !config.EMAIL_TO) {\n          showToast('\u8BF7\u5148\u586B\u5199 Resend API Key\u3001\u53D1\u4EF6\u4EBA\u90AE\u7BB1\u548C\u6536\u4EF6\u4EBA\u90AE\u7BB1', 'warning');\n          button.innerHTML = originalContent;\n          button.disabled = false;\n          return;\n        }\n      } else if (type === 'bark') {\n        config.BARK_SERVER = document.getElementById('barkServer').value.trim() || 'https://api.day.app';\n        config.BARK_DEVICE_KEY = document.getElementById('barkDeviceKey').value.trim();\n        config.BARK_IS_ARCHIVE = document.getElementById('barkIsArchive').checked.toString();\n\n        if (!config.BARK_DEVICE_KEY) {\n          showToast('\u8BF7\u5148\u586B\u5199 Bark \u8BBE\u5907Key', 'warning');\n          button.innerHTML = originalContent;\n          button.disabled = false;\n          return;\n        }\n      }\n\n      try {\n        const response = await fetch('/api/test-notification', {\n          method: 'POST',\n          headers: { 'Content-Type': 'application/json' },\n          body: JSON.stringify({ type: type, ...config })\n        });\n\n        const result = await response.json();\n\n        if (result.success) {\n          showToast(serviceName + ' \u901A\u77E5\u6D4B\u8BD5\u6210\u529F\uFF01', 'success');\n        } else {\n          showToast(serviceName + ' \u901A\u77E5\u6D4B\u8BD5\u5931\u8D25: ' + (result.message || '\u672A\u77E5\u9519\u8BEF'), 'error');\n        }\n      } catch (error) {\n        console.error('\u6D4B\u8BD5\u901A\u77E5\u5931\u8D25:', error);\n        showToast('\u6D4B\u8BD5\u5931\u8D25\uFF0C\u8BF7\u7A0D\u540E\u518D\u8BD5', 'error');\n      } finally {\n        button.innerHTML = originalContent;\n        button.disabled = false;\n      }\n    }\n    \n    document.getElementById('testTelegramBtn').addEventListener('click', () => {\n      testNotification('telegram');\n    });\n    \n    document.getElementById('testNotifyXBtn').addEventListener('click', () => {\n      testNotification('notifyx');\n    });\n\n    document.getElementById('testWeNotifyBtn').addEventListener('click', () => {\n      testNotification('wenotify');\n    });\n\n    document.getElementById('testWebhookBtn').addEventListener('click', () => {\n      testNotification('webhook');\n    });\n\n    document.getElementById('testWechatBotBtn').addEventListener('click', () => {\n      testNotification('wechatbot');\n    });\n\n    document.getElementById('testEmailBtn').addEventListener('click', () => {\n      testNotification('email');\n    });\n\n    document.getElementById('testBarkBtn').addEventListener('click', () => {\n      testNotification('bark');\n    });\n\n    window.addEventListener('load', loadConfig);\n    \n    // \u5168\u5C40\u65F6\u533A\u914D\u7F6E\n    let globalTimezone = 'UTC';\n    \n    // \u5B9E\u65F6\u663E\u793A\u7CFB\u7EDF\u65F6\u95F4\u548C\u65F6\u533A\n    async function showSystemTime() {\n      try {\n        // \u83B7\u53D6\u540E\u53F0\u914D\u7F6E\u7684\u65F6\u533A\n        const response = await fetch('/api/config');\n        const config = await response.json();\n        globalTimezone = config.TIMEZONE || 'UTC';\n        \n        // \u683C\u5F0F\u5316\u5F53\u524D\u65F6\u95F4\n        function formatTime(dt, tz) {\n          return dt.toLocaleString('zh-CN', { timeZone: tz, year: 'numeric', month: '2-digit', day: '2-digit', hour: '2-digit', minute: '2-digit', second: '2-digit' });\n        }\n        function formatTimezoneDisplay(tz) {\n          try {\n            // \u4F7F\u7528\u66F4\u51C6\u786E\u7684\u65F6\u533A\u504F\u79FB\u8BA1\u7B97\u65B9\u6CD5\n            const now = new Date();\n            const dtf = new Intl.DateTimeFormat('en-US', {\n              timeZone: tz,\n              hour12: false,\n              year: 'numeric', month: '2-digit', day: '2-digit',\n              hour: '2-digit', minute: '2-digit', second: '2-digit'\n            });\n            const parts = dtf.formatToParts(now);\n            const get = type => Number(parts.find(x => x.type === type).value);\n            const target = Date.UTC(get('year'), get('month') - 1, get('day'), get('hour'), get('minute'), get('second'));\n            const utc = now.getTime();\n            const offset = Math.round((target - utc) / (1000 * 60 * 60));\n            \n            // \u65F6\u533A\u4E2D\u6587\u540D\u79F0\u6620\u5C04\n            const timezoneNames = {\n              'UTC': '\u4E16\u754C\u6807\u51C6\u65F6\u95F4',\n              'Asia/Shanghai': '\u4E2D\u56FD\u6807\u51C6\u65F6\u95F4',\n              'Asia/Hong_Kong': '\u9999\u6E2F\u65F6\u95F4',\n              'Asia/Taipei': '\u53F0\u5317\u65F6\u95F4',\n              'Asia/Singapore': '\u65B0\u52A0\u5761\u65F6\u95F4',\n              'Asia/Tokyo': '\u65E5\u672C\u65F6\u95F4',\n              'Asia/Seoul': '\u97E9\u56FD\u65F6\u95F4',\n              'America/New_York': '\u7F8E\u56FD\u4E1C\u90E8\u65F6\u95F4',\n              'America/Los_Angeles': '\u7F8E\u56FD\u592A\u5E73\u6D0B\u65F6\u95F4',\n              'America/Chicago': '\u7F8E\u56FD\u4E2D\u90E8\u65F6\u95F4',\n              'America/Denver': '\u7F8E\u56FD\u5C71\u5730\u65F6\u95F4',\n              'Europe/London': '\u82F1\u56FD\u65F6\u95F4',\n              'Europe/Paris': '\u5DF4\u9ECE\u65F6\u95F4',\n              'Europe/Berlin': '\u67CF\u6797\u65F6\u95F4',\n              'Europe/Moscow': '\u83AB\u65AF\u79D1\u65F6\u95F4',\n              'Australia/Sydney': '\u6089\u5C3C\u65F6\u95F4',\n              'Australia/Melbourne': '\u58A8\u5C14\u672C\u65F6\u95F4',\n              'Pacific/Auckland': '\u5965\u514B\u5170\u65F6\u95F4'\n            };\n            \n            const offsetStr = offset >= 0 ? '+' + offset : offset;\n            const timezoneName = timezoneNames[tz] || tz;\n            return timezoneName + ' (UTC' + offsetStr + ')';\n          } catch (error) {\n            console.error('\u683C\u5F0F\u5316\u65F6\u533A\u663E\u793A\u5931\u8D25:', error);\n            return tz;\n          }\n        }\n        function update() {\n          const now = new Date();\n          const timeStr = formatTime(now, globalTimezone);\n          const tzStr = formatTimezoneDisplay(globalTimezone);\n          const el = document.getElementById('systemTimeDisplay');\n          if (el) {\n            el.textContent = timeStr + '  ' + tzStr;\n          }\n        }\n        update();\n        // \u6BCF\u79D2\u5237\u65B0\n        setInterval(update, 1000);\n        \n        // \u5B9A\u671F\u68C0\u67E5\u65F6\u533A\u53D8\u5316\u5E76\u91CD\u65B0\u52A0\u8F7D\u8BA2\u9605\u5217\u8868\uFF08\u6BCF30\u79D2\u68C0\u67E5\u4E00\u6B21\uFF09\n        setInterval(async () => {\n          try {\n            const response = await fetch('/api/config');\n            const config = await response.json();\n            const newTimezone = config.TIMEZONE || 'UTC';\n            \n            if (globalTimezone !== newTimezone) {\n              globalTimezone = newTimezone;\n              console.log('\u65F6\u533A\u5DF2\u66F4\u65B0\u4E3A:', globalTimezone);\n              // \u91CD\u65B0\u52A0\u8F7D\u8BA2\u9605\u5217\u8868\u4EE5\u66F4\u65B0\u5929\u6570\u8BA1\u7B97\n              loadSubscriptions();\n            }\n          } catch (error) {\n            console.error('\u68C0\u67E5\u65F6\u533A\u66F4\u65B0\u5931\u8D25:', error);\n          }\n        }, 30000);\n      } catch (e) {\n        // \u51FA\u9519\u65F6\u663E\u793A\u672C\u5730\u65F6\u95F4\n        const el = document.getElementById('systemTimeDisplay');\n        if (el) {\n          el.textContent = new Date().toLocaleString();\n        }\n      }\n    }\n    showSystemTime();\n  </script>\n</body>\n</html>\n`;\n", "export const loginPage = `\r\n<!DOCTYPE html>\r\n<html>\r\n<head>\r\n  <meta charset=\"UTF-8\">\r\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\r\n  <title>\u8BA2\u9605\u7BA1\u7406\u7CFB\u7EDF</title>\r\n  <link href=\"https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css\" rel=\"stylesheet\">\r\n  <link href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css\" rel=\"stylesheet\">\r\n  <style>\r\n    .login-container {\r\n      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\r\n      min-height: 100vh;\r\n    }\r\n    .login-box {\r\n      backdrop-filter: blur(8px);\r\n      background-color: rgba(255, 255, 255, 0.9);\r\n      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);\r\n    }\r\n    .btn-primary {\r\n      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\r\n      transition: all 0.3s;\r\n    }\r\n    .btn-primary:hover {\r\n      transform: translateY(-2px);\r\n      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);\r\n    }\r\n    .input-field {\r\n      transition: all 0.3s;\r\n      border: 1px solid #e2e8f0;\r\n    }\r\n    .input-field:focus {\r\n      border-color: #667eea;\r\n      box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.25);\r\n    }\r\n  </style>\r\n</head>\r\n<body class=\"login-container flex items-center justify-center\">\r\n  <div class=\"login-box p-8 rounded-xl w-full max-w-md\">\r\n    <div class=\"text-center mb-8\">\r\n      <h1 class=\"text-2xl font-bold text-gray-800\"><i class=\"fas fa-calendar-check mr-2\"></i>\u8BA2\u9605\u7BA1\u7406\u7CFB\u7EDF</h1>\r\n      <p class=\"text-gray-600 mt-2\">\u767B\u5F55\u7BA1\u7406\u60A8\u7684\u8BA2\u9605\u63D0\u9192</p>\r\n    </div>\r\n    \r\n    <form id=\"loginForm\" class=\"space-y-6\">\r\n      <div>\r\n        <label for=\"username\" class=\"block text-sm font-medium text-gray-700 mb-1\">\r\n          <i class=\"fas fa-user mr-2\"></i>\u7528\u6237\u540D\r\n        </label>\r\n        <input type=\"text\" id=\"username\" name=\"username\" required\r\n          class=\"input-field w-full px-4 py-3 rounded-lg text-gray-700 focus:outline-none\">\r\n      </div>\r\n      \r\n      <div>\r\n        <label for=\"password\" class=\"block text-sm font-medium text-gray-700 mb-1\">\r\n          <i class=\"fas fa-lock mr-2\"></i>\u5BC6\u7801\r\n        </label>\r\n        <input type=\"password\" id=\"password\" name=\"password\" required\r\n          class=\"input-field w-full px-4 py-3 rounded-lg text-gray-700 focus:outline-none\">\r\n      </div>\r\n      \r\n      <button type=\"submit\" \r\n        class=\"btn-primary w-full py-3 rounded-lg text-white font-medium focus:outline-none\">\r\n        <i class=\"fas fa-sign-in-alt mr-2\"></i>\u767B\u5F55\r\n      </button>\r\n      \r\n      <div id=\"errorMsg\" class=\"text-red-500 text-center\"></div>\r\n    </form>\r\n  </div>\r\n  \r\n  <script>\r\n    document.getElementById('loginForm').addEventListener('submit', async (e) => {\r\n      e.preventDefault();\r\n      const username = document.getElementById('username').value;\r\n      const password = document.getElementById('password').value;\r\n      \r\n      const button = e.target.querySelector('button');\r\n      const originalContent = button.innerHTML;\r\n      button.innerHTML = '<i class=\"fas fa-spinner fa-spin mr-2\"></i>\u767B\u5F55\u4E2D...';\r\n      button.disabled = true;\r\n      \r\n      try {\r\n        const response = await fetch('/api/login', {\r\n          method: 'POST',\r\n          headers: { 'Content-Type': 'application/json' },\r\n          body: JSON.stringify({ username, password })\r\n        });\r\n        \r\n        const result = await response.json();\r\n        \r\n        if (result.success) {\r\n          window.location.href = '/admin';\r\n        } else {\r\n          document.getElementById('errorMsg').textContent = result.message || '\u7528\u6237\u540D\u6216\u5BC6\u7801\u9519\u8BEF';\r\n          button.innerHTML = originalContent;\r\n          button.disabled = false;\r\n        }\r\n      } catch (error) {\r\n        document.getElementById('errorMsg').textContent = '\u53D1\u751F\u9519\u8BEF\uFF0C\u8BF7\u7A0D\u540E\u518D\u8BD5';\r\n        button.innerHTML = originalContent;\r\n        button.disabled = false;\r\n      }\r\n    });\r\n  </script>\r\n</body>\r\n</html>\r\n`;\r\n", "export const CryptoJS = {\n  HmacSHA256: function(message: string, key: string) {\n    const keyData = new TextEncoder().encode(key);\n    const messageData = new TextEncoder().encode(message);\n\n    return Promise.resolve().then(() => {\n      return crypto.subtle.importKey(\n        \"raw\",\n        keyData,\n        { name: \"HMAC\", hash: {name: \"SHA-256\"} },\n        false,\n        [\"sign\"]\n      );\n    }).then(cryptoKey => {\n      return crypto.subtle.sign(\n        \"HMAC\",\n        cryptoKey,\n        messageData\n      );\n    }).then(buffer => {\n      const hashArray = Array.from(new Uint8Array(buffer));\n      return hashArray.map(b => b.toString(16).padStart(2, '0')).join('');\n    });\n  }\n};\n\nexport function generateRandomSecret(): string {\n  // \u751F\u6210\u4E00\u4E2A64\u5B57\u7B26\u7684\u968F\u673A\u5BC6\u94A5\n  const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$%^&*';\n  let result = '';\n  for (let i = 0; i < 64; i++) {\n    result += chars.charAt(Math.floor(Math.random() * chars.length));\n  }\n  return result;\n}\n\nexport async function generateJWT(username: string, secret: string): Promise<string> {\n  const header = { alg: 'HS256', typ: 'JWT' };\n  const payload = { username, iat: Math.floor(Date.now() / 1000) };\n\n  const headerBase64 = btoa(JSON.stringify(header));\n  const payloadBase64 = btoa(JSON.stringify(payload));\n\n  const signatureInput = headerBase64 + '.' + payloadBase64;\n  const signature = await CryptoJS.HmacSHA256(signatureInput, secret);\n\n  return headerBase64 + '.' + payloadBase64 + '.' + signature;\n}\n\nexport async function verifyJWT(token: string | null, secret: string): Promise<any> {\n  try {\n    if (!token || !secret) {\n      console.log('[JWT] Token\u6216Secret\u4E3A\u7A7A');\n      return null;\n    }\n\n    const parts = token.split('.');\n    if (parts.length !== 3) {\n      console.log('[JWT] Token\u683C\u5F0F\u9519\u8BEF\uFF0C\u90E8\u5206\u6570\u91CF:', parts.length);\n      return null;\n    }\n\n    const [headerBase64, payloadBase64, signature] = parts;\n    const signatureInput = headerBase64 + '.' + payloadBase64;\n    const expectedSignature = await CryptoJS.HmacSHA256(signatureInput, secret);\n\n    if (signature !== expectedSignature) {\n      console.log('[JWT] \u7B7E\u540D\u9A8C\u8BC1\u5931\u8D25');\n      return null;\n    }\n\n    const payload = JSON.parse(atob(payloadBase64));\n    console.log('[JWT] \u9A8C\u8BC1\u6210\u529F\uFF0C\u7528\u6237:', payload.username);\n    return payload;\n  } catch (error) {\n    console.error('[JWT] \u9A8C\u8BC1\u8FC7\u7A0B\u51FA\u9519:', error);\n    return null;\n  }\n}\n", "import { Config, Env } from '../types';\nimport { generateRandomSecret } from './auth';\n\nexport async function getRawConfig(env: Env): Promise<any> {\n  if (!env.SUBSCRIPTIONS_KV) {\n    console.error('[\u914D\u7F6E] KV\u5B58\u50A8\u672A\u7ED1\u5B9A');\n    return {};\n  }\n  const data = await env.SUBSCRIPTIONS_KV.get('config');\n  return data ? JSON.parse(data) : {};\n}\n\nexport async function getConfig(env: Env): Promise<Config> {\n  try {\n    const config = await getRawConfig(env);\n    console.log('[\u914D\u7F6E] \u4ECEKV\u8BFB\u53D6\u914D\u7F6E:', Object.keys(config).length > 0 ? '\u6210\u529F' : '\u7A7A\u914D\u7F6E');\n\n    // \u786E\u4FDDJWT_SECRET\u7684\u4E00\u81F4\u6027\n    let jwtSecret = config.JWT_SECRET;\n    if (!jwtSecret || jwtSecret === 'your-secret-key') {\n      jwtSecret = generateRandomSecret();\n      console.log('[\u914D\u7F6E] \u751F\u6210\u65B0\u7684JWT\u5BC6\u94A5');\n\n      // \u4FDD\u5B58\u65B0\u7684JWT\u5BC6\u94A5\n      config.JWT_SECRET = jwtSecret;\n      if (env.SUBSCRIPTIONS_KV) {\n        await env.SUBSCRIPTIONS_KV.put('config', JSON.stringify(config));\n      }\n    }\n\n    const finalConfig: Config = {\n      adminUsername: config.ADMIN_USERNAME || 'admin',\n      adminPassword: config.ADMIN_PASSWORD || 'password',\n      jwtSecret: jwtSecret,\n      timezone: config.TIMEZONE || 'UTC',\n      showLunarGlobal: config.SHOW_LUNAR === true,\n      enabledNotifiers: config.ENABLED_NOTIFIERS || ['notifyx'],\n      \n      telegram: {\n        botToken: config.TG_BOT_TOKEN || '',\n        chatId: config.TG_CHAT_ID || ''\n      },\n      \n      notifyx: {\n        apiKey: config.NOTIFYX_API_KEY || ''\n      },\n      \n      wenotify: {\n        url: config.WENOTIFY_URL || '',\n        token: config.WENOTIFY_TOKEN || '',\n        userid: config.WENOTIFY_USERID || '',\n        templateId: config.WENOTIFY_TEMPLATE_ID || ''\n      },\n      \n      wechatBot: {\n        webhook: config.WECHATBOT_WEBHOOK || '',\n        msgType: config.WECHATBOT_MSG_TYPE || 'text',\n        atMobiles: config.WECHATBOT_AT_MOBILES || '',\n        atAll: config.WECHATBOT_AT_ALL || 'false'\n      },\n      \n      webhook: {\n        url: config.WEBHOOK_URL || '',\n        method: config.WEBHOOK_METHOD || 'POST',\n        headers: config.WEBHOOK_HEADERS || '',\n        template: config.WEBHOOK_TEMPLATE || ''\n      },\n      \n      email: {\n        resendApiKey: config.RESEND_API_KEY || '',\n        fromEmail: config.EMAIL_FROM || '',\n        toEmail: config.EMAIL_TO || ''\n      },\n      \n      bark: {\n        server: config.BARK_SERVER || 'https://api.day.app',\n        deviceKey: config.BARK_DEVICE_KEY || '',\n        isArchive: config.BARK_IS_ARCHIVE || 'false'\n      }\n    };\n\n    return finalConfig;\n  } catch (error) {\n    console.error('[\u914D\u7F6E] \u83B7\u53D6\u914D\u7F6E\u5931\u8D25:', error);\n    const defaultJwtSecret = generateRandomSecret();\n\n    return {\n      adminUsername: 'admin',\n      adminPassword: 'password',\n      jwtSecret: defaultJwtSecret,\n      timezone: 'UTC',\n      showLunarGlobal: true,\n      enabledNotifiers: ['notifyx'],\n      telegram: { botToken: '', chatId: '' },\n      notifyx: { apiKey: '' },\n      wenotify: { url: '', token: '', userid: '', templateId: '' },\n      wechatBot: { webhook: '', msgType: 'text', atMobiles: '', atAll: 'false' },\n      webhook: { url: '', method: 'POST', headers: '', template: '' },\n      email: { resendApiKey: '', fromEmail: '', toEmail: '' },\n      bark: { server: 'https://api.day.app', deviceKey: '', isArchive: 'false' }\n    };\n  }\n}\n", "import { getConfig } from '../utils/config';\nimport { Env } from '../types';\n\nexport async function handleDebugRequest(request: Request, env: Env): Promise<Response> {\n  const url = new URL(request.url);\n  try {\n    const config = await getConfig(env);\n    const debugInfo = {\n      timestamp: new Date().toISOString(),\n      pathname: url.pathname,\n      kvBinding: !!env.SUBSCRIPTIONS_KV,\n      configExists: !!config,\n      adminUsername: config.adminUsername || '',\n      hasJwtSecret: !!config.jwtSecret,\n      jwtSecretLength: config.jwtSecret ? config.jwtSecret.length : 0\n    };\n\n    return new Response(`\n<!DOCTYPE html>\n<html>\n<head>\n  <title>\u8C03\u8BD5\u4FE1\u606F</title>\n  <style>\n    body { font-family: monospace; padding: 20px; background: #f5f5f5; }\n    .info { background: white; padding: 15px; margin: 10px 0; border-radius: 5px; }\n    .success { color: green; }\n    .error { color: red; }\n  </style>\n</head>\n<body>\n  <h1>\u7CFB\u7EDF\u8C03\u8BD5\u4FE1\u606F</h1>\n  <div class=\"info\">\n    <h3>\u57FA\u672C\u4FE1\u606F</h3>\n    <p>\u65F6\u95F4: ${debugInfo.timestamp}</p>\n    <p>\u8DEF\u5F84: ${debugInfo.pathname}</p>\n    <p class=\"${debugInfo.kvBinding ? 'success' : 'error'}\">KV\u7ED1\u5B9A: ${debugInfo.kvBinding ? '\u2713' : '\u2717'}</p>\n  </div>\n\n  <div class=\"info\">\n    <h3>\u914D\u7F6E\u4FE1\u606F</h3>\n    <p class=\"${debugInfo.configExists ? 'success' : 'error'}\">\u914D\u7F6E\u5B58\u5728: ${debugInfo.configExists ? '\u2713' : '\u2717'}</p>\n    <p>\u7BA1\u7406\u5458\u7528\u6237\u540D: ${debugInfo.adminUsername}</p>\n    <p class=\"${debugInfo.hasJwtSecret ? 'success' : 'error'}\">JWT\u5BC6\u94A5: ${debugInfo.hasJwtSecret ? '\u2713' : '\u2717'} (\u957F\u5EA6: ${debugInfo.jwtSecretLength})</p>\n  </div>\n\n  <div class=\"info\">\n    <h3>\u89E3\u51B3\u65B9\u6848</h3>\n    <p>1. \u786E\u4FDDKV\u547D\u540D\u7A7A\u95F4\u5DF2\u6B63\u786E\u7ED1\u5B9A\u4E3A SUBSCRIPTIONS_KV</p>\n    <p>2. \u5C1D\u8BD5\u8BBF\u95EE <a href=\"/\">/</a> \u8FDB\u884C\u767B\u5F55</p>\n    <p>3. \u5982\u679C\u4ECD\u6709\u95EE\u9898\uFF0C\u8BF7\u68C0\u67E5Cloudflare Workers\u65E5\u5FD7</p>\n  </div>\n</body>\n</html>`, {\n      headers: { 'Content-Type': 'text/html; charset=utf-8' }\n    });\n  } catch (error: any) {\n    return new Response(`\u8C03\u8BD5\u9875\u9762\u9519\u8BEF: ${error.message}`, {\n      status: 500,\n      headers: { 'Content-Type': 'text/plain; charset=utf-8' }\n    });\n  }\n}\n", "/**\n * \u519C\u5386\u8F6C\u6362\u5DE5\u5177\u51FD\u6570\n * \u5305\u542B\u516C\u5386\u8F6C\u519C\u5386\u3001\u519C\u5386\u52A0\u5468\u671F\u7B49\u529F\u80FD\n */\n\ninterface LunarDate {\n  year: number;\n  month: number;\n  day: number;\n  isLeap: boolean;\n  yearStr: string;\n  monthStr: string;\n  dayStr: string;\n  fullStr: string;\n}\n\ninterface SolarDate {\n  year: number;\n  month: number;\n  day: number;\n}\n\nconst lunarCalendar = {\n  // \u519C\u5386\u6570\u636E (1900-2100\u5E74)\n  lunarInfo: [\n    0x04bd8, 0x04ae0, 0x0a570, 0x054d5, 0x0d260, 0x0d950, 0x16554, 0x056a0, 0x09ad0, 0x055d2,\n    0x04ae0, 0x0a5b6, 0x0a4d0, 0x0d250, 0x1d255, 0x0b540, 0x0d6a0, 0x0ada2, 0x095b0, 0x14977,\n    0x04970, 0x0a4b0, 0x0b4b5, 0x06a50, 0x06d40, 0x1ab54, 0x02b60, 0x09570, 0x052f2, 0x04970,\n    0x06566, 0x0d4a0, 0x0ea50, 0x06e95, 0x05ad0, 0x02b60, 0x186e3, 0x092e0, 0x1c8d7, 0x0c950,\n    0x0d4a0, 0x1d8a6, 0x0b550, 0x056a0, 0x1a5b4, 0x025d0, 0x092d0, 0x0d2b2, 0x0a950, 0x0b557,\n    0x06ca0, 0x0b550, 0x15355, 0x04da0, 0x0a5b0, 0x14573, 0x052b0, 0x0a9a8, 0x0e950, 0x06aa0,\n    0x0aea6, 0x0ab50, 0x04b60, 0x0aae4, 0x0a570, 0x05260, 0x0f263, 0x0d950, 0x05b57, 0x056a0,\n    0x096d0, 0x04dd5, 0x04ad0, 0x0a4d0, 0x0d4d4, 0x0d250, 0x0d558, 0x0b540, 0x0b6a0, 0x195a6,\n    0x095b0, 0x049b0, 0x0a974, 0x0a4b0, 0x0b27a, 0x06a50, 0x06d40, 0x0af46, 0x0ab60, 0x09570,\n    0x04af5, 0x04970, 0x064b0, 0x074a3, 0x0ea50, 0x06b58, 0x055c0, 0x0ab60, 0x096d5, 0x092e0,\n    0x0c960, 0x0d954, 0x0d4a0, 0x0da50, 0x07552, 0x056a0, 0x0abb7, 0x025d0, 0x092d0, 0x0cab5,\n    0x0a950, 0x0b4a0, 0x0baa4, 0x0ad50, 0x055d9, 0x04ba0, 0x0a5b0, 0x15176, 0x052b0, 0x0a930,\n    0x07954, 0x06aa0, 0x0ad50, 0x05b52, 0x04b60, 0x0a6e6, 0x0a4e0, 0x0d260, 0x0ea65, 0x0d530,\n    0x05aa0, 0x076a3, 0x096d0, 0x04bd7, 0x04ad0, 0x0a4d0, 0x1d0b6, 0x0d250, 0x0d520, 0x0dd45,\n    0x0b5a0, 0x056d0, 0x055b2, 0x049b0, 0x0a577, 0x0a4b0, 0x0aa50, 0x1b255, 0x06d20, 0x0ada0\n  ],\n\n  // \u5929\u5E72\u5730\u652F\n  gan: ['\u7532', '\u4E59', '\u4E19', '\u4E01', '\u620A', '\u5DF1', '\u5E9A', '\u8F9B', '\u58EC', '\u7678'],\n  zhi: ['\u5B50', '\u4E11', '\u5BC5', '\u536F', '\u8FB0', '\u5DF3', '\u5348', '\u672A', '\u7533', '\u9149', '\u620C', '\u4EA5'],\n\n  // \u519C\u5386\u6708\u4EFD\n  months: ['\u6B63', '\u4E8C', '\u4E09', '\u56DB', '\u4E94', '\u516D', '\u4E03', '\u516B', '\u4E5D', '\u5341', '\u51AC', '\u814A'],\n\n  // \u519C\u5386\u65E5\u671F\n  days: ['\u521D\u4E00', '\u521D\u4E8C', '\u521D\u4E09', '\u521D\u56DB', '\u521D\u4E94', '\u521D\u516D', '\u521D\u4E03', '\u521D\u516B', '\u521D\u4E5D', '\u521D\u5341',\n         '\u5341\u4E00', '\u5341\u4E8C', '\u5341\u4E09', '\u5341\u56DB', '\u5341\u4E94', '\u5341\u516D', '\u5341\u4E03', '\u5341\u516B', '\u5341\u4E5D', '\u4E8C\u5341',\n         '\u5EFF\u4E00', '\u5EFF\u4E8C', '\u5EFF\u4E09', '\u5EFF\u56DB', '\u5EFF\u4E94', '\u5EFF\u516D', '\u5EFF\u4E03', '\u5EFF\u516B', '\u5EFF\u4E5D', '\u4E09\u5341'],\n\n  // \u83B7\u53D6\u519C\u5386\u5E74\u5929\u6570\n  lunarYearDays: function(year: number): number {\n    let sum = 348;\n    for (let i = 0x8000; i > 0x8; i >>= 1) {\n      sum += (this.lunarInfo[year - 1900] & i) ? 1 : 0;\n    }\n    return sum + this.leapDays(year);\n  },\n\n  // \u83B7\u53D6\u95F0\u6708\u5929\u6570\n  leapDays: function(year: number): number {\n    if (this.leapMonth(year)) {\n      return (this.lunarInfo[year - 1900] & 0x10000) ? 30 : 29;\n    }\n    return 0;\n  },\n\n  // \u83B7\u53D6\u95F0\u6708\u6708\u4EFD\n  leapMonth: function(year: number): number {\n    return this.lunarInfo[year - 1900] & 0xf;\n  },\n\n  // \u83B7\u53D6\u519C\u5386\u6708\u5929\u6570\n  monthDays: function(year: number, month: number): number {\n    return (this.lunarInfo[year - 1900] & (0x10000 >> month)) ? 30 : 29;\n  },\n\n  // \u516C\u5386\u8F6C\u519C\u5386\n  solar2lunar: function(year: number, month: number, day: number): LunarDate | null {\n    if (year < 1900 || year > 2100) return null;\n\n    const baseDate = new Date(1900, 0, 31);\n    const objDate = new Date(year, month - 1, day);\n    let offset = Math.round((objDate.getTime() - baseDate.getTime()) / 86400000);\n\n    let temp = 0;\n    let lunarYear = 1900;\n\n    for (lunarYear = 1900; lunarYear < 2101 && offset > 0; lunarYear++) {\n      temp = this.lunarYearDays(lunarYear);\n      offset -= temp;\n    }\n\n    if (offset < 0) {\n      offset += temp;\n      lunarYear--;\n    }\n\n    let lunarMonth = 1;\n    let leap = this.leapMonth(lunarYear);\n    let isLeap = false;\n\n    for (lunarMonth = 1; lunarMonth < 13 && offset > 0; lunarMonth++) {\n      if (leap > 0 && lunarMonth === (leap + 1) && !isLeap) {\n        --lunarMonth;\n        isLeap = true;\n        temp = this.leapDays(lunarYear);\n      } else {\n        temp = this.monthDays(lunarYear, lunarMonth);\n      }\n\n      if (isLeap && lunarMonth === (leap + 1)) isLeap = false;\n      offset -= temp;\n    }\n\n    if (offset === 0 && leap > 0 && lunarMonth === leap + 1) {\n      if (isLeap) {\n        isLeap = false;\n      } else {\n        isLeap = true;\n        --lunarMonth;\n      }\n    }\n\n    if (offset < 0) {\n      offset += temp;\n      --lunarMonth;\n    }\n\n    const lunarDay = offset + 1;\n\n    // \u751F\u6210\u519C\u5386\u5B57\u7B26\u4E32\n    const ganIndex = (lunarYear - 4) % 10;\n    const zhiIndex = (lunarYear - 4) % 12;\n    const yearStr = this.gan[ganIndex] + this.zhi[zhiIndex] + '\u5E74';\n    const monthStr = (isLeap ? '\u95F0' : '') + this.months[lunarMonth - 1] + '\u6708';\n    const dayStr = this.days[lunarDay - 1];\n\n    return {\n      year: lunarYear,\n      month: lunarMonth,\n      day: lunarDay,\n      isLeap: isLeap,\n      yearStr: yearStr,\n      monthStr: monthStr,\n      dayStr: dayStr,\n      fullStr: yearStr + monthStr + dayStr\n    };\n  }\n};\n\n// \u519C\u5386\u52A0\u5468\u671F\uFF0C\u8FD4\u56DE\u65B0\u7684\u519C\u5386\u65E5\u671F\u5BF9\u8C61\nexport function addLunarPeriod(lunar: { year: number, month: number, day: number, isLeap: boolean }, periodValue: number, periodUnit: string): { year: number, month: number, day: number, isLeap: boolean } {\n  let { year, month, day, isLeap } = lunar;\n  if (periodUnit === 'year') {\n    year += periodValue;\n    const leap = lunarCalendar.leapMonth(year);\n    if (isLeap && leap === month) {\n      isLeap = true;\n    } else {\n      isLeap = false;\n    }\n  } else if (periodUnit === 'month') {\n    let totalMonths = (year - 1900) * 12 + (month - 1) + periodValue;\n    year = Math.floor(totalMonths / 12) + 1900;\n    month = (totalMonths % 12) + 1;\n    const leap = lunarCalendar.leapMonth(year);\n    if (isLeap && leap === month) {\n      isLeap = true;\n    } else {\n      isLeap = false;\n    }\n  } else if (periodUnit === 'day') {\n    const solar = lunar2solar(lunar);\n    if (solar) {\n        const date = new Date(solar.year, solar.month - 1, solar.day + periodValue);\n        const newLunar = lunarCalendar.solar2lunar(date.getFullYear(), date.getMonth() + 1, date.getDate());\n        if (newLunar) return { year: newLunar.year, month: newLunar.month, day: newLunar.day, isLeap: newLunar.isLeap };\n    }\n    return lunar; // Fallback\n  }\n\n  let maxDay = isLeap\n    ? lunarCalendar.leapDays(year)\n    : lunarCalendar.monthDays(year, month);\n  let targetDay = Math.min(day, maxDay);\n  \n  // \u7B80\u5355\u56DE\u9000\u5904\u7406\u65E5\u671F\u65E0\u6548\u7684\u60C5\u51B5\n  while (targetDay > 0) {\n    let solar = lunar2solar({ year, month, day: targetDay, isLeap });\n    if (solar) {\n      return { year, month, day: targetDay, isLeap };\n    }\n    targetDay--;\n  }\n  return { year, month, day, isLeap };\n}\n\n// \u519C\u5386\u8F6C\u516C\u5386\uFF08\u904D\u5386\u6CD5\uFF0C\u9002\u75281900-2100\u5E74\uFF09\nexport function lunar2solar(lunar: { year: number, month: number, day: number, isLeap: boolean }): SolarDate | null {\n  for (let y = lunar.year - 1; y <= lunar.year + 1; y++) {\n    for (let m = 1; m <= 12; m++) {\n        // \u5FEB\u901F\u68C0\u67E5\uFF1A\u5982\u679C\u516C\u5386\u6708\u4EFD\u5929\u6570\u5C0F\u4E8E\u519C\u5386\u65E5\u671F\uFF0C\u80AF\u5B9A\u4E0D\u662F\u8FD9\u4E2A\u6708\n        // \u4F46\u4E3A\u4E86\u51C6\u786E\uFF0C\u8FD8\u662F\u904D\u5386\u6240\u6709\u53EF\u80FD\u7684\u65E5\u671F\n        // \u4F18\u5316\uFF1A\u76F4\u63A5\u6784\u9020\u5927\u81F4\u5BF9\u5E94\u7684\u516C\u5386\u65E5\u671F\u8303\u56F4\n      for (let d = 1; d <= 31; d++) {\n        // \u7B80\u5355\u7684\u65E5\u671F\u6709\u6548\u6027\u68C0\u67E5\n        const date = new Date(y, m - 1, d);\n        if (date.getFullYear() !== y || date.getMonth() + 1 !== m || date.getDate() !== d) continue;\n        \n        const l = lunarCalendar.solar2lunar(y, m, d);\n        if (\n          l &&\n          l.year === lunar.year &&\n          l.month === lunar.month &&\n          l.day === lunar.day &&\n          l.isLeap === lunar.isLeap\n        ) {\n          return { year: y, month: m, day: d };\n        }\n      }\n    }\n  }\n  return null;\n}\n\n// \u8DDD\u79BB\u519C\u5386\u65E5\u671F\u8FD8\u6709\u591A\u5C11\u5929\nexport function daysToLunar(lunar: { year: number, month: number, day: number, isLeap: boolean }): number {\n  const solar = lunar2solar(lunar);\n  if (!solar) return 0;\n  \n  const date = new Date(solar.year, solar.month - 1, solar.day);\n  const now = new Date();\n  // \u53EA\u6BD4\u8F83\u65E5\u671F\uFF0C\u5FFD\u7565\u65F6\u95F4\n  date.setHours(0, 0, 0, 0);\n  now.setHours(0, 0, 0, 0);\n  \n  return Math.ceil((date.getTime() - now.getTime()) / (1000 * 60 * 60 * 24));\n}\n \n// \u5BFC\u51FA\u539F\u59CB\u5BF9\u8C61\u4EE5\u4FDD\u6301\u517C\u5BB9\u6027\uFF08\u5982\u679C\u9700\u8981\uFF09\nexport { lunarCalendar };\n\nexport const lunarBiz = {\n  lunar2solar,\n  addLunarPeriod\n};\n", "export function getCurrentTimeInTimezone(timezone = 'UTC'): Date {\n  try {\n    // \u76F4\u63A5\u8FD4\u56DE\u5F53\u524D\u65F6\u95F4\uFF0C\u65F6\u533A\u8F6C\u6362\u5728\u540E\u7EED\u8BA1\u7B97\u4E2D\u5904\u7406\n    // \u8FD9\u6837\u53EF\u4EE5\u907F\u514D\u65F6\u533A\u4FE1\u606F\u4E22\u5931\u7684\u95EE\u9898\n    return new Date();\n  } catch (error: any) {\n    console.error(`\u65F6\u533A\u8F6C\u6362\u9519\u8BEF: ${error.message}`);\n    // \u5982\u679C\u65F6\u533A\u65E0\u6548\uFF0C\u8FD4\u56DEUTC\u65F6\u95F4\n    return new Date();\n  }\n}\n\nexport function getTimestampInTimezone(timezone = 'UTC'): number {\n  return getCurrentTimeInTimezone(timezone).getTime();\n}\n\nexport function convertUTCToTimezone(utcTime: string | number | Date, timezone = 'UTC'): Date {\n  try {\n    // \u76F4\u63A5\u8FD4\u56DE\u539F\u59CB\u65F6\u95F4\uFF0C\u65F6\u533A\u8F6C\u6362\u5728\u540E\u7EED\u8BA1\u7B97\u4E2D\u5904\u7406\n    // \u8FD9\u6837\u53EF\u4EE5\u907F\u514D\u65F6\u533A\u4FE1\u606F\u4E22\u5931\u7684\u95EE\u9898\n    return new Date(utcTime);\n  } catch (error: any) {\n    console.error(`\u65F6\u533A\u8F6C\u6362\u9519\u8BEF: ${error.message}`);\n    return new Date(utcTime);\n  }\n}\n\nexport function calculateExpirationTime(expirationMinutes: number, timezone = 'UTC'): Date {\n  const currentTime = getCurrentTimeInTimezone(timezone);\n  const expirationTime = new Date(currentTime.getTime() + (expirationMinutes * 60 * 1000));\n  return expirationTime;\n}\n\nexport function isExpired(targetTime: string | number | Date, timezone = 'UTC'): boolean {\n  const currentTime = getCurrentTimeInTimezone(timezone);\n  const target = new Date(targetTime);\n  return currentTime > target;\n}\n\nexport function formatTimeInTimezone(time: string | number | Date, timezone = 'UTC', format = 'full'): string {\n  try {\n    const date = new Date(time);\n    \n    if (format === 'date') {\n      return date.toLocaleDateString('zh-CN', {\n        timeZone: timezone,\n        year: 'numeric',\n        month: '2-digit',\n        day: '2-digit'\n      });\n    } else if (format === 'datetime') {\n      return date.toLocaleString('zh-CN', {\n        timeZone: timezone,\n        year: 'numeric',\n        month: '2-digit',\n        day: '2-digit',\n        hour: '2-digit',\n        minute: '2-digit',\n        second: '2-digit'\n      });\n    } else {\n      // full format\n      return date.toLocaleString('zh-CN', {\n        timeZone: timezone\n      });\n    }\n  } catch (error: any) {\n    console.error(`\u65F6\u95F4\u683C\u5F0F\u5316\u9519\u8BEF: ${error.message}`);\n    return new Date(time).toISOString();\n  }\n}\n\nexport function getTimezoneOffset(timezone = 'UTC'): number {\n  try {\n    // \u4F7F\u7528\u66F4\u51C6\u786E\u7684\u65F6\u533A\u504F\u79FB\u8BA1\u7B97\u65B9\u6CD5\n    const now = new Date();\n    const dtf = new Intl.DateTimeFormat('en-US', {\n      timeZone: timezone,\n      hour12: false,\n      year: 'numeric', month: '2-digit', day: '2-digit',\n      hour: '2-digit', minute: '2-digit', second: '2-digit'\n    });\n    const parts = dtf.formatToParts(now);\n    const get = (type: string) => Number(parts.find(x => x.type === type)?.value);\n    const target = Date.UTC(get('year'), get('month') - 1, get('day'), get('hour'), get('minute'), get('second'));\n    const utc = now.getTime();\n    return Math.round((target - utc) / (1000 * 60 * 60));\n  } catch (error: any) {\n    console.error(`\u83B7\u53D6\u65F6\u533A\u504F\u79FB\u91CF\u9519\u8BEF: ${error.message}`);\n    return 0;\n  }\n}\n\nexport function formatTimezoneDisplay(timezone = 'UTC'): string {\n  try {\n    const offset = getTimezoneOffset(timezone);\n    const offsetStr = offset >= 0 ? `+${offset}` : `${offset}`;\n    \n    // \u65F6\u533A\u4E2D\u6587\u540D\u79F0\u6620\u5C04\n    const timezoneNames: {[key: string]: string} = {\n      'UTC': '\u4E16\u754C\u6807\u51C6\u65F6\u95F4',\n      'Asia/Shanghai': '\u4E2D\u56FD\u6807\u51C6\u65F6\u95F4',\n      'Asia/Hong_Kong': '\u9999\u6E2F\u65F6\u95F4',\n      'Asia/Taipei': '\u53F0\u5317\u65F6\u95F4',\n      'Asia/Singapore': '\u65B0\u52A0\u5761\u65F6\u95F4',\n      'Asia/Tokyo': '\u65E5\u672C\u65F6\u95F4',\n      'Asia/Seoul': '\u97E9\u56FD\u65F6\u95F4',\n      'America/New_York': '\u7F8E\u56FD\u4E1C\u90E8\u65F6\u95F4',\n      'America/Los_Angeles': '\u7F8E\u56FD\u592A\u5E73\u6D0B\u65F6\u95F4',\n      'America/Chicago': '\u7F8E\u56FD\u4E2D\u90E8\u65F6\u95F4',\n      'America/Denver': '\u7F8E\u56FD\u5C71\u5730\u65F6\u95F4',\n      'Europe/London': '\u82F1\u56FD\u65F6\u95F4',\n      'Europe/Paris': '\u5DF4\u9ECE\u65F6\u95F4',\n      'Europe/Berlin': '\u67CF\u6797\u65F6\u95F4',\n      'Europe/Moscow': '\u83AB\u65AF\u79D1\u65F6\u95F4',\n      'Australia/Sydney': '\u6089\u5C3C\u65F6\u95F4',\n      'Australia/Melbourne': '\u58A8\u5C14\u672C\u65F6\u95F4',\n      'Pacific/Auckland': '\u5965\u514B\u5170\u65F6\u95F4'\n    };\n    \n    const timezoneName = timezoneNames[timezone] || timezone;\n    return `${timezoneName} (UTC${offsetStr})`;\n  } catch (error) {\n    console.error('\u683C\u5F0F\u5316\u65F6\u533A\u663E\u793A\u5931\u8D25:', error);\n    return timezone;\n  }\n}\n\nexport function isValidTimezone(timezone: string): boolean {\n  try {\n    // \u5C1D\u8BD5\u4F7F\u7528\u8BE5\u65F6\u533A\u683C\u5F0F\u5316\u65F6\u95F4\n    new Date().toLocaleString('en-US', { timeZone: timezone });\n    return true;\n  } catch (error) {\n    return false;\n  }\n}\n", "import { Subscription, Env } from '../types';\nimport { lunarBiz, lunarCalendar } from '../utils/lunar';\nimport { getConfig } from '../utils/config';\nimport { getCurrentTimeInTimezone } from '../utils/date';\n\nexport class SubscriptionService {\n  constructor(private env: Env) {}\n\n  async getAllSubscriptions(): Promise<Subscription[]> {\n    if (!this.env.SUBSCRIPTIONS_KV) return [];\n    const indexStr = await this.env.SUBSCRIPTIONS_KV.get('subscriptions:index');\n    if (indexStr) {\n      const ids: string[] = JSON.parse(indexStr);\n      const items: Subscription[] = [];\n      for (const id of ids) {\n        const s = await this.env.SUBSCRIPTIONS_KV.get('subscription:' + id);\n        if (s) items.push(JSON.parse(s));\n      }\n      return items;\n    }\n    const legacy = await this.env.SUBSCRIPTIONS_KV.get('subscriptions');\n    if (legacy) {\n      const list: Subscription[] = JSON.parse(legacy);\n      const ids = list.map(s => s.id);\n      await this.env.SUBSCRIPTIONS_KV.put('subscriptions:index', JSON.stringify(ids));\n      for (const s of list) {\n        await this.env.SUBSCRIPTIONS_KV.put('subscription:' + s.id, JSON.stringify(s));\n      }\n      return list;\n    }\n    return [];\n  }\n\n  async getSubscription(id: string): Promise<Subscription | undefined> {\n    const s = await this.env.SUBSCRIPTIONS_KV.get('subscription:' + id);\n    if (s) return JSON.parse(s);\n    const subscriptions = await this.getAllSubscriptions();\n    return subscriptions.find(s => s.id === id);\n  }\n\n  async createSubscription(subscription: Partial<Subscription>): Promise<{ success: boolean; message?: string; subscription?: Subscription }> {\n    try {\n      const subscriptions = await this.getAllSubscriptions();\n      const config = await getConfig(this.env);\n      const timezone = config.timezone || 'UTC';\n      const currentTime = getCurrentTimeInTimezone(timezone);\n\n      if (!subscription.name || !subscription.expiryDate) {\n        return { success: false, message: '\u7F3A\u5C11\u5FC5\u586B\u5B57\u6BB5' };\n      }\n\n      let expiryDate = new Date(subscription.expiryDate);\n      let useLunar = !!subscription.useLunar;\n\n      if (useLunar) {\n        let lunar = lunarCalendar.solar2lunar(\n          expiryDate.getFullYear(),\n          expiryDate.getMonth() + 1,\n          expiryDate.getDate()\n        );\n        if (!lunar) {\n           return { success: false, message: '\u519C\u5386\u65E5\u671F\u8D85\u51FA\u652F\u6301\u8303\u56F4\uFF081900-2100\u5E74\uFF09' };\n        }\n        \n        if (subscription.periodValue && subscription.periodUnit) {\n           while (expiryDate <= currentTime) {\n              lunar = lunarBiz.addLunarPeriod(lunar, subscription.periodValue, subscription.periodUnit);\n              const solar = lunarBiz.lunar2solar(lunar);\n              if (!solar) break;\n              expiryDate = new Date(solar.year, solar.month - 1, solar.day);\n           }\n           subscription.expiryDate = expiryDate.toISOString();\n        }\n      } else {\n         if (expiryDate < currentTime && subscription.periodValue && subscription.periodUnit) {\n            while (expiryDate < currentTime) {\n               if (subscription.periodUnit === 'day') {\n                  expiryDate.setDate(expiryDate.getDate() + subscription.periodValue);\n               } else if (subscription.periodUnit === 'month') {\n                  expiryDate.setMonth(expiryDate.getMonth() + subscription.periodValue);\n               } else if (subscription.periodUnit === 'year') {\n                  expiryDate.setFullYear(expiryDate.getFullYear() + subscription.periodValue);\n               }\n            }\n            subscription.expiryDate = expiryDate.toISOString();\n         }\n      }\n\n      const newSubscription: Subscription = {\n        id: (typeof crypto !== 'undefined' && 'randomUUID' in crypto) ? crypto.randomUUID() : Date.now().toString(),\n        name: subscription.name,\n        customType: subscription.customType || '',\n        startDate: subscription.startDate || null,\n        expiryDate: subscription.expiryDate!,\n        periodValue: subscription.periodValue || 1,\n        periodUnit: subscription.periodUnit || 'month',\n        price: subscription.price !== undefined ? Number(subscription.price) : undefined,\n        reminderDays: subscription.reminderDays !== undefined ? subscription.reminderDays : 7,\n        notes: subscription.notes || '',\n        isActive: subscription.isActive !== false,\n        autoRenew: subscription.autoRenew !== false,\n        useLunar: useLunar,\n        createdAt: new Date().toISOString(),\n        updatedAt: new Date().toISOString()\n      };\n\n      const indexStr = await this.env.SUBSCRIPTIONS_KV.get('subscriptions:index');\n      const ids: string[] = indexStr ? JSON.parse(indexStr) : [];\n      ids.push(newSubscription.id);\n      await this.env.SUBSCRIPTIONS_KV.put('subscriptions:index', JSON.stringify(ids));\n      await this.env.SUBSCRIPTIONS_KV.put('subscription:' + newSubscription.id, JSON.stringify(newSubscription));\n      return { success: true, subscription: newSubscription };\n    } catch (error: any) {\n      console.error(\"\u521B\u5EFA\u8BA2\u9605\u5F02\u5E38\uFF1A\", error);\n      return { success: false, message: error.message || '\u521B\u5EFA\u8BA2\u9605\u5931\u8D25' };\n    }\n  }\n\n  async updateSubscription(id: string, subscription: Partial<Subscription>): Promise<{ success: boolean; message?: string; subscription?: Subscription }> {\n    try {\n      const current = await this.getSubscription(id);\n      if (!current) {\n        return { success: false, message: '\u8BA2\u9605\u4E0D\u5B58\u5728' };\n      }\n\n      if (!subscription.name || !subscription.expiryDate) {\n        return { success: false, message: '\u7F3A\u5C11\u5FC5\u586B\u5B57\u6BB5' };\n      }\n\n      let expiryDate = new Date(subscription.expiryDate);\n      const config = await getConfig(this.env);\n      const timezone = config.timezone || 'UTC';\n      const currentTime = getCurrentTimeInTimezone(timezone);\n\n      let useLunar = !!subscription.useLunar;\n      if (useLunar) {\n         let lunar = lunarCalendar.solar2lunar(\n            expiryDate.getFullYear(),\n            expiryDate.getMonth() + 1,\n            expiryDate.getDate()\n         );\n         if (!lunar) return { success: false, message: '\u519C\u5386\u65E5\u671F\u8D85\u51FA\u652F\u6301\u8303\u56F4' };\n         \n         if (expiryDate < currentTime && subscription.periodValue && subscription.periodUnit) {\n            do {\n               lunar = lunarBiz.addLunarPeriod(lunar, subscription.periodValue, subscription.periodUnit);\n               const solar = lunarBiz.lunar2solar(lunar);\n               if (!solar) break; \n               expiryDate = new Date(solar.year, solar.month - 1, solar.day);\n            } while (expiryDate < currentTime);\n            subscription.expiryDate = expiryDate.toISOString();\n         }\n      } else {\n         if (expiryDate < currentTime && subscription.periodValue && subscription.periodUnit) {\n            while (expiryDate < currentTime) {\n               if (subscription.periodUnit === 'day') {\n                  expiryDate.setDate(expiryDate.getDate() + subscription.periodValue);\n               } else if (subscription.periodUnit === 'month') {\n                  expiryDate.setMonth(expiryDate.getMonth() + subscription.periodValue);\n               } else if (subscription.periodUnit === 'year') {\n                  expiryDate.setFullYear(expiryDate.getFullYear() + subscription.periodValue);\n               }\n            }\n            subscription.expiryDate = expiryDate.toISOString();\n         }\n      }\n\n      const updated: Subscription = {\n        ...current,\n        name: subscription.name,\n        customType: subscription.customType || current.customType || '',\n        startDate: subscription.startDate || current.startDate,\n        expiryDate: subscription.expiryDate!,\n        periodValue: subscription.periodValue || current.periodValue || 1,\n        periodUnit: subscription.periodUnit || current.periodUnit || 'month',\n        price: subscription.price !== undefined ? Number(subscription.price) : current.price,\n        reminderDays: subscription.reminderDays !== undefined ? subscription.reminderDays : current.reminderDays,\n        notes: subscription.notes || '',\n        isActive: subscription.isActive !== undefined ? subscription.isActive : current.isActive,\n        autoRenew: subscription.autoRenew !== undefined ? subscription.autoRenew : current.autoRenew,\n        useLunar: useLunar,\n        updatedAt: new Date().toISOString()\n      };\n\n      await this.env.SUBSCRIPTIONS_KV.put('subscription:' + id, JSON.stringify(updated));\n      return { success: true, subscription: updated };\n    } catch (error: any) {\n      return { success: false, message: '\u66F4\u65B0\u8BA2\u9605\u5931\u8D25' };\n    }\n  }\n\n  async deleteSubscription(id: string): Promise<{ success: boolean; message?: string }> {\n    try {\n      const indexStr = await this.env.SUBSCRIPTIONS_KV.get('subscriptions:index');\n      const ids: string[] = indexStr ? JSON.parse(indexStr) : [];\n      const newIds = ids.filter(x => x !== id);\n      if (newIds.length === ids.length) {\n        return { success: false, message: '\u8BA2\u9605\u4E0D\u5B58\u5728' };\n      }\n      await this.env.SUBSCRIPTIONS_KV.put('subscriptions:index', JSON.stringify(newIds));\n      await this.env.SUBSCRIPTIONS_KV.delete('subscription:' + id);\n      return { success: true };\n    } catch (error) {\n      return { success: false, message: '\u5220\u9664\u8BA2\u9605\u5931\u8D25' };\n    }\n  }\n  \n  async toggleSubscriptionStatus(id: string, isActive: boolean): Promise<{ success: boolean; message?: string; subscription?: Subscription }> {\n    try {\n      const current = await this.getSubscription(id);\n      if (!current) return { success: false, message: '\u8BA2\u9605\u4E0D\u5B58\u5728' };\n      const updated: Subscription = {\n        ...current,\n        isActive: isActive,\n        updatedAt: new Date().toISOString()\n      };\n      await this.env.SUBSCRIPTIONS_KV.put('subscription:' + id, JSON.stringify(updated));\n      return { success: true, subscription: updated };\n    } catch (error) {\n      return { success: false, message: '\u66F4\u65B0\u72B6\u6001\u5931\u8D25' };\n    }\n  }\n\n  async checkExpiringSubscriptions(): Promise<{ notifications: { subscription: Subscription; daysUntil: number }[] }> {\n    const subscriptions = await this.getAllSubscriptions();\n    const config = await getConfig(this.env);\n    const timezone = config.timezone || 'UTC';\n    const currentTime = getCurrentTimeInTimezone(timezone);\n    \n    // Normalize current time to start of day for accurate day calculation\n    const today = new Date(currentTime);\n    today.setHours(0, 0, 0, 0);\n\n    const notifications: { subscription: Subscription; daysUntil: number }[] = [];\n    let hasUpdates = false;\n\n    for (let i = 0; i < subscriptions.length; i++) {\n      let sub = subscriptions[i];\n      if (!sub.isActive) continue;\n\n      let expiryDate = new Date(sub.expiryDate);\n      \n      // Calculate days remaining\n      // For calculation, we need to compare dates without time component\n      const expiryCheck = new Date(expiryDate);\n      expiryCheck.setHours(0, 0, 0, 0);\n      \n      const diffTime = expiryCheck.getTime() - today.getTime();\n      const daysRemaining = Math.ceil(diffTime / (1000 * 60 * 60 * 24));\n\n      // Check for auto-renewal if expired\n      if (daysRemaining < 0 && sub.autoRenew) {\n          // Auto-renew logic\n          console.log(`[AutoRenew] Renewing subscription: ${sub.name}`);\n          \n          // Calculate next expiry date based on period\n          if (sub.useLunar) {\n             const currentLunar = lunarCalendar.solar2lunar(\n                expiryDate.getFullYear(),\n                expiryDate.getMonth() + 1,\n                expiryDate.getDate()\n             );\n             if (currentLunar) {\n                 // Add period to lunar date\n                 // We loop until the new expiry date is in the future relative to NOW\n                 // However, for strict adherence to period, we just add one period.\n                 // But if it's long expired, we might need to add multiple.\n                 // Let's assume we add one period at a time or enough to be future.\n                 // Standard logic: Add period until > today.\n                 \n                 let nextLunar = currentLunar;\n                 let nextSolarDate = expiryDate;\n                 \n                 do {\n                     nextLunar = lunarBiz.addLunarPeriod(nextLunar, sub.periodValue || 1, sub.periodUnit || 'month');\n                     const solar = lunarBiz.lunar2solar(nextLunar);\n                     if (!solar) break;\n                     nextSolarDate = new Date(solar.year, solar.month - 1, solar.day);\n                 } while (nextSolarDate < today);\n                 \n                 sub.expiryDate = nextSolarDate.toISOString();\n             }\n          } else {\n             // Solar auto-renew\n             do {\n                if (sub.periodUnit === 'day') {\n                   expiryDate.setDate(expiryDate.getDate() + (sub.periodValue || 1));\n                } else if (sub.periodUnit === 'month') {\n                   expiryDate.setMonth(expiryDate.getMonth() + (sub.periodValue || 1));\n                } else if (sub.periodUnit === 'year') {\n                   expiryDate.setFullYear(expiryDate.getFullYear() + (sub.periodValue || 1));\n                }\n             } while (expiryDate < today);\n             sub.expiryDate = expiryDate.toISOString();\n          }\n          \n          sub.updatedAt = new Date().toISOString();\n          await this.env.SUBSCRIPTIONS_KV.put('subscription:' + sub.id, JSON.stringify(sub));\n          hasUpdates = true;\n          \n          // Recalculate days remaining for the renewed subscription\n          const newExpiry = new Date(sub.expiryDate);\n          newExpiry.setHours(0, 0, 0, 0);\n          const newDiff = newExpiry.getTime() - today.getTime();\n          const newDaysRemaining = Math.ceil(newDiff / (1000 * 60 * 60 * 24));\n          \n          // Add to notifications as \"Renewed\" or just status update?\n          // Usually we want to notify that it was renewed or is now due in X days.\n          // If it's renewed, it might be far in future, so maybe no notification unless reminderDays matches.\n          // But if we want to notify \"Renewed\", we might need a special flag.\n          // For now, let's just check against reminderDays again.\n          \n          if (newDaysRemaining <= (sub.reminderDays || 7) && newDaysRemaining >= 0) {\n             notifications.push({ subscription: sub, daysUntil: newDaysRemaining });\n          }\n      } else {\n          // Regular check\n          if (daysRemaining <= (sub.reminderDays || 7) && daysRemaining >= 0) {\n              notifications.push({ subscription: sub, daysUntil: daysRemaining });\n          } else if (daysRemaining < 0) {\n              // Expired and not auto-renewed\n              notifications.push({ subscription: sub, daysUntil: daysRemaining });\n          }\n      }\n    }\n\n    if (hasUpdates) {\n    }\n\n    return { notifications };\n  }\n\n}\n", "export function getCookieValue(cookieString: string | null, key: string): string | null {\n  if (!cookieString) return null;\n\n  const match = cookieString.match(new RegExp('(^| )' + key + '=([^;]+)'));\n  return match ? match[2] : null;\n}\n\nexport async function requestWithRetry(url: string, options: RequestInit, retries = 1, timeoutMs = 8000): Promise<Response> {\n  let lastError: any = null;\n  for (let attempt = 0; attempt <= retries; attempt++) {\n    const controller = new AbortController();\n    const timer = setTimeout(() => controller.abort(), timeoutMs);\n    try {\n      const resp = await fetch(url, { ...options, signal: controller.signal });\n      clearTimeout(timer);\n      if (resp.ok || attempt === retries) return resp;\n      lastError = new Error('Request failed');\n    } catch (e) {\n      clearTimeout(timer);\n      lastError = e;\n    }\n  }\n  throw lastError;\n}\n", "\nimport { Env, ChannelConfig, Subscription, Config } from '../types';\nimport { formatTimeInTimezone, formatTimezoneDisplay } from '../utils/date';\nimport { lunarCalendar } from '../utils/lunar';\nimport { requestWithRetry } from '../utils/http';\n\n/**\n * \u683C\u5F0F\u5316\u901A\u77E5\u5185\u5BB9\n */\nexport function formatNotificationContent(subscriptions: Subscription[], config: Config): string {\n  const showLunar = config.showLunarGlobal === true;\n  const timezone = config.timezone || 'UTC';\n  let content = '';\n\n  for (const sub of subscriptions) {\n    const typeText = sub.customType || '\u5176\u4ED6';\n    const periodText = (sub.periodValue && sub.periodUnit) ? `(\u5468\u671F: ${sub.periodValue} ${ { day: '\u5929', month: '\u6708', year: '\u5E74' }[sub.periodUnit] || sub.periodUnit})` : '';\n\n    // \u683C\u5F0F\u5316\u5230\u671F\u65E5\u671F\uFF08\u4F7F\u7528\u6240\u9009\u65F6\u533A\uFF09\n    const expiryDateObj = new Date(sub.expiryDate);\n    const formattedExpiryDate = formatTimeInTimezone(expiryDateObj, timezone, 'date');\n    \n    // \u519C\u5386\u65E5\u671F\n    let lunarExpiryText = '';\n    if (showLunar) {\n      const lunarExpiry = lunarCalendar.solar2lunar(expiryDateObj.getFullYear(), expiryDateObj.getMonth() + 1, expiryDateObj.getDate());\n      lunarExpiryText = lunarExpiry ? `\\n\u519C\u5386\u65E5\u671F: ${lunarExpiry.fullStr}` : '';\n    }\n\n    // \u72B6\u6001\u548C\u5230\u671F\u65F6\u95F4\n    let statusText = '';\n    let statusEmoji = '';\n    \n    // \u8BA1\u7B97\u5269\u4F59\u5929\u6570\uFF08\u9700\u8981\u6839\u636E\u65F6\u533A\u91CD\u65B0\u8BA1\u7B97\uFF0C\u786E\u4FDD\u51C6\u786E\uFF09\n    // \u8FD9\u91CC\u7B80\u5355\u4F7F\u7528 sub.daysRemaining\uFF0C\u5047\u8BBE\u8C03\u7528\u524D\u5DF2\u66F4\u65B0\n    if (sub.daysRemaining === 0) {\n      statusEmoji = '\u26A0\uFE0F';\n      statusText = '\u4ECA\u5929\u5230\u671F\uFF01';\n    } else if (sub.daysRemaining !== undefined && sub.daysRemaining < 0) {\n      statusEmoji = '\uD83D\uDEA8';\n      statusText = `\u5DF2\u8FC7\u671F ${Math.abs(sub.daysRemaining)} \u5929`;\n    } else {\n      statusEmoji = '\uD83D\uDCC5';\n      statusText = `\u5C06\u5728 ${sub.daysRemaining} \u5929\u540E\u5230\u671F`;\n    }\n\n    // \u83B7\u53D6\u65E5\u5386\u7C7B\u578B\u548C\u81EA\u52A8\u7EED\u671F\u72B6\u6001\n    const calendarType = sub.useLunar ? '\u519C\u5386' : '\u516C\u5386';\n    const autoRenewText = sub.autoRenew ? '\u662F' : '\u5426';\n    \n    // \u6784\u5EFA\u683C\u5F0F\u5316\u7684\u901A\u77E5\u5185\u5BB9\n    const subscriptionContent = `${statusEmoji} **${sub.name}**\n\u7C7B\u578B: ${typeText} ${periodText}\n\u65E5\u5386\u7C7B\u578B: ${calendarType}\n\u5230\u671F\u65E5\u671F: ${formattedExpiryDate}${lunarExpiryText}\n\u81EA\u52A8\u7EED\u671F: ${autoRenewText}\n\u5230\u671F\u72B6\u6001: ${statusText}`;\n\n    // \u6DFB\u52A0\u5907\u6CE8\n    let finalContent = sub.notes ? \n      subscriptionContent + `\\n\u5907\u6CE8: ${sub.notes}` : \n      subscriptionContent;\n\n    content += finalContent + '\\n\\n';\n  }\n\n  // \u6DFB\u52A0\u53D1\u9001\u65F6\u95F4\u548C\u65F6\u533A\u4FE1\u606F\n  const currentTime = formatTimeInTimezone(new Date(), timezone, 'datetime');\n  content += `\u53D1\u9001\u65F6\u95F4: ${currentTime}\\n\u5F53\u524D\u65F6\u533A: ${formatTimezoneDisplay(timezone)}`;\n\n  return content;\n}\n\n/**\n * \u53D1\u9001\u901A\u77E5\u5230\u6240\u6709\u542F\u7528\u7684\u6E20\u9053\n */\nexport async function sendNotificationToAllChannels(title: string, commonContent: string, config: Config, logPrefix = '[\u5B9A\u65F6\u4EFB\u52A1]'): Promise<void> {\n    if (!config.enabledNotifiers || config.enabledNotifiers.length === 0) {\n        console.log(`${logPrefix} \u672A\u542F\u7528\u4EFB\u4F55\u901A\u77E5\u6E20\u9053\u3002`);\n        return;\n    }\n\n    if (config.enabledNotifiers.includes('notifyx')) {\n        const notifyxContent = `## ${title}\\n\\n${commonContent}`;\n        const success = await sendNotifyXNotification(title, notifyxContent, `\u8BA2\u9605\u63D0\u9192`, config);\n        console.log(`${logPrefix} \u53D1\u9001NotifyX\u901A\u77E5 ${success ? '\u6210\u529F' : '\u5931\u8D25'}`);\n    }\n    if (config.enabledNotifiers.includes('wenotify')) {\n        const wenotifyContent = commonContent.replace(/(\\**|\\*|##|#|`)/g, '');\n        const success = await sendWeNotifyEdgeNotification(title, wenotifyContent, config);\n        console.log(`${logPrefix} \u53D1\u9001WeNotify Edge\u901A\u77E5 ${success ? '\u6210\u529F' : '\u5931\u8D25'}`);\n    }\n    if (config.enabledNotifiers.includes('telegram')) {\n        const telegramContent = `*${title}*\\n\\n${commonContent}`;\n        const success = await sendTelegramNotification(telegramContent, config);\n        console.log(`${logPrefix} \u53D1\u9001Telegram\u901A\u77E5 ${success ? '\u6210\u529F' : '\u5931\u8D25'}`);\n    }\n    if (config.enabledNotifiers.includes('webhook')) {\n        const webhookContent = commonContent.replace(/(\\**|\\*|##|#|`)/g, '');\n        const success = await sendWebhookNotification(title, webhookContent, config);\n        console.log(`${logPrefix} \u53D1\u9001\u4F01\u4E1A\u5FAE\u4FE1\u5E94\u7528\u901A\u77E5 ${success ? '\u6210\u529F' : '\u5931\u8D25'}`);\n    }\n    if (config.enabledNotifiers.includes('wechatbot')) {\n        const wechatbotContent = commonContent.replace(/(\\**|\\*|##|#|`)/g, '');\n        const success = await sendWechatBotNotification(title, wechatbotContent, config);\n        console.log(`${logPrefix} \u53D1\u9001\u4F01\u4E1A\u5FAE\u4FE1\u673A\u5668\u4EBA\u901A\u77E5 ${success ? '\u6210\u529F' : '\u5931\u8D25'}`);\n    }\n    if (config.enabledNotifiers.includes('email')) {\n        const emailContent = commonContent.replace(/(\\**|\\*|##|#|`)/g, '');\n        const success = await sendEmailNotification(title, emailContent, config);\n        console.log(`${logPrefix} \u53D1\u9001\u90AE\u4EF6\u901A\u77E5 ${success ? '\u6210\u529F' : '\u5931\u8D25'}`);\n    }\n    if (config.enabledNotifiers.includes('bark')) {\n        const barkContent = commonContent.replace(/(\\**|\\*|##|#|`)/g, '');\n        const success = await sendBarkNotification(title, barkContent, config);\n        console.log(`${logPrefix} \u53D1\u9001Bark\u901A\u77E5 ${success ? '\u6210\u529F' : '\u5931\u8D25'}`);\n    }\n}\n\n// Telegram\nexport async function sendTelegramNotification(message: string, config: Config): Promise<boolean> {\n  try {\n    if (!config.telegram?.botToken || !config.telegram?.chatId) {\n      console.error('[Telegram] \u901A\u77E5\u672A\u914D\u7F6E\uFF0C\u7F3A\u5C11Bot Token\u6216Chat ID');\n      return false;\n    }\n\n    const url = 'https://api.telegram.org/bot' + config.telegram.botToken + '/sendMessage';\n    const response = await requestWithRetry(url, {\n      method: 'POST',\n      headers: { 'Content-Type': 'application/json' },\n      body: JSON.stringify({\n        chat_id: config.telegram.chatId,\n        text: message,\n        parse_mode: 'Markdown'\n      })\n    }, 2, 8000);\n\n    const result = await response.json() as any;\n    return result.ok;\n  } catch (error) {\n    console.error('[Telegram] \u53D1\u9001\u901A\u77E5\u5931\u8D25:', error);\n    return false;\n  }\n}\n\n// NotifyX\nexport async function sendNotifyXNotification(title: string, content: string, description: string, config: Config): Promise<boolean> {\n  try {\n    if (!config.notifyx?.apiKey) {\n      console.error('[NotifyX] \u901A\u77E5\u672A\u914D\u7F6E\uFF0C\u7F3A\u5C11API Key');\n      return false;\n    }\n\n    const url = 'https://www.notifyx.cn/api/v1/send/' + config.notifyx.apiKey;\n    const response = await requestWithRetry(url, {\n      method: 'POST',\n      headers: { 'Content-Type': 'application/json' },\n      body: JSON.stringify({\n        title: title,\n        content: content,\n        description: description || ''\n      })\n    }, 2, 8000);\n\n    const result = await response.json() as any;\n    return result.status === 'queued';\n  } catch (error) {\n    console.error('[NotifyX] \u53D1\u9001\u901A\u77E5\u5931\u8D25:', error);\n    return false;\n  }\n}\n\n// WeNotify Edge\nexport async function sendWeNotifyEdgeNotification(title: string, content: string, config: Config): Promise<boolean> {\n  try {\n    if (!config.wenotify?.url || !config.wenotify?.token) {\n      console.error('[WeNotify Edge] \u901A\u77E5\u672A\u914D\u7F6E\uFF0C\u7F3A\u5C11\u670D\u52A1\u5730\u5740\u6216Token');\n      return false;\n    }\n    let base = config.wenotify.url.trim().replace(/\\/+$/, '');\n    let url = base.endsWith('/wxsend') ? base : base + '/wxsend';\n    const body: any = {\n      title: title,\n      content: content\n    };\n    if (config.wenotify.userid) {\n      body.userid = config.wenotify.userid;\n    }\n    if (config.wenotify.templateId) {\n      body.template_id = config.wenotify.templateId;\n    }\n    const response = await requestWithRetry(url, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n        'Authorization': 'Bearer ' + config.wenotify.token\n      },\n      body: JSON.stringify(body)\n    }, 2, 8000);\n    return response.ok;\n  } catch (error) {\n    console.error('[WeNotify Edge] \u53D1\u9001\u901A\u77E5\u5931\u8D25:', error);\n    return false;\n  }\n}\n\n// Bark\nexport async function sendBarkNotification(title: string, content: string, config: Config): Promise<boolean> {\n  try {\n    if (!config.bark?.deviceKey) {\n      console.error('[Bark] \u901A\u77E5\u672A\u914D\u7F6E\uFF0C\u7F3A\u5C11\u8BBE\u5907Key');\n      return false;\n    }\n\n    const serverUrl = config.bark.server || 'https://api.day.app';\n    const url = serverUrl + '/push';\n    const payload: any = {\n      title: title,\n      body: content,\n      device_key: config.bark.deviceKey\n    };\n\n    if (config.bark.isArchive === 'true') {\n      payload.isArchive = 1;\n    }\n\n    const response = await requestWithRetry(url, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json; charset=utf-8'\n      },\n      body: JSON.stringify(payload)\n    }, 2, 8000);\n\n    const result = await response.json() as any;\n    return result.code === 200;\n  } catch (error) {\n    console.error('[Bark] \u53D1\u9001\u901A\u77E5\u5931\u8D25:', error);\n    return false;\n  }\n}\n\n// Email\nexport async function sendEmailNotification(title: string, content: string, config: Config): Promise<boolean> {\n  try {\n    if (!config.email?.resendApiKey || !config.email?.fromEmail || !config.email?.toEmail) {\n      console.error('[\u90AE\u4EF6\u901A\u77E5] \u901A\u77E5\u672A\u914D\u7F6E\uFF0C\u7F3A\u5C11\u5FC5\u8981\u53C2\u6570');\n      return false;\n    }\n\n    // \u751F\u6210HTML\u90AE\u4EF6\u5185\u5BB9\n    const htmlContent = `\n<!DOCTYPE html>\n<html>\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>${title}</title>\n    <style>\n        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; margin: 0; padding: 0; background-color: #f5f5f5; }\n        .container { max-width: 600px; margin: 0 auto; background-color: #ffffff; }\n        .header { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); padding: 30px 20px; text-align: center; }\n        .header h1 { color: white; margin: 0; font-size: 24px; }\n        .content { padding: 30px 20px; }\n        .content h2 { color: #333; margin-top: 0; }\n        .content p { color: #666; line-height: 1.6; margin: 16px 0; }\n        .footer { background-color: #f8f9fa; padding: 20px; text-align: center; color: #666; font-size: 14px; }\n        .highlight { background-color: #e3f2fd; padding: 15px; border-radius: 8px; margin: 20px 0; }\n    </style>\n</head>\n<body>\n    <div class=\"container\">\n        <div class=\"header\">\n            <h1>\uD83D\uDCC5 ${title}</h1>\n        </div>\n        <div class=\"content\">\n            <div class=\"highlight\">\n                ${content.replace(/\\n/g, '<br>')}\n            </div>\n            <p>\u6B64\u90AE\u4EF6\u7531\u8BA2\u9605\u7BA1\u7406\u7CFB\u7EDF\u81EA\u52A8\u53D1\u9001\uFF0C\u8BF7\u53CA\u65F6\u5904\u7406\u76F8\u5173\u8BA2\u9605\u4E8B\u52A1\u3002</p>\n        </div>\n        <div class=\"footer\">\n            <p>\u8BA2\u9605\u7BA1\u7406\u7CFB\u7EDF | \u53D1\u9001\u65F6\u95F4: ${formatTimeInTimezone(new Date(), config.timezone || 'UTC', 'datetime')}</p>\n        </div>\n    </div>\n</body>\n</html>`;\n\n    const fromEmail = config.email.fromEmail.includes('<') ? \n      config.email.fromEmail :\n      (config.email.fromEmail ? `Notification <${config.email.fromEmail}>` : '');\n\n    const response = await requestWithRetry('https://api.resend.com/emails', {\n      method: 'POST',\n      headers: {\n        'Authorization': `Bearer ${config.email.resendApiKey}`,\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({\n        from: fromEmail,\n        to: config.email.toEmail,\n        subject: title,\n        html: htmlContent,\n        text: content\n      })\n    }, 1, 10000);\n\n    const result = await response.json() as any;\n    return response.ok && result.id;\n  } catch (error) {\n    console.error('[\u90AE\u4EF6\u901A\u77E5] \u53D1\u9001\u90AE\u4EF6\u5931\u8D25:', error);\n    return false;\n  }\n}\n\n// \u4F01\u4E1A\u5FAE\u4FE1\u5E94\u7528\u901A\u77E5 (Webhook)\nexport async function sendWebhookNotification(title: string, content: string, config: Config): Promise<boolean> {\n  try {\n    if (!config.webhook?.url) {\n      console.error('[\u4F01\u4E1A\u5FAE\u4FE1\u5E94\u7528\u901A\u77E5] \u672A\u914D\u7F6E Webhook URL');\n      return false;\n    }\n\n    const method = config.webhook.method || 'POST';\n    const headers = config.webhook.headers ? JSON.parse(config.webhook.headers) : { 'Content-Type': 'application/json' };\n    const template = config.webhook.template ? JSON.parse(config.webhook.template) : null;\n\n    let body;\n    if (template) {\n      // \u4F7F\u7528\u6A21\u677F\u66FF\u6362\u53D8\u91CF\n      const templateStr = JSON.stringify(template);\n      const replacedStr = templateStr\n        .replace(/{{title}}/g, title)\n        .replace(/{{content}}/g, content)\n        .replace(/{{timestamp}}/g, new Date().toISOString());\n      body = replacedStr;\n    } else {\n      // \u9ED8\u8BA4\u683C\u5F0F\n      body = JSON.stringify({\n        msgtype: 'text',\n        text: {\n          content: `${title}\\n\\n${content}`\n        }\n      });\n    }\n\n    const response = await requestWithRetry(config.webhook.url, {\n      method: method,\n      headers: headers,\n      body: method !== 'GET' ? body : undefined\n    }, 2, 8000);\n\n    return response.ok;\n  } catch (error) {\n    console.error('[\u4F01\u4E1A\u5FAE\u4FE1\u5E94\u7528\u901A\u77E5] \u53D1\u9001\u5931\u8D25:', error);\n    return false;\n  }\n}\n\n// \u4F01\u4E1A\u5FAE\u4FE1\u673A\u5668\u4EBA\nexport async function sendWechatBotNotification(title: string, content: string, config: Config): Promise<boolean> {\n  try {\n    if (!config.wechatBot?.webhook) {\n      console.error('[\u4F01\u4E1A\u5FAE\u4FE1\u673A\u5668\u4EBA] \u672A\u914D\u7F6E Webhook URL');\n      return false;\n    }\n\n    const msgType = config.wechatBot.msgType || 'text';\n    let messageData: any;\n\n    if (msgType === 'markdown') {\n      const markdownContent = `### ${title}\\n\\n${content}`;\n      messageData = {\n        msgtype: 'markdown',\n        markdown: {\n          content: markdownContent\n        }\n      };\n    } else {\n      const textContent = `${title}\\n\\n${content}`;\n      messageData = {\n        msgtype: 'text',\n        text: {\n          content: textContent\n        }\n      };\n    }\n\n    if (config.wechatBot.atAll === 'true') {\n      if (msgType === 'text') {\n        messageData.text.mentioned_list = ['@all'];\n      }\n    } else if (config.wechatBot.atMobiles) {\n      const mobiles = config.wechatBot.atMobiles.split(',').map((m: string) => m.trim()).filter((m: string) => m);\n      if (mobiles.length > 0) {\n        if (msgType === 'text') {\n          messageData.text.mentioned_mobile_list = mobiles;\n        }\n      }\n    }\n\n    const response = await requestWithRetry(config.wechatBot.webhook, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify(messageData)\n    }, 2, 8000);\n\n    const responseText = await response.text();\n    if (response.ok) {\n      try {\n        const result = JSON.parse(responseText);\n        return result.errcode === 0;\n      } catch (parseError) {\n        return false;\n      }\n    } else {\n      return false;\n    }\n  } catch (error) {\n    console.error('[\u4F01\u4E1A\u5FAE\u4FE1\u673A\u5668\u4EBA] \u53D1\u9001\u901A\u77E5\u5931\u8D25:', error);\n    return false;\n  }\n}\n", "import { Env } from './types';\nimport { adminPage } from './templates/admin';\nimport { configPage } from './templates/config';\nimport { loginPage } from './templates/login';\nimport { handleDebugRequest } from './templates/debug';\nimport { SubscriptionService } from './services/subscription';\nimport { \n  sendNotificationToAllChannels, \n  sendTelegramNotification, \n  sendNotifyXNotification, \n  sendWeNotifyEdgeNotification,\n  sendWebhookNotification,\n  sendWechatBotNotification,\n  sendEmailNotification,\n  sendBarkNotification,\n  formatNotificationContent\n} from './services/notification';\nimport { getConfig, getRawConfig } from './utils/config';\nimport { generateJWT, verifyJWT, generateRandomSecret } from './utils/auth';\nimport { getCurrentTimeInTimezone, formatTimeInTimezone } from './utils/date';\nimport { getCookieValue } from './utils/http';\n\nexport default {\n  async fetch(request: Request, env: Env, ctx: ExecutionContext): Promise<Response> {\n    const url = new URL(request.url);\n\n    // Debug page\n    if (url.pathname === '/debug') {\n      return handleDebugRequest(request, env);\n    }\n\n    // API Routes\n    if (url.pathname.startsWith('/api')) {\n      return handleApiRequest(request, env);\n    }\n\n    // Admin Routes\n    if (url.pathname.startsWith('/admin')) {\n      return handleAdminRequest(request, env);\n    }\n\n    // Default: Login or Redirect to Admin\n    return handleMainRequest(request, env);\n  },\n\n  async scheduled(event: ScheduledEvent, env: Env, ctx: ExecutionContext) {\n    const config = await getConfig(env);\n    const timezone = config.timezone || 'UTC';\n    const currentTime = getCurrentTimeInTimezone(timezone);\n    console.log('[Workers] \u5B9A\u65F6\u4EFB\u52A1\u89E6\u53D1 UTC:', new Date().toISOString(), timezone + ':', currentTime.toLocaleString('zh-CN', {timeZone: timezone}));\n    \n    const subscriptionService = new SubscriptionService(env);\n    const { notifications } = await subscriptionService.checkExpiringSubscriptions();\n    \n    if (notifications.length > 0) {\n      // \u6309\u5230\u671F\u65F6\u95F4\u6392\u5E8F\n      notifications.sort((a, b) => a.daysUntil - b.daysUntil);\n      \n      const subscriptions = notifications.map(n => ({\n        ...n.subscription,\n        daysRemaining: n.daysUntil\n      }));\n\n      const commonContent = formatNotificationContent(subscriptions, config);\n      const title = '\u8BA2\u9605\u5230\u671F\u63D0\u9192';\n      await sendNotificationToAllChannels(title, commonContent, config, '[\u5B9A\u65F6\u4EFB\u52A1]');\n    }\n  }\n};\n\nasync function handleMainRequest(request: Request, env: Env): Promise<Response> {\n  return new Response(loginPage, {\n    headers: { 'Content-Type': 'text/html; charset=utf-8' }\n  });\n}\n\nasync function handleAdminRequest(request: Request, env: Env): Promise<Response> {\n  try {\n    const url = new URL(request.url);\n    const token = getCookieValue(request.headers.get('Cookie'), 'token');\n    const config = await getConfig(env);\n    const user = token ? await verifyJWT(token, config.jwtSecret!) : null;\n\n    if (!user) {\n      return new Response('', {\n        status: 302,\n        headers: { 'Location': '/' }\n      });\n    }\n\n    if (url.pathname === '/admin/config') {\n      return new Response(configPage, {\n        headers: { 'Content-Type': 'text/html; charset=utf-8' }\n      });\n    }\n\n    return new Response(adminPage, {\n      headers: { 'Content-Type': 'text/html; charset=utf-8' }\n    });\n  } catch (error) {\n    console.error('[Admin] Error:', error);\n    return new Response('Internal Server Error', { status: 500 });\n  }\n}\n\nasync function handleApiRequest(request: Request, env: Env): Promise<Response> {\n  const url = new URL(request.url);\n  const path = url.pathname.slice(4); // Remove '/api'\n  const method = request.method;\n  const config = await getConfig(env);\n  const ip = request.headers.get('cf-connecting-ip') || request.headers.get('x-forwarded-for') || 'unknown';\n\n  async function isRateLimited(base: string, limit: number): Promise<boolean> {\n    const bucket = Math.floor(Date.now() / 60000);\n    const key = `rate:${base}:${ip}:${bucket}`;\n    const val = await env.SUBSCRIPTIONS_KV.get(key);\n    let count = 0;\n    if (val) count = parseInt(val) || 0;\n    count++;\n    await env.SUBSCRIPTIONS_KV.put(key, String(count));\n    return count > limit;\n  }\n\n  if (path === '/dev/reset-login' && method === 'POST') {\n    try {\n      const url = new URL(request.url);\n      const isLocal = url.hostname === '127.0.0.1' || url.hostname === 'localhost';\n      if (!isLocal) {\n        return new Response(JSON.stringify({ success: false, message: '\u4EC5\u9650\u672C\u5730\u5F00\u53D1\u4F7F\u7528' }), { status: 403, headers: { 'Content-Type': 'application/json' } });\n      }\n      const raw = await getRawConfig(env);\n      raw.ADMIN_USERNAME = 'admin';\n      raw.ADMIN_PASSWORD = 'password';\n      if (!raw.JWT_SECRET) {\n        raw.JWT_SECRET = generateRandomSecret();\n      }\n      await env.SUBSCRIPTIONS_KV.put('config', JSON.stringify(raw));\n      return new Response(JSON.stringify({ success: true }), { headers: { 'Content-Type': 'application/json' } });\n    } catch (e: any) {\n      return new Response(JSON.stringify({ success: false, message: e.message }), { status: 500, headers: { 'Content-Type': 'application/json' } });\n    }\n  }\n\n  // Public API: Login\n  if (path === '/login' && method === 'POST') {\n    try {\n      if (await isRateLimited('login', 10)) {\n        return new Response(JSON.stringify({ success: false, message: '\u8BF7\u6C42\u8FC7\u4E8E\u9891\u7E41' }), { status: 429, headers: { 'Content-Type': 'application/json' } });\n      }\n      const body: any = await request.json();\n      const expectedUser = config.adminUsername || 'admin';\n      const expectedPass = config.adminPassword || 'password';\n      const inputUser = (body.username || '').toString();\n      const inputPass = (body.password || '').toString();\n      const ok = inputUser === expectedUser && inputPass === expectedPass;\n      if (ok) {\n        const token = await generateJWT(body.username, config.jwtSecret!);\n        const isLocal = url.hostname === '127.0.0.1' || url.hostname === 'localhost';\n        const secureFlag = isLocal ? '' : '; Secure';\n        return new Response(JSON.stringify({ success: true }), {\n          headers: {\n            'Content-Type': 'application/json',\n            'Set-Cookie': `token=${token}; HttpOnly; Path=/; SameSite=Strict; Max-Age=86400${secureFlag}`\n          }\n        });\n      } else {\n        return new Response(JSON.stringify({ success: false, message: '\u7528\u6237\u540D\u6216\u5BC6\u7801\u9519\u8BEF' }), {\n          headers: { 'Content-Type': 'application/json' }\n        });\n      }\n    } catch (e) {\n      return new Response(JSON.stringify({ success: false, message: 'Invalid request' }), { status: 400 });\n    }\n  }\n\n  // Public API: Logout\n  if (path === '/logout' && (method === 'GET' || method === 'POST')) {\n    const isLocal = url.hostname === '127.0.0.1' || url.hostname === 'localhost';\n    const secureFlag = isLocal ? '' : '; Secure';\n    return new Response('', {\n      status: 302,\n      headers: {\n        'Location': '/',\n        'Set-Cookie': `token=; HttpOnly; Path=/; SameSite=Strict; Max-Age=0${secureFlag}`\n      }\n    });\n  }\n  \n  // Third-party Notification API (Public)\n  if (path.startsWith('/notify/')) {\n      // ... implementation ...\n      // reusing existing logic structure\n      if (method === 'POST') {\n        try {\n          if (await isRateLimited('notify', 20)) {\n            return new Response(JSON.stringify({ message: '\u8BF7\u6C42\u8FC7\u4E8E\u9891\u7E41' }), { status: 429, headers: { 'Content-Type': 'application/json' } });\n          }\n          const tokenHeader = request.headers.get('X-Notify-Token') || '';\n          const tokenQuery = url.searchParams.get('token') || '';\n          const providedToken = tokenHeader || tokenQuery;\n          if (!providedToken || providedToken !== (config.jwtSecret || '')) {\n            return new Response(JSON.stringify({ message: 'Unauthorized' }), { status: 403, headers: { 'Content-Type': 'application/json' } });\n          }\n          const body: any = await request.json();\n          const title = body.title || '\u7B2C\u4E09\u65B9\u901A\u77E5';\n          const content = body.content || '';\n\n          if (!content) {\n            return new Response(JSON.stringify({ message: '\u7F3A\u5C11\u5FC5\u586B\u53C2\u6570 content' }), { status: 400 });\n          }\n\n          await sendNotificationToAllChannels(title, content, config, '[\u7B2C\u4E09\u65B9API]');\n\n          return new Response(JSON.stringify({\n              message: '\u53D1\u9001\u6210\u529F',\n              response: { errcode: 0, errmsg: 'ok', msgid: 'MSGID' + Date.now() }\n            }), { headers: { 'Content-Type': 'application/json' } });\n        } catch (error: any) {\n          return new Response(JSON.stringify({\n              message: '\u53D1\u9001\u5931\u8D25',\n              response: { errcode: 1, errmsg: error.message }\n            }), { status: 500 });\n        }\n      }\n  }\n\n  // Auth Check for other APIs\n  const token = getCookieValue(request.headers.get('Cookie'), 'token');\n  const user = token ? await verifyJWT(token, config.jwtSecret!) : null;\n\n  if (!user) {\n    return new Response(JSON.stringify({ success: false, message: 'Unauthorized' }), {\n      status: 401,\n      headers: { 'Content-Type': 'application/json' }\n    });\n  }\n\n  // Config API\n  if (path === '/config') {\n    if (method === 'GET') {\n      const rawConfig = await getRawConfig(env);\n      const { JWT_SECRET, ADMIN_PASSWORD, ...safeConfig } = rawConfig;\n      return new Response(JSON.stringify(safeConfig), { headers: { 'Content-Type': 'application/json' } });\n    }\n    if (method === 'POST') {\n      try {\n        const newConfig: any = await request.json();\n        const currentRawConfig = await getRawConfig(env);\n        \n        const updatedConfig = {\n            ...currentRawConfig,\n            ADMIN_USERNAME: newConfig.ADMIN_USERNAME || currentRawConfig.ADMIN_USERNAME,\n            TG_BOT_TOKEN: newConfig.TG_BOT_TOKEN || '',\n            TG_CHAT_ID: newConfig.TG_CHAT_ID || '',\n            NOTIFYX_API_KEY: newConfig.NOTIFYX_API_KEY || '',\n            WENOTIFY_URL: newConfig.WENOTIFY_URL || '',\n            WENOTIFY_TOKEN: newConfig.WENOTIFY_TOKEN || '',\n            WENOTIFY_USERID: newConfig.WENOTIFY_USERID || '',\n            WENOTIFY_TEMPLATE_ID: newConfig.WENOTIFY_TEMPLATE_ID || '',\n            WEBHOOK_URL: newConfig.WEBHOOK_URL || '',\n            WEBHOOK_METHOD: newConfig.WEBHOOK_METHOD || 'POST',\n            WEBHOOK_HEADERS: newConfig.WEBHOOK_HEADERS || '',\n            WEBHOOK_TEMPLATE: newConfig.WEBHOOK_TEMPLATE || '',\n            SHOW_LUNAR: newConfig.SHOW_LUNAR === true,\n            WECHATBOT_WEBHOOK: newConfig.WECHATBOT_WEBHOOK || '',\n            WECHATBOT_MSG_TYPE: newConfig.WECHATBOT_MSG_TYPE || 'text',\n            WECHATBOT_AT_MOBILES: newConfig.WECHATBOT_AT_MOBILES || '',\n            WECHATBOT_AT_ALL: newConfig.WECHATBOT_AT_ALL || 'false',\n            RESEND_API_KEY: newConfig.RESEND_API_KEY || '',\n            EMAIL_FROM: newConfig.EMAIL_FROM || '',\n            EMAIL_FROM_NAME: newConfig.EMAIL_FROM_NAME || '',\n            EMAIL_TO: newConfig.EMAIL_TO || '',\n            BARK_DEVICE_KEY: newConfig.BARK_DEVICE_KEY || '',\n            BARK_SERVER: newConfig.BARK_SERVER || 'https://api.day.app',\n            BARK_IS_ARCHIVE: newConfig.BARK_IS_ARCHIVE || 'false',\n            ENABLED_NOTIFIERS: newConfig.ENABLED_NOTIFIERS || ['notifyx'],\n            TIMEZONE: newConfig.TIMEZONE || currentRawConfig.TIMEZONE || 'UTC'\n        };\n        \n        if (newConfig.ADMIN_PASSWORD) {\n            updatedConfig.ADMIN_PASSWORD = newConfig.ADMIN_PASSWORD;\n        }\n\n        if (!updatedConfig.JWT_SECRET || updatedConfig.JWT_SECRET === 'your-secret-key') {\n            updatedConfig.JWT_SECRET = generateRandomSecret();\n        }\n\n        await env.SUBSCRIPTIONS_KV.put('config', JSON.stringify(updatedConfig));\n        return new Response(JSON.stringify({ success: true }), { headers: { 'Content-Type': 'application/json' } });\n      } catch (error: any) {\n        return new Response(JSON.stringify({ success: false, message: error.message }), { status: 400 });\n      }\n    }\n  }\n\n  // Test Notification API\n  if (path === '/test-notification' && method === 'POST') {\n    try {\n        const body: any = await request.json();\n        let success = false;\n        \n        // Create temporary config for test with overrides\n        const tempConfig = { ...config };\n        \n        if (body.type === 'telegram') {\n            tempConfig.telegram = {\n                botToken: body.TG_BOT_TOKEN || config.telegram?.botToken || '',\n                chatId: body.TG_CHAT_ID || config.telegram?.chatId || ''\n            };\n            const content = '*\u6D4B\u8BD5\u901A\u77E5*\\n\\n\u8FD9\u662F\u4E00\u6761\u6D4B\u8BD5\u901A\u77E5...';\n            success = await sendTelegramNotification(content, tempConfig);\n        } else if (body.type === 'notifyx') {\n            tempConfig.notifyx = {\n                apiKey: body.NOTIFYX_API_KEY || config.notifyx?.apiKey || ''\n            };\n            success = await sendNotifyXNotification('\u6D4B\u8BD5\u901A\u77E5', '## \u6D4B\u8BD5\u901A\u77E5...', '\u6D4B\u8BD5\u63CF\u8FF0', tempConfig);\n        } else if (body.type === 'wenotify') {\n            tempConfig.wenotify = {\n                url: body.WENOTIFY_URL || config.wenotify?.url || '',\n                token: body.WENOTIFY_TOKEN || config.wenotify?.token || '',\n                userid: body.WENOTIFY_USERID || config.wenotify?.userid || '',\n                templateId: body.WENOTIFY_TEMPLATE_ID || config.wenotify?.templateId || ''\n            };\n            success = await sendWeNotifyEdgeNotification('\u6D4B\u8BD5\u901A\u77E5', '\u6D4B\u8BD5\u901A\u77E5...', tempConfig);\n        } else if (body.type === 'webhook') {\n            tempConfig.webhook = {\n                url: body.WEBHOOK_URL || config.webhook?.url || '',\n                method: body.WEBHOOK_METHOD || config.webhook?.method || 'POST',\n                headers: body.WEBHOOK_HEADERS || config.webhook?.headers || '',\n                template: body.WEBHOOK_TEMPLATE || config.webhook?.template || ''\n            };\n            success = await sendWebhookNotification('\u6D4B\u8BD5\u901A\u77E5', '\u6D4B\u8BD5\u901A\u77E5...', tempConfig);\n        } else if (body.type === 'wechatbot') {\n            tempConfig.wechatBot = {\n                webhook: body.WECHATBOT_WEBHOOK || config.wechatBot?.webhook || '',\n                msgType: body.WECHATBOT_MSG_TYPE || config.wechatBot?.msgType || 'text',\n                atMobiles: body.WECHATBOT_AT_MOBILES || config.wechatBot?.atMobiles || '',\n                atAll: body.WECHATBOT_AT_ALL || config.wechatBot?.atAll || 'false'\n            };\n            success = await sendWechatBotNotification('\u6D4B\u8BD5\u901A\u77E5', '\u6D4B\u8BD5\u901A\u77E5...', tempConfig);\n        } else if (body.type === 'email') {\n            tempConfig.email = {\n                resendApiKey: body.RESEND_API_KEY || config.email?.resendApiKey || '',\n                fromEmail: body.EMAIL_FROM || config.email?.fromEmail || '',\n                toEmail: body.EMAIL_TO || config.email?.toEmail || ''\n            };\n            success = await sendEmailNotification('\u6D4B\u8BD5\u901A\u77E5', '\u6D4B\u8BD5\u901A\u77E5...', tempConfig);\n        } else if (body.type === 'bark') {\n            tempConfig.bark = {\n                server: body.BARK_SERVER || config.bark?.server || '',\n                deviceKey: body.BARK_DEVICE_KEY || config.bark?.deviceKey || '',\n                isArchive: body.BARK_IS_ARCHIVE || config.bark?.isArchive || 'false'\n            };\n            success = await sendBarkNotification('\u6D4B\u8BD5\u901A\u77E5', '\u6D4B\u8BD5\u901A\u77E5...', tempConfig);\n        }\n        \n        return new Response(JSON.stringify({ success, message: success ? '\u53D1\u9001\u6210\u529F' : '\u53D1\u9001\u5931\u8D25' }), { headers: { 'Content-Type': 'application/json' } });\n    } catch (error: any) {\n        return new Response(JSON.stringify({ success: false, message: error.message }), { status: 500 });\n    }\n  }\n\n  // Subscriptions API\n  const subscriptionService = new SubscriptionService(env);\n  \n  if (path === '/subscriptions') {\n    if (method === 'GET') {\n      const subscriptions = await subscriptionService.getAllSubscriptions();\n      return new Response(JSON.stringify(subscriptions), { headers: { 'Content-Type': 'application/json' } });\n    }\n    if (method === 'POST') {\n      const sub = await request.json();\n      const result = await subscriptionService.createSubscription(sub as any);\n      return new Response(JSON.stringify(result), { status: result.success ? 201 : 400, headers: { 'Content-Type': 'application/json' } });\n    }\n  }\n\n  if (path.startsWith('/subscriptions/')) {\n    const parts = path.split('/');\n    const id = parts[2];\n\n    if (parts[3] === 'toggle-status' && method === 'POST') {\n      const body: any = await request.json();\n      const result = await subscriptionService.toggleSubscriptionStatus(id, body.isActive);\n      return new Response(JSON.stringify(result), { status: result.success ? 200 : 400, headers: { 'Content-Type': 'application/json' } });\n    }\n\n    if (parts[3] === 'test-notify' && method === 'POST') {\n      // Implement test notify for single subscription\n      try {\n        const sub = await subscriptionService.getSubscription(id);\n        if (!sub) return new Response(JSON.stringify({ success: false, message: 'Subscription not found' }), { status: 404 });\n        \n        // Calculate days remaining roughly\n        const now = new Date();\n        const expiry = new Date(sub.expiryDate);\n        // Note: exact calculation logic is in checkExpiringSubscriptions but we can approximate or duplicate for display\n        sub.daysRemaining = Math.ceil((expiry.getTime() - now.getTime()) / (1000 * 60 * 60 * 24));\n        \n        const content = formatNotificationContent([sub], config);\n        await sendNotificationToAllChannels('\u8BA2\u9605\u63D0\u9192\u6D4B\u8BD5', content, config, '[\u624B\u52A8\u6D4B\u8BD5]');\n        return new Response(JSON.stringify({ success: true, message: '\u5DF2\u53D1\u9001' }), { headers: { 'Content-Type': 'application/json' } });\n      } catch (e: any) {\n        return new Response(JSON.stringify({ success: false, message: e.message }), { status: 500 });\n      }\n    }\n\n    if (method === 'GET') {\n      const sub = await subscriptionService.getSubscription(id);\n      return new Response(JSON.stringify(sub), { headers: { 'Content-Type': 'application/json' } });\n    }\n\n    if (method === 'PUT') {\n      const sub = await request.json();\n      const result = await subscriptionService.updateSubscription(id, sub as any);\n      return new Response(JSON.stringify(result), { status: result.success ? 200 : 400, headers: { 'Content-Type': 'application/json' } });\n    }\n\n    if (method === 'DELETE') {\n      const result = await subscriptionService.deleteSubscription(id);\n      return new Response(JSON.stringify(result), { status: result.success ? 200 : 400, headers: { 'Content-Type': 'application/json' } });\n    }\n  }\n\n  return new Response(JSON.stringify({ success: false, message: 'Not Found' }), { status: 404 });\n}\n", "import type { Middleware } from \"./common\";\n\nconst drainBody: Middleware = async (request, env, _ctx, middlewareCtx) => {\n\ttry {\n\t\treturn await middlewareCtx.next(request, env);\n\t} finally {\n\t\ttry {\n\t\t\tif (request.body !== null && !request.bodyUsed) {\n\t\t\t\tconst reader = request.body.getReader();\n\t\t\t\twhile (!(await reader.read()).done) {}\n\t\t\t}\n\t\t} catch (e) {\n\t\t\tconsole.error(\"Failed to drain the unused request body.\", e);\n\t\t}\n\t}\n};\n\nexport default drainBody;\n", "import type { Middleware } from \"./common\";\n\ninterface JsonError {\n\tmessage?: string;\n\tname?: string;\n\tstack?: string;\n\tcause?: JsonError;\n}\n\nfunction reduceError(e: any): JsonError {\n\treturn {\n\t\tname: e?.name,\n\t\tmessage: e?.message ?? String(e),\n\t\tstack: e?.stack,\n\t\tcause: e?.cause === undefined ? undefined : reduceError(e.cause),\n\t};\n}\n\n// See comment in `bundle.ts` for details on why this is needed\nconst jsonError: Middleware = async (request, env, _ctx, middlewareCtx) => {\n\ttry {\n\t\treturn await middlewareCtx.next(request, env);\n\t} catch (e: any) {\n\t\tconst error = reduceError(e);\n\t\treturn Response.json(error, {\n\t\t\tstatus: 500,\n\t\t\theaders: { \"MF-Experimental-Error-Stack\": \"true\" },\n\t\t});\n\t}\n};\n\nexport default jsonError;\n", "\t\t\t\timport worker, * as OTHER_EXPORTS from \"C:\\\\Users\\\\qh686\\\\Desktop\\\\google code\\\\substracker-wxpush\\\\src\\\\worker.ts\";\n\t\t\t\timport * as __MIDDLEWARE_0__ from \"C:\\\\Users\\\\qh686\\\\Desktop\\\\google code\\\\substracker-wxpush\\\\node_modules\\\\wrangler\\\\templates\\\\middleware\\\\middleware-ensure-req-body-drained.ts\";\nimport * as __MIDDLEWARE_1__ from \"C:\\\\Users\\\\qh686\\\\Desktop\\\\google code\\\\substracker-wxpush\\\\node_modules\\\\wrangler\\\\templates\\\\middleware\\\\middleware-miniflare3-json-error.ts\";\n\n\t\t\t\texport * from \"C:\\\\Users\\\\qh686\\\\Desktop\\\\google code\\\\substracker-wxpush\\\\src\\\\worker.ts\";\n\t\t\t\tconst MIDDLEWARE_TEST_INJECT = \"__INJECT_FOR_TESTING_WRANGLER_MIDDLEWARE__\";\n\t\t\t\texport const __INTERNAL_WRANGLER_MIDDLEWARE__ = [\n\t\t\t\t\t\n\t\t\t\t\t__MIDDLEWARE_0__.default,__MIDDLEWARE_1__.default\n\t\t\t\t]\n\t\t\t\texport default worker;", "export type Awaitable<T> = T | Promise<T>;\n// TODO: allow dispatching more events?\nexport type Dispatcher = (\n\ttype: \"scheduled\",\n\tinit: { cron?: string }\n) => Awaitable<void>;\n\nexport type IncomingRequest = Request<\n\tunknown,\n\tIncomingRequestCfProperties<unknown>\n>;\n\nexport interface MiddlewareContext {\n\tdispatch: Dispatcher;\n\tnext(request: IncomingRequest, env: any): Awaitable<Response>;\n}\n\nexport type Middleware = (\n\trequest: IncomingRequest,\n\tenv: any,\n\tctx: ExecutionContext,\n\tmiddlewareCtx: MiddlewareContext\n) => Awaitable<Response>;\n\nconst __facade_middleware__: Middleware[] = [];\n\n// The register functions allow for the insertion of one or many middleware,\n// We register internal middleware first in the stack, but have no way of controlling\n// the order that addMiddleware is run in service workers so need an internal function.\nexport function __facade_register__(...args: (Middleware | Middleware[])[]) {\n\t__facade_middleware__.push(...args.flat());\n}\nexport function __facade_registerInternal__(\n\t...args: (Middleware | Middleware[])[]\n) {\n\t__facade_middleware__.unshift(...args.flat());\n}\n\nfunction __facade_invokeChain__(\n\trequest: IncomingRequest,\n\tenv: any,\n\tctx: ExecutionContext,\n\tdispatch: Dispatcher,\n\tmiddlewareChain: Middleware[]\n): Awaitable<Response> {\n\tconst [head, ...tail] = middlewareChain;\n\tconst middlewareCtx: MiddlewareContext = {\n\t\tdispatch,\n\t\tnext(newRequest, newEnv) {\n\t\t\treturn __facade_invokeChain__(newRequest, newEnv, ctx, dispatch, tail);\n\t\t},\n\t};\n\treturn head(request, env, ctx, middlewareCtx);\n}\n\nexport function __facade_invoke__(\n\trequest: IncomingRequest,\n\tenv: any,\n\tctx: ExecutionContext,\n\tdispatch: Dispatcher,\n\tfinalMiddleware: Middleware\n): Awaitable<Response> {\n\treturn __facade_invokeChain__(request, env, ctx, dispatch, [\n\t\t...__facade_middleware__,\n\t\tfinalMiddleware,\n\t]);\n}\n", "// This loads all middlewares exposed on the middleware object and then starts\n// the invocation chain. The big idea is that we can add these to the middleware\n// export dynamically through wrangler, or we can potentially let users directly\n// add them as a sort of \"plugin\" system.\n\nimport ENTRY, { __INTERNAL_WRANGLER_MIDDLEWARE__ } from \"C:\\\\Users\\\\qh686\\\\Desktop\\\\google code\\\\substracker-wxpush\\\\.wrangler\\\\tmp\\\\bundle-qJCWc7\\\\middleware-insertion-facade.js\";\nimport { __facade_invoke__, __facade_register__, Dispatcher } from \"C:\\\\Users\\\\qh686\\\\Desktop\\\\google code\\\\substracker-wxpush\\\\node_modules\\\\wrangler\\\\templates\\\\middleware\\\\common.ts\";\nimport type { WorkerEntrypointConstructor } from \"C:\\\\Users\\\\qh686\\\\Desktop\\\\google code\\\\substracker-wxpush\\\\.wrangler\\\\tmp\\\\bundle-qJCWc7\\\\middleware-insertion-facade.js\";\n\n// Preserve all the exports from the worker\nexport * from \"C:\\\\Users\\\\qh686\\\\Desktop\\\\google code\\\\substracker-wxpush\\\\.wrangler\\\\tmp\\\\bundle-qJCWc7\\\\middleware-insertion-facade.js\";\n\nclass __Facade_ScheduledController__ implements ScheduledController {\n\treadonly #noRetry: ScheduledController[\"noRetry\"];\n\n\tconstructor(\n\t\treadonly scheduledTime: number,\n\t\treadonly cron: string,\n\t\tnoRetry: ScheduledController[\"noRetry\"]\n\t) {\n\t\tthis.#noRetry = noRetry;\n\t}\n\n\tnoRetry() {\n\t\tif (!(this instanceof __Facade_ScheduledController__)) {\n\t\t\tthrow new TypeError(\"Illegal invocation\");\n\t\t}\n\t\t// Need to call native method immediately in case uncaught error thrown\n\t\tthis.#noRetry();\n\t}\n}\n\nfunction wrapExportedHandler(worker: ExportedHandler): ExportedHandler {\n\t// If we don't have any middleware defined, just return the handler as is\n\tif (\n\t\t__INTERNAL_WRANGLER_MIDDLEWARE__ === undefined ||\n\t\t__INTERNAL_WRANGLER_MIDDLEWARE__.length === 0\n\t) {\n\t\treturn worker;\n\t}\n\t// Otherwise, register all middleware once\n\tfor (const middleware of __INTERNAL_WRANGLER_MIDDLEWARE__) {\n\t\t__facade_register__(middleware);\n\t}\n\n\tconst fetchDispatcher: ExportedHandlerFetchHandler = function (\n\t\trequest,\n\t\tenv,\n\t\tctx\n\t) {\n\t\tif (worker.fetch === undefined) {\n\t\t\tthrow new Error(\"Handler does not export a fetch() function.\");\n\t\t}\n\t\treturn worker.fetch(request, env, ctx);\n\t};\n\n\treturn {\n\t\t...worker,\n\t\tfetch(request, env, ctx) {\n\t\t\tconst dispatcher: Dispatcher = function (type, init) {\n\t\t\t\tif (type === \"scheduled\" && worker.scheduled !== undefined) {\n\t\t\t\t\tconst controller = new __Facade_ScheduledController__(\n\t\t\t\t\t\tDate.now(),\n\t\t\t\t\t\tinit.cron ?? \"\",\n\t\t\t\t\t\t() => {}\n\t\t\t\t\t);\n\t\t\t\t\treturn worker.scheduled(controller, env, ctx);\n\t\t\t\t}\n\t\t\t};\n\t\t\treturn __facade_invoke__(request, env, ctx, dispatcher, fetchDispatcher);\n\t\t},\n\t};\n}\n\nfunction wrapWorkerEntrypoint(\n\tklass: WorkerEntrypointConstructor\n): WorkerEntrypointConstructor {\n\t// If we don't have any middleware defined, just return the handler as is\n\tif (\n\t\t__INTERNAL_WRANGLER_MIDDLEWARE__ === undefined ||\n\t\t__INTERNAL_WRANGLER_MIDDLEWARE__.length === 0\n\t) {\n\t\treturn klass;\n\t}\n\t// Otherwise, register all middleware once\n\tfor (const middleware of __INTERNAL_WRANGLER_MIDDLEWARE__) {\n\t\t__facade_register__(middleware);\n\t}\n\n\t// `extend`ing `klass` here so other RPC methods remain callable\n\treturn class extends klass {\n\t\t#fetchDispatcher: ExportedHandlerFetchHandler<Record<string, unknown>> = (\n\t\t\trequest,\n\t\t\tenv,\n\t\t\tctx\n\t\t) => {\n\t\t\tthis.env = env;\n\t\t\tthis.ctx = ctx;\n\t\t\tif (super.fetch === undefined) {\n\t\t\t\tthrow new Error(\"Entrypoint class does not define a fetch() function.\");\n\t\t\t}\n\t\t\treturn super.fetch(request);\n\t\t};\n\n\t\t#dispatcher: Dispatcher = (type, init) => {\n\t\t\tif (type === \"scheduled\" && super.scheduled !== undefined) {\n\t\t\t\tconst controller = new __Facade_ScheduledController__(\n\t\t\t\t\tDate.now(),\n\t\t\t\t\tinit.cron ?? \"\",\n\t\t\t\t\t() => {}\n\t\t\t\t);\n\t\t\t\treturn super.scheduled(controller);\n\t\t\t}\n\t\t};\n\n\t\tfetch(request: Request<unknown, IncomingRequestCfProperties>) {\n\t\t\treturn __facade_invoke__(\n\t\t\t\trequest,\n\t\t\t\tthis.env,\n\t\t\t\tthis.ctx,\n\t\t\t\tthis.#dispatcher,\n\t\t\t\tthis.#fetchDispatcher\n\t\t\t);\n\t\t}\n\t};\n}\n\nlet WRAPPED_ENTRY: ExportedHandler | WorkerEntrypointConstructor | undefined;\nif (typeof ENTRY === \"object\") {\n\tWRAPPED_ENTRY = wrapExportedHandler(ENTRY);\n} else if (typeof ENTRY === \"function\") {\n\tWRAPPED_ENTRY = wrapWorkerEntrypoint(ENTRY);\n}\nexport default WRAPPED_ENTRY;\n"],
  "mappings": ";;;;AAAA,IAAM,OAAO,oBAAI,IAAI;AAErB,SAAS,SAAS,SAAS,MAAM;AAChC,QAAM,MACL,mBAAmB,MAChB,UACA,IAAI;AAAA,KACH,OAAO,YAAY,WACjB,IAAI,QAAQ,SAAS,IAAI,IACzB,SACD;AAAA,EACH;AACH,MAAI,IAAI,QAAQ,IAAI,SAAS,SAAS,IAAI,aAAa,UAAU;AAChE,QAAI,CAAC,KAAK,IAAI,IAAI,SAAS,CAAC,GAAG;AAC9B,WAAK,IAAI,IAAI,SAAS,CAAC;AACvB,cAAQ;AAAA,QACP;AAAA,KACO,IAAI,SAAS,CAAC;AAAA;AAAA,MACtB;AAAA,IACD;AAAA,EACD;AACD;AAnBS;AAqBT,WAAW,QAAQ,IAAI,MAAM,WAAW,OAAO;AAAA,EAC9C,MAAM,QAAQ,SAAS,UAAU;AAChC,UAAM,CAAC,SAAS,IAAI,IAAI;AACxB,aAAS,SAAS,IAAI;AACtB,WAAO,QAAQ,MAAM,QAAQ,SAAS,QAAQ;AAAA,EAC/C;AACD,CAAC;;;AC5BM,IAAM,YAAY;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;ACDlB,IAAM,aAAa;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;ACAnB,IAAM,YAAY;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAA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",
  "names": ["s", "url", "token"]
}
